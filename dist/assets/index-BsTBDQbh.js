(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function cp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var Gh={exports:{}},vc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function VC(){if(I1)return vc;I1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:i}}return vc.Fragment=e,vc.jsx=n,vc.jsxs=n,vc}var F1;function $C(){return F1||(F1=1,Gh.exports=VC()),Gh.exports}var x=$C(),zh={exports:{}},dt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function HC(){if(L1)return dt;L1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function _(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function b(D,ee,I){this.props=D,this.context=ee,this.refs=S,this.updater=I||T}b.prototype.isReactComponent={},b.prototype.setState=function(D,ee){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,ee,"setState")},b.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function k(){}k.prototype=b.prototype;function A(D,ee,I){this.props=D,this.context=ee,this.refs=S,this.updater=I||T}var C=A.prototype=new k;C.constructor=A,E(C,b.prototype),C.isPureReactComponent=!0;var M=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function F(D,ee,I,W,X,q){return I=q.ref,{$$typeof:t,type:D,key:ee,ref:I!==void 0?I:null,props:q}}function K(D,ee){return F(D.type,ee,void 0,void 0,void 0,D.props)}function P(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function ae(D){var ee={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(I){return ee[I]})}var G=/\/+/g;function te(D,ee){return typeof D=="object"&&D!==null&&D.key!=null?ae(""+D.key):ee.toString(36)}function we(){}function Re(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(we,we):(D.status="pending",D.then(function(ee){D.status==="pending"&&(D.status="fulfilled",D.value=ee)},function(ee){D.status==="pending"&&(D.status="rejected",D.reason=ee)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function ye(D,ee,I,W,X){var q=typeof D;(q==="undefined"||q==="boolean")&&(D=null);var oe=!1;if(D===null)oe=!0;else switch(q){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(D.$$typeof){case t:case e:oe=!0;break;case g:return oe=D._init,ye(oe(D._payload),ee,I,W,X)}}if(oe)return X=X(D),oe=W===""?"."+te(D,0):W,M(X)?(I="",oe!=null&&(I=oe.replace(G,"$&/")+"/"),ye(X,ee,I,"",function(Ee){return Ee})):X!=null&&(P(X)&&(X=K(X,I+(X.key==null||D&&D.key===X.key?"":(""+X.key).replace(G,"$&/")+"/")+oe)),ee.push(X)),1;oe=0;var _e=W===""?".":W+":";if(M(D))for(var Se=0;Se<D.length;Se++)W=D[Se],q=_e+te(W,Se),oe+=ye(W,ee,I,q,X);else if(Se=_(D),typeof Se=="function")for(D=Se.call(D),Se=0;!(W=D.next()).done;)W=W.value,q=_e+te(W,Se++),oe+=ye(W,ee,I,q,X);else if(q==="object"){if(typeof D.then=="function")return ye(Re(D),ee,I,W,X);throw ee=String(D),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return oe}function se(D,ee,I){if(D==null)return D;var W=[],X=0;return ye(D,W,"","",function(q){return ee.call(I,q,X++)}),W}function me(D){if(D._status===-1){var ee=D._result;ee=ee(),ee.then(function(I){(D._status===0||D._status===-1)&&(D._status=1,D._result=I)},function(I){(D._status===0||D._status===-1)&&(D._status=2,D._result=I)}),D._status===-1&&(D._status=0,D._result=ee)}if(D._status===1)return D._result.default;throw D._result}var re=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function J(){}return dt.Children={map:se,forEach:function(D,ee,I){se(D,function(){ee.apply(this,arguments)},I)},count:function(D){var ee=0;return se(D,function(){ee++}),ee},toArray:function(D){return se(D,function(ee){return ee})||[]},only:function(D){if(!P(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},dt.Component=b,dt.Fragment=n,dt.Profiler=a,dt.PureComponent=A,dt.StrictMode=r,dt.Suspense=d,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,dt.__COMPILER_RUNTIME={__proto__:null,c:function(D){return B.H.useMemoCache(D)}},dt.cache=function(D){return function(){return D.apply(null,arguments)}},dt.cloneElement=function(D,ee,I){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var W=E({},D.props),X=D.key,q=void 0;if(ee!=null)for(oe in ee.ref!==void 0&&(q=void 0),ee.key!==void 0&&(X=""+ee.key),ee)!H.call(ee,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&ee.ref===void 0||(W[oe]=ee[oe]);var oe=arguments.length-2;if(oe===1)W.children=I;else if(1<oe){for(var _e=Array(oe),Se=0;Se<oe;Se++)_e[Se]=arguments[Se+2];W.children=_e}return F(D.type,X,void 0,void 0,q,W)},dt.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:i,_context:D},D},dt.createElement=function(D,ee,I){var W,X={},q=null;if(ee!=null)for(W in ee.key!==void 0&&(q=""+ee.key),ee)H.call(ee,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(X[W]=ee[W]);var oe=arguments.length-2;if(oe===1)X.children=I;else if(1<oe){for(var _e=Array(oe),Se=0;Se<oe;Se++)_e[Se]=arguments[Se+2];X.children=_e}if(D&&D.defaultProps)for(W in oe=D.defaultProps,oe)X[W]===void 0&&(X[W]=oe[W]);return F(D,q,void 0,void 0,null,X)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(D){return{$$typeof:c,render:D}},dt.isValidElement=P,dt.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:me}},dt.memo=function(D,ee){return{$$typeof:f,type:D,compare:ee===void 0?null:ee}},dt.startTransition=function(D){var ee=B.T,I={};B.T=I;try{var W=D(),X=B.S;X!==null&&X(I,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(J,re)}catch(q){re(q)}finally{B.T=ee}},dt.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},dt.use=function(D){return B.H.use(D)},dt.useActionState=function(D,ee,I){return B.H.useActionState(D,ee,I)},dt.useCallback=function(D,ee){return B.H.useCallback(D,ee)},dt.useContext=function(D){return B.H.useContext(D)},dt.useDebugValue=function(){},dt.useDeferredValue=function(D,ee){return B.H.useDeferredValue(D,ee)},dt.useEffect=function(D,ee,I){var W=B.H;if(typeof I=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(D,ee)},dt.useId=function(){return B.H.useId()},dt.useImperativeHandle=function(D,ee,I){return B.H.useImperativeHandle(D,ee,I)},dt.useInsertionEffect=function(D,ee){return B.H.useInsertionEffect(D,ee)},dt.useLayoutEffect=function(D,ee){return B.H.useLayoutEffect(D,ee)},dt.useMemo=function(D,ee){return B.H.useMemo(D,ee)},dt.useOptimistic=function(D,ee){return B.H.useOptimistic(D,ee)},dt.useReducer=function(D,ee,I){return B.H.useReducer(D,ee,I)},dt.useRef=function(D){return B.H.useRef(D)},dt.useState=function(D){return B.H.useState(D)},dt.useSyncExternalStore=function(D,ee,I){return B.H.useSyncExternalStore(D,ee,I)},dt.useTransition=function(){return B.H.useTransition()},dt.version="19.1.0",dt}var O1;function up(){return O1||(O1=1,zh.exports=HC()),zh.exports}var U=up();const ls=cp(U);var qh={exports:{}},yc={},Yh={exports:{}},Wh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function GC(){return P1||(P1=1,function(t){function e(se,me){var re=se.length;se.push(me);e:for(;0<re;){var J=re-1>>>1,D=se[J];if(0<a(D,me))se[J]=me,se[re]=D,re=J;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var me=se[0],re=se.pop();if(re!==me){se[0]=re;e:for(var J=0,D=se.length,ee=D>>>1;J<ee;){var I=2*(J+1)-1,W=se[I],X=I+1,q=se[X];if(0>a(W,re))X<D&&0>a(q,W)?(se[J]=q,se[X]=re,J=X):(se[J]=W,se[I]=re,J=I);else if(X<D&&0>a(q,re))se[J]=q,se[X]=re,J=X;else break e}}return me}function a(se,me){var re=se.sortIndex-me.sortIndex;return re!==0?re:se.id-me.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],g=1,v=null,_=3,T=!1,E=!1,S=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function M(se){for(var me=n(f);me!==null;){if(me.callback===null)r(f);else if(me.startTime<=se)r(f),me.sortIndex=me.expirationTime,e(d,me);else break;me=n(f)}}function B(se){if(S=!1,M(se),!E)if(n(d)!==null)E=!0,H||(H=!0,te());else{var me=n(f);me!==null&&ye(B,me.startTime-se)}}var H=!1,F=-1,K=5,P=-1;function ae(){return b?!0:!(t.unstable_now()-P<K)}function G(){if(b=!1,H){var se=t.unstable_now();P=se;var me=!0;try{e:{E=!1,S&&(S=!1,A(F),F=-1),T=!0;var re=_;try{t:{for(M(se),v=n(d);v!==null&&!(v.expirationTime>se&&ae());){var J=v.callback;if(typeof J=="function"){v.callback=null,_=v.priorityLevel;var D=J(v.expirationTime<=se);if(se=t.unstable_now(),typeof D=="function"){v.callback=D,M(se),me=!0;break t}v===n(d)&&r(d),M(se)}else r(d);v=n(d)}if(v!==null)me=!0;else{var ee=n(f);ee!==null&&ye(B,ee.startTime-se),me=!1}}break e}finally{v=null,_=re,T=!1}me=void 0}}finally{me?te():H=!1}}}var te;if(typeof C=="function")te=function(){C(G)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,Re=we.port2;we.port1.onmessage=G,te=function(){Re.postMessage(null)}}else te=function(){k(G,0)};function ye(se,me){F=k(function(){se(t.unstable_now())},me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(se){switch(_){case 1:case 2:case 3:var me=3;break;default:me=_}var re=_;_=me;try{return se()}finally{_=re}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(se,me){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var re=_;_=se;try{return me()}finally{_=re}},t.unstable_scheduleCallback=function(se,me,re){var J=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?J+re:J):re=J,se){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=re+D,se={id:g++,callback:me,priorityLevel:se,startTime:re,expirationTime:D,sortIndex:-1},re>J?(se.sortIndex=re,e(f,se),n(d)===null&&se===n(f)&&(S?(A(F),F=-1):S=!0,ye(B,re-J))):(se.sortIndex=D,e(d,se),E||T||(E=!0,H||(H=!0,te()))),se},t.unstable_shouldYield=ae,t.unstable_wrapCallback=function(se){var me=_;return function(){var re=_;_=me;try{return se.apply(this,arguments)}finally{_=re}}}}(Wh)),Wh}var U1;function zC(){return U1||(U1=1,Yh.exports=GC()),Yh.exports}var Jh={exports:{}},Xn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function qC(){if(B1)return Xn;B1=1;var t=up();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(d,f,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:d,containerInfo:f,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Xn.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,g)},Xn.flushSync=function(d){var f=l.T,g=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=g,r.d.f()}},Xn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},Xn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Xn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,T=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:T}):g==="script"&&r.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:T,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Xn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},Xn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin);r.d.L(d,g,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Xn.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=c(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},Xn.requestFormReset=function(d){r.d.r(d)},Xn.unstable_batchedUpdates=function(d,f){return d(f)},Xn.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},Xn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Xn.version="19.1.0",Xn}var j1;function YC(){if(j1)return Jh.exports;j1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Jh.exports=qC(),Jh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V1;function WC(){if(V1)return yc;V1=1;var t=zC(),e=up(),n=YC();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(i(s)!==s)throw Error(r(188))}function d(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,p=o;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(p=y.return,p!==null){u=p;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return c(y),s;if(w===p)return c(y),o;w=w.sibling}throw Error(r(188))}if(u.return!==p.return)u=y,p=w;else{for(var N=!1,L=y.child;L;){if(L===u){N=!0,u=y,p=w;break}if(L===p){N=!0,p=y,u=w;break}L=L.sibling}if(!N){for(L=w.child;L;){if(L===u){N=!0,u=w,p=y;break}if(L===p){N=!0,p=w,u=y;break}L=L.sibling}if(!N)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),A=Symbol.for("react.consumer"),C=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),ae=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=G&&s[G]||s["@@iterator"],typeof s=="function"?s:null)}var we=Symbol.for("react.client.reference");function Re(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===we?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case S:return"StrictMode";case B:return"Suspense";case H:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case T:return"Portal";case C:return(s.displayName||"Context")+".Provider";case A:return(s._context.displayName||"Context")+".Consumer";case M:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return o=s.displayName||null,o!==null?o:Re(s.type)||"Memo";case K:o=s._payload,s=s._init;try{return Re(s(o))}catch{}}return null}var ye=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},J=[],D=-1;function ee(s){return{current:s}}function I(s){0>D||(s.current=J[D],J[D]=null,D--)}function W(s,o){D++,J[D]=s.current,s.current=o}var X=ee(null),q=ee(null),oe=ee(null),_e=ee(null);function Se(s,o){switch(W(oe,o),W(q,s),W(X,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?o1(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=o1(o),s=l1(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}I(X),W(X,s)}function Ee(){I(X),I(q),I(oe)}function Ce(s){s.memoizedState!==null&&W(_e,s);var o=X.current,u=l1(o,s.type);o!==u&&(W(q,s),W(X,u))}function Ke(s){q.current===s&&(I(X),I(q)),_e.current===s&&(I(_e),hc._currentValue=re)}var Z=Object.prototype.hasOwnProperty,ft=t.unstable_scheduleCallback,Xe=t.unstable_cancelCallback,wt=t.unstable_shouldYield,rt=t.unstable_requestPaint,Fe=t.unstable_now,Ut=t.unstable_getCurrentPriorityLevel,cn=t.unstable_ImmediatePriority,rn=t.unstable_UserBlockingPriority,an=t.unstable_NormalPriority,Ln=t.unstable_LowPriority,Tt=t.unstable_IdlePriority,en=t.log,Hn=t.unstable_setDisableYieldValue,vn=null,Zt=null;function Dt(s){if(typeof en=="function"&&Hn(s),Zt&&typeof Zt.setStrictMode=="function")try{Zt.setStrictMode(vn,s)}catch{}}var it=Math.clz32?Math.clz32:sn,tt=Math.log,Et=Math.LN2;function sn(s){return s>>>=0,s===0?32:31-(tt(s)/Et|0)|0}var Me=256,Ye=4194304;function Ge(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function We(s,o,u){var p=s.pendingLanes;if(p===0)return 0;var y=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var L=p&134217727;return L!==0?(p=L&~w,p!==0?y=Ge(p):(N&=L,N!==0?y=Ge(N):u||(u=L&~s,u!==0&&(y=Ge(u))))):(L=p&~w,L!==0?y=Ge(L):N!==0?y=Ge(N):u||(u=p&~s,u!==0&&(y=Ge(u)))),y===0?0:o!==0&&o!==y&&(o&w)===0&&(w=y&-y,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:y}function nt(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function lr(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ur(){var s=Me;return Me<<=1,(Me&4194048)===0&&(Me=256),s}function Ua(){var s=Ye;return Ye<<=1,(Ye&62914560)===0&&(Ye=4194304),s}function Ba(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function ta(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function xa(s,o,u,p,y,w){var N=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var L=s.entanglements,ne=s.expirationTimes,he=s.hiddenUpdates;for(u=N&~u;0<u;){var be=31-it(u),Ne=1<<be;L[be]=0,ne[be]=-1;var ge=he[be];if(ge!==null)for(he[be]=null,be=0;be<ge.length;be++){var xe=ge[be];xe!==null&&(xe.lane&=-536870913)}u&=~Ne}p!==0&&ps(s,p,0),w!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function ps(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var p=31-it(o);s.entangledLanes|=o,s.entanglements[p]=s.entanglements[p]|1073741824|u&4194090}function gs(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var p=31-it(u),y=1<<p;y&o|s[p]&o&&(s[p]|=o),u&=~y}}function ja(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Va(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function xs(){var s=me.p;return s!==0?s:(s=window.event,s===void 0?32:A1(s.type))}function si(s,o){var u=me.p;try{return me.p=s,o()}finally{me.p=u}}var xr=Math.random().toString(36).slice(2),un="__reactFiber$"+xr,fn="__reactProps$"+xr,Br="__reactContainer$"+xr,gt="__reactEvents$"+xr,vs="__reactListeners$"+xr,R="__reactHandles$"+xr,j="__reactResources$"+xr,O="__reactMarker$"+xr;function V(s){delete s[un],delete s[fn],delete s[gt],delete s[vs],delete s[R]}function z(s){var o=s[un];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Br]||u[un]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=d1(s);s!==null;){if(u=s[un])return u;s=d1(s)}return o}s=u,u=s.parentNode}return null}function Y(s){if(s=s[un]||s[Br]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function ue(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function ve(s){var o=s[j];return o||(o=s[j]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(s){s[O]=!0}var de=new Set,pe={};function De(s,o){Le(s,o),Le(s+"Capture",o)}function Le(s,o){for(pe[s]=o,s=0;s<o.length;s++)de.add(o[s])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Q={};function Te(s){return Z.call(Q,s)?!0:Z.call(Ie,s)?!1:Ue.test(s)?Q[s]=!0:(Ie[s]=!0,!1)}function ke(s,o,u){if(Te(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function Pe(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function je(s,o,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+p)}}var lt,Mt;function St(s){if(lt===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);lt=o&&o[1]||"",Mt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+s+Mt}var It=!1;function dn(s,o){if(!s||It)return"";It=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var Ne=function(){throw Error()};if(Object.defineProperty(Ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ne,[])}catch(xe){var ge=xe}Reflect.construct(s,[],Ne)}else{try{Ne.call()}catch(xe){ge=xe}s.call(Ne.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(Ne=s())&&typeof Ne.catch=="function"&&Ne.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=p.DetermineComponentFrameRoot(),N=w[0],L=w[1];if(N&&L){var ne=N.split(`
`),he=L.split(`
`);for(y=p=0;p<ne.length&&!ne[p].includes("DetermineComponentFrameRoot");)p++;for(;y<he.length&&!he[y].includes("DetermineComponentFrameRoot");)y++;if(p===ne.length||y===he.length)for(p=ne.length-1,y=he.length-1;1<=p&&0<=y&&ne[p]!==he[y];)y--;for(;1<=p&&0<=y;p--,y--)if(ne[p]!==he[y]){if(p!==1||y!==1)do if(p--,y--,0>y||ne[p]!==he[y]){var be=`
`+ne[p].replace(" at new "," at ");return s.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",s.displayName)),be}while(1<=p&&0<=y);break}}}finally{It=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?St(u):""}function Ft(s){switch(s.tag){case 26:case 27:case 5:return St(s.type);case 16:return St("Lazy");case 13:return St("Suspense");case 19:return St("SuspenseList");case 0:case 15:return dn(s.type,!1);case 11:return dn(s.type.render,!1);case 1:return dn(s.type,!0);case 31:return St("Activity");default:return""}}function jr(s){try{var o="";do o+=Ft(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function hn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function bl(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function to(s){var o=bl(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),p=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(N){p=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(N){p=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function ys(s){s._valueTracker||(s._valueTracker=to(s))}function no(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return s&&(p=bl(s)?s.checked?"true":"false":s.value),s=p,s!==u?(o.setValue(s),!0):!1}function ii(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var $t=/[\n"\\]/g;function xt(s){return s.replace($t,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function kn(s,o,u,p,y,w,N,L){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+hn(o)):s.value!==""+hn(o)&&(s.value=""+hn(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?na(s,N,hn(o)):u!=null?na(s,N,hn(u)):p!=null&&s.removeAttribute("value"),y==null&&w!=null&&(s.defaultChecked=!!w),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?s.name=""+hn(L):s.removeAttribute("name")}function oi(s,o,u,p,y,w,N,L){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null))return;u=u!=null?""+hn(u):"",o=o!=null?""+hn(o):u,L||o===s.value||(s.value=o),s.defaultValue=o}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=L?s.checked:!!p,s.defaultChecked=!!p,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function na(s,o,u){o==="number"&&ii(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function br(s,o,u,p){if(s=s.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=o.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&p&&(s[u].defaultSelected=!0)}else{for(u=""+hn(u),o=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,p&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function Su(s,o,u){if(o!=null&&(o=""+hn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+hn(u):""}function ig(s,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(ye(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=hn(o),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p)}function ro(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var PS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function og(s,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":p?s.setProperty(o,u):typeof u!="number"||u===0||PS.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function lg(s,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var y in o)p=o[y],o.hasOwnProperty(y)&&u[y]!==p&&og(s,y,p)}else for(var w in o)o.hasOwnProperty(w)&&og(s,w,o[w])}function Hd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var US=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),BS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bu(s){return BS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Gd=null;function zd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ao=null,so=null;function cg(s){var o=Y(s);if(o&&(s=o.stateNode)){var u=s[fn]||null;e:switch(s=o.stateNode,o.type){case"input":if(kn(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+xt(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==s&&p.form===s.form){var y=p[fn]||null;if(!y)throw Error(r(90));kn(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===s.form&&no(p)}break e;case"textarea":Su(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&br(s,!!u.multiple,o,!1)}}}var qd=!1;function ug(s,o,u){if(qd)return s(o,u);qd=!0;try{var p=s(o);return p}finally{if(qd=!1,(ao!==null||so!==null)&&(ff(),ao&&(o=ao,s=so,so=ao=null,cg(o),s)))for(o=0;o<s.length;o++)cg(s[o])}}function Cl(s,o){var u=s.stateNode;if(u===null)return null;var p=u[fn]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yd=!1;if($a)try{var Al={};Object.defineProperty(Al,"passive",{get:function(){Yd=!0}}),window.addEventListener("test",Al,Al),window.removeEventListener("test",Al,Al)}catch{Yd=!1}var _s=null,Wd=null,Cu=null;function fg(){if(Cu)return Cu;var s,o=Wd,u=o.length,p,y="value"in _s?_s.value:_s.textContent,w=y.length;for(s=0;s<u&&o[s]===y[s];s++);var N=u-s;for(p=1;p<=N&&o[u-p]===y[w-p];p++);return Cu=y.slice(s,1<p?1-p:void 0)}function Au(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function ku(){return!0}function dg(){return!1}function vr(s){function o(u,p,y,w,N){this._reactName=u,this._targetInst=y,this.type=p,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var L in s)s.hasOwnProperty(L)&&(u=s[L],this[L]=u?u(w):w[L]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?ku:dg,this.isPropagationStopped=dg,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ku)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ku)},persist:function(){},isPersistent:ku}),o}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nu=vr(li),kl=g({},li,{view:0,detail:0}),jS=vr(kl),Jd,Kd,Nl,Ru=g({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Nl&&(Nl&&s.type==="mousemove"?(Jd=s.screenX-Nl.screenX,Kd=s.screenY-Nl.screenY):Kd=Jd=0,Nl=s),Jd)},movementY:function(s){return"movementY"in s?s.movementY:Kd}}),hg=vr(Ru),VS=g({},Ru,{dataTransfer:0}),$S=vr(VS),HS=g({},kl,{relatedTarget:0}),Xd=vr(HS),GS=g({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),zS=vr(GS),qS=g({},li,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),YS=vr(qS),WS=g({},li,{data:0}),mg=vr(WS),JS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},XS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZS(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=XS[s])?!!o[s]:!1}function Zd(){return ZS}var QS=g({},kl,{key:function(s){if(s.key){var o=JS[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Au(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?KS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zd,charCode:function(s){return s.type==="keypress"?Au(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Au(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),eb=vr(QS),tb=g({},Ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pg=vr(tb),nb=g({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zd}),rb=vr(nb),ab=g({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),sb=vr(ab),ib=g({},Ru,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ob=vr(ib),lb=g({},li,{newState:0,oldState:0}),cb=vr(lb),ub=[9,13,27,32],Qd=$a&&"CompositionEvent"in window,Rl=null;$a&&"documentMode"in document&&(Rl=document.documentMode);var fb=$a&&"TextEvent"in window&&!Rl,gg=$a&&(!Qd||Rl&&8<Rl&&11>=Rl),xg=" ",vg=!1;function yg(s,o){switch(s){case"keyup":return ub.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _g(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var io=!1;function db(s,o){switch(s){case"compositionend":return _g(o);case"keypress":return o.which!==32?null:(vg=!0,xg);case"textInput":return s=o.data,s===xg&&vg?null:s;default:return null}}function hb(s,o){if(io)return s==="compositionend"||!Qd&&yg(s,o)?(s=fg(),Cu=Wd=_s=null,io=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return gg&&o.locale!=="ko"?null:o.data;default:return null}}var mb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wg(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!mb[s.type]:o==="textarea"}function Tg(s,o,u,p){ao?so?so.push(p):so=[p]:ao=p,o=xf(o,"onChange"),0<o.length&&(u=new Nu("onChange","change",null,u,p),s.push({event:u,listeners:o}))}var Dl=null,Ml=null;function pb(s){n1(s,0)}function Du(s){var o=ue(s);if(no(o))return s}function Eg(s,o){if(s==="change")return o}var Sg=!1;if($a){var e0;if($a){var t0="oninput"in document;if(!t0){var bg=document.createElement("div");bg.setAttribute("oninput","return;"),t0=typeof bg.oninput=="function"}e0=t0}else e0=!1;Sg=e0&&(!document.documentMode||9<document.documentMode)}function Cg(){Dl&&(Dl.detachEvent("onpropertychange",Ag),Ml=Dl=null)}function Ag(s){if(s.propertyName==="value"&&Du(Ml)){var o=[];Tg(o,Ml,s,zd(s)),ug(pb,o)}}function gb(s,o,u){s==="focusin"?(Cg(),Dl=o,Ml=u,Dl.attachEvent("onpropertychange",Ag)):s==="focusout"&&Cg()}function xb(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Du(Ml)}function vb(s,o){if(s==="click")return Du(o)}function yb(s,o){if(s==="input"||s==="change")return Du(o)}function _b(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Cr=typeof Object.is=="function"?Object.is:_b;function Il(s,o){if(Cr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var y=u[p];if(!Z.call(o,y)||!Cr(s[y],o[y]))return!1}return!0}function kg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ng(s,o){var u=kg(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=o&&p>=o)return{node:u,offset:o-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=kg(u)}}function Rg(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Rg(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Dg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=ii(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=ii(s.document)}return o}function n0(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var wb=$a&&"documentMode"in document&&11>=document.documentMode,oo=null,r0=null,Fl=null,a0=!1;function Mg(s,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;a0||oo==null||oo!==ii(p)||(p=oo,"selectionStart"in p&&n0(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Fl&&Il(Fl,p)||(Fl=p,p=xf(r0,"onSelect"),0<p.length&&(o=new Nu("onSelect","select",null,o,u),s.push({event:o,listeners:p}),o.target=oo)))}function ci(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var lo={animationend:ci("Animation","AnimationEnd"),animationiteration:ci("Animation","AnimationIteration"),animationstart:ci("Animation","AnimationStart"),transitionrun:ci("Transition","TransitionRun"),transitionstart:ci("Transition","TransitionStart"),transitioncancel:ci("Transition","TransitionCancel"),transitionend:ci("Transition","TransitionEnd")},s0={},Ig={};$a&&(Ig=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function ui(s){if(s0[s])return s0[s];if(!lo[s])return s;var o=lo[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in Ig)return s0[s]=o[u];return s}var Fg=ui("animationend"),Lg=ui("animationiteration"),Og=ui("animationstart"),Tb=ui("transitionrun"),Eb=ui("transitionstart"),Sb=ui("transitioncancel"),Pg=ui("transitionend"),Ug=new Map,i0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");i0.push("scrollEnd");function ra(s,o){Ug.set(s,o),De(o,[s])}var Bg=new WeakMap;function Vr(s,o){if(typeof s=="object"&&s!==null){var u=Bg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:jr(o)},Bg.set(s,o),o)}return{value:s,source:o,stack:jr(o)}}var $r=[],co=0,o0=0;function Mu(){for(var s=co,o=o0=co=0;o<s;){var u=$r[o];$r[o++]=null;var p=$r[o];$r[o++]=null;var y=$r[o];$r[o++]=null;var w=$r[o];if($r[o++]=null,p!==null&&y!==null){var N=p.pending;N===null?y.next=y:(y.next=N.next,N.next=y),p.pending=y}w!==0&&jg(u,y,w)}}function Iu(s,o,u,p){$r[co++]=s,$r[co++]=o,$r[co++]=u,$r[co++]=p,o0|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function l0(s,o,u,p){return Iu(s,o,u,p),Fu(s)}function uo(s,o){return Iu(s,null,null,o),Fu(s)}function jg(s,o,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var y=!1,w=s.return;w!==null;)w.childLanes|=u,p=w.alternate,p!==null&&(p.childLanes|=u),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(y=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,y&&o!==null&&(y=31-it(u),s=w.hiddenUpdates,p=s[y],p===null?s[y]=[o]:p.push(o),o.lane=u|536870912),w):null}function Fu(s){if(50<sc)throw sc=0,mh=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var fo={};function bb(s,o,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(s,o,u,p){return new bb(s,o,u,p)}function c0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ha(s,o){var u=s.alternate;return u===null?(u=Ar(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Vg(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Lu(s,o,u,p,y,w){var N=0;if(p=s,typeof s=="function")c0(s)&&(N=1);else if(typeof s=="string")N=AC(s,u,X.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=Ar(31,u,o,y),s.elementType=P,s.lanes=w,s;case E:return fi(u.children,y,w,o);case S:N=8,y|=24;break;case b:return s=Ar(12,u,o,y|2),s.elementType=b,s.lanes=w,s;case B:return s=Ar(13,u,o,y),s.elementType=B,s.lanes=w,s;case H:return s=Ar(19,u,o,y),s.elementType=H,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case k:case C:N=10;break e;case A:N=9;break e;case M:N=11;break e;case F:N=14;break e;case K:N=16,p=null;break e}N=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return o=Ar(N,u,o,y),o.elementType=s,o.type=p,o.lanes=w,o}function fi(s,o,u,p){return s=Ar(7,s,p,o),s.lanes=u,s}function u0(s,o,u){return s=Ar(6,s,null,o),s.lanes=u,s}function f0(s,o,u){return o=Ar(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var ho=[],mo=0,Ou=null,Pu=0,Hr=[],Gr=0,di=null,Ga=1,za="";function hi(s,o){ho[mo++]=Pu,ho[mo++]=Ou,Ou=s,Pu=o}function $g(s,o,u){Hr[Gr++]=Ga,Hr[Gr++]=za,Hr[Gr++]=di,di=s;var p=Ga;s=za;var y=32-it(p)-1;p&=~(1<<y),u+=1;var w=32-it(o)+y;if(30<w){var N=y-y%5;w=(p&(1<<N)-1).toString(32),p>>=N,y-=N,Ga=1<<32-it(o)+y|u<<y|p,za=w+s}else Ga=1<<w|u<<y|p,za=s}function d0(s){s.return!==null&&(hi(s,1),$g(s,1,0))}function h0(s){for(;s===Ou;)Ou=ho[--mo],ho[mo]=null,Pu=ho[--mo],ho[mo]=null;for(;s===di;)di=Hr[--Gr],Hr[Gr]=null,za=Hr[--Gr],Hr[Gr]=null,Ga=Hr[--Gr],Hr[Gr]=null}var cr=null,mn=null,Pt=!1,mi=null,va=!1,m0=Error(r(519));function pi(s){var o=Error(r(418,""));throw Pl(Vr(o,s)),m0}function Hg(s){var o=s.stateNode,u=s.type,p=s.memoizedProps;switch(o[un]=s,o[fn]=p,u){case"dialog":yt("cancel",o),yt("close",o);break;case"iframe":case"object":case"embed":yt("load",o);break;case"video":case"audio":for(u=0;u<oc.length;u++)yt(oc[u],o);break;case"source":yt("error",o);break;case"img":case"image":case"link":yt("error",o),yt("load",o);break;case"details":yt("toggle",o);break;case"input":yt("invalid",o),oi(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),ys(o);break;case"select":yt("invalid",o);break;case"textarea":yt("invalid",o),ig(o,p.value,p.defaultValue,p.children),ys(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||i1(o.textContent,u)?(p.popover!=null&&(yt("beforetoggle",o),yt("toggle",o)),p.onScroll!=null&&yt("scroll",o),p.onScrollEnd!=null&&yt("scrollend",o),p.onClick!=null&&(o.onclick=vf),o=!0):o=!1,o||pi(s)}function Gg(s){for(cr=s.return;cr;)switch(cr.tag){case 5:case 13:va=!1;return;case 27:case 3:va=!0;return;default:cr=cr.return}}function Ll(s){if(s!==cr)return!1;if(!Pt)return Gg(s),Pt=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Rh(s.type,s.memoizedProps)),u=!u),u&&mn&&pi(s),Gg(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){mn=sa(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}mn=null}}else o===27?(o=mn,Os(s.type)?(s=Fh,Fh=null,mn=s):mn=o):mn=cr?sa(s.stateNode.nextSibling):null;return!0}function Ol(){mn=cr=null,Pt=!1}function zg(){var s=mi;return s!==null&&(wr===null?wr=s:wr.push.apply(wr,s),mi=null),s}function Pl(s){mi===null?mi=[s]:mi.push(s)}var p0=ee(null),gi=null,qa=null;function ws(s,o,u){W(p0,o._currentValue),o._currentValue=u}function Ya(s){s._currentValue=p0.current,I(p0)}function g0(s,o,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),s===u)break;s=s.return}}function x0(s,o,u,p){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var w=y.dependencies;if(w!==null){var N=y.child;w=w.firstContext;e:for(;w!==null;){var L=w;w=y;for(var ne=0;ne<o.length;ne++)if(L.context===o[ne]){w.lanes|=u,L=w.alternate,L!==null&&(L.lanes|=u),g0(w.return,u,s),p||(N=null);break e}w=L.next}}else if(y.tag===18){if(N=y.return,N===null)throw Error(r(341));N.lanes|=u,w=N.alternate,w!==null&&(w.lanes|=u),g0(N,u,s),N=null}else N=y.child;if(N!==null)N.return=y;else for(N=y;N!==null;){if(N===s){N=null;break}if(y=N.sibling,y!==null){y.return=N.return,N=y;break}N=N.return}y=N}}function Ul(s,o,u,p){s=null;for(var y=o,w=!1;y!==null;){if(!w){if((y.flags&524288)!==0)w=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var N=y.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var L=y.type;Cr(y.pendingProps.value,N.value)||(s!==null?s.push(L):s=[L])}}else if(y===_e.current){if(N=y.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(hc):s=[hc])}y=y.return}s!==null&&x0(o,s,u,p),o.flags|=262144}function Uu(s){for(s=s.firstContext;s!==null;){if(!Cr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function xi(s){gi=s,qa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Kn(s){return qg(gi,s)}function Bu(s,o){return gi===null&&xi(s),qg(s,o)}function qg(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},qa===null){if(s===null)throw Error(r(308));qa=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else qa=qa.next=o;return u}var Cb=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},Ab=t.unstable_scheduleCallback,kb=t.unstable_NormalPriority,Nn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function v0(){return{controller:new Cb,data:new Map,refCount:0}}function Bl(s){s.refCount--,s.refCount===0&&Ab(kb,function(){s.controller.abort()})}var jl=null,y0=0,po=0,go=null;function Nb(s,o){if(jl===null){var u=jl=[];y0=0,po=wh(),go={status:"pending",value:void 0,then:function(p){u.push(p)}}}return y0++,o.then(Yg,Yg),o}function Yg(){if(--y0===0&&jl!==null){go!==null&&(go.status="fulfilled");var s=jl;jl=null,po=0,go=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function Rb(s,o){var u=[],p={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){p.status="fulfilled",p.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(p.status="rejected",p.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),p}var Wg=se.S;se.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Nb(s,o),Wg!==null&&Wg(s,o)};var vi=ee(null);function _0(){var s=vi.current;return s!==null?s:Wt.pooledCache}function ju(s,o){o===null?W(vi,vi.current):W(vi,o.pool)}function Jg(){var s=_0();return s===null?null:{parent:Nn._currentValue,pool:s}}var Vl=Error(r(460)),Kg=Error(r(474)),Vu=Error(r(542)),w0={then:function(){}};function Xg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function $u(){}function Zg(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then($u,$u),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,ex(s),s;default:if(typeof o.status=="string")o.then($u,$u);else{if(s=Wt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(p){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=p}},function(p){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,ex(s),s}throw $l=o,Vl}}var $l=null;function Qg(){if($l===null)throw Error(r(459));var s=$l;return $l=null,s}function ex(s){if(s===Vl||s===Vu)throw Error(r(483))}var Ts=!1;function T0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function E0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Es(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ss(s,o,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(Bt&2)!==0){var y=p.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),p.pending=o,o=Fu(s),jg(s,null,u),o}return Iu(s,p,o,u),Fu(s)}function Hl(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,gs(s,u)}}function S0(s,o){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?y=w=N:w=w.next=N,u=u.next}while(u!==null);w===null?y=w=o:w=w.next=o}else y=w=o;u={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var b0=!1;function Gl(){if(b0){var s=go;if(s!==null)throw s}}function zl(s,o,u,p){b0=!1;var y=s.updateQueue;Ts=!1;var w=y.firstBaseUpdate,N=y.lastBaseUpdate,L=y.shared.pending;if(L!==null){y.shared.pending=null;var ne=L,he=ne.next;ne.next=null,N===null?w=he:N.next=he,N=ne;var be=s.alternate;be!==null&&(be=be.updateQueue,L=be.lastBaseUpdate,L!==N&&(L===null?be.firstBaseUpdate=he:L.next=he,be.lastBaseUpdate=ne))}if(w!==null){var Ne=y.baseState;N=0,be=he=ne=null,L=w;do{var ge=L.lane&-536870913,xe=ge!==L.lane;if(xe?(At&ge)===ge:(p&ge)===ge){ge!==0&&ge===po&&(b0=!0),be!==null&&(be=be.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var Qe=s,Je=L;ge=o;var zt=u;switch(Je.tag){case 1:if(Qe=Je.payload,typeof Qe=="function"){Ne=Qe.call(zt,Ne,ge);break e}Ne=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Je.payload,ge=typeof Qe=="function"?Qe.call(zt,Ne,ge):Qe,ge==null)break e;Ne=g({},Ne,ge);break e;case 2:Ts=!0}}ge=L.callback,ge!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=y.callbacks,xe===null?y.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:L.tag,payload:L.payload,callback:L.callback,next:null},be===null?(he=be=xe,ne=Ne):be=be.next=xe,N|=ge;if(L=L.next,L===null){if(L=y.shared.pending,L===null)break;xe=L,L=xe.next,xe.next=null,y.lastBaseUpdate=xe,y.shared.pending=null}}while(!0);be===null&&(ne=Ne),y.baseState=ne,y.firstBaseUpdate=he,y.lastBaseUpdate=be,w===null&&(y.shared.lanes=0),Ms|=N,s.lanes=N,s.memoizedState=Ne}}function tx(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function nx(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)tx(u[s],o)}var xo=ee(null),Hu=ee(0);function rx(s,o){s=es,W(Hu,s),W(xo,o),es=s|o.baseLanes}function C0(){W(Hu,es),W(xo,xo.current)}function A0(){es=Hu.current,I(xo),I(Hu)}var bs=0,mt=null,Ht=null,Tn=null,Gu=!1,vo=!1,yi=!1,zu=0,ql=0,yo=null,Db=0;function yn(){throw Error(r(321))}function k0(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!Cr(s[u],o[u]))return!1;return!0}function N0(s,o,u,p,y,w){return bs=w,mt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,se.H=s===null||s.memoizedState===null?jx:Vx,yi=!1,w=u(p,y),yi=!1,vo&&(w=sx(o,u,p,y)),ax(s),w}function ax(s){se.H=Xu;var o=Ht!==null&&Ht.next!==null;if(bs=0,Tn=Ht=mt=null,Gu=!1,ql=0,yo=null,o)throw Error(r(300));s===null||On||(s=s.dependencies,s!==null&&Uu(s)&&(On=!0))}function sx(s,o,u,p){mt=s;var y=0;do{if(vo&&(yo=null),ql=0,vo=!1,25<=y)throw Error(r(301));if(y+=1,Tn=Ht=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}se.H=Ub,w=o(u,p)}while(vo);return w}function Mb(){var s=se.H,o=s.useState()[0];return o=typeof o.then=="function"?Yl(o):o,s=s.useState()[0],(Ht!==null?Ht.memoizedState:null)!==s&&(mt.flags|=1024),o}function R0(){var s=zu!==0;return zu=0,s}function D0(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function M0(s){if(Gu){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Gu=!1}bs=0,Tn=Ht=mt=null,vo=!1,ql=zu=0,yo=null}function yr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?mt.memoizedState=Tn=s:Tn=Tn.next=s,Tn}function En(){if(Ht===null){var s=mt.alternate;s=s!==null?s.memoizedState:null}else s=Ht.next;var o=Tn===null?mt.memoizedState:Tn.next;if(o!==null)Tn=o,Ht=s;else{if(s===null)throw mt.alternate===null?Error(r(467)):Error(r(310));Ht=s,s={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Tn===null?mt.memoizedState=Tn=s:Tn=Tn.next=s}return Tn}function I0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yl(s){var o=ql;return ql+=1,yo===null&&(yo=[]),s=Zg(yo,s,o),o=mt,(Tn===null?o.memoizedState:Tn.next)===null&&(o=o.alternate,se.H=o===null||o.memoizedState===null?jx:Vx),s}function qu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Yl(s);if(s.$$typeof===C)return Kn(s)}throw Error(r(438,String(s)))}function F0(s){var o=null,u=mt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=mt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=I0(),mt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),p=0;p<s;p++)u[p]=ae;return o.index++,u}function Wa(s,o){return typeof o=="function"?o(s):o}function Yu(s){var o=En();return L0(o,Ht,s)}function L0(s,o,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var y=s.baseQueue,w=p.pending;if(w!==null){if(y!==null){var N=y.next;y.next=w.next,w.next=N}o.baseQueue=y=w,p.pending=null}if(w=s.baseState,y===null)s.memoizedState=w;else{o=y.next;var L=N=null,ne=null,he=o,be=!1;do{var Ne=he.lane&-536870913;if(Ne!==he.lane?(At&Ne)===Ne:(bs&Ne)===Ne){var ge=he.revertLane;if(ge===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ne===po&&(be=!0);else if((bs&ge)===ge){he=he.next,ge===po&&(be=!0);continue}else Ne={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},ne===null?(L=ne=Ne,N=w):ne=ne.next=Ne,mt.lanes|=ge,Ms|=ge;Ne=he.action,yi&&u(w,Ne),w=he.hasEagerState?he.eagerState:u(w,Ne)}else ge={lane:Ne,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},ne===null?(L=ne=ge,N=w):ne=ne.next=ge,mt.lanes|=Ne,Ms|=Ne;he=he.next}while(he!==null&&he!==o);if(ne===null?N=w:ne.next=L,!Cr(w,s.memoizedState)&&(On=!0,be&&(u=go,u!==null)))throw u;s.memoizedState=w,s.baseState=N,s.baseQueue=ne,p.lastRenderedState=w}return y===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function O0(s){var o=En(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,y=u.pending,w=o.memoizedState;if(y!==null){u.pending=null;var N=y=y.next;do w=s(w,N.action),N=N.next;while(N!==y);Cr(w,o.memoizedState)||(On=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,p]}function ix(s,o,u){var p=mt,y=En(),w=Pt;if(w){if(u===void 0)throw Error(r(407));u=u()}else u=o();var N=!Cr((Ht||y).memoizedState,u);N&&(y.memoizedState=u,On=!0),y=y.queue;var L=cx.bind(null,p,y,s);if(Wl(2048,8,L,[s]),y.getSnapshot!==o||N||Tn!==null&&Tn.memoizedState.tag&1){if(p.flags|=2048,_o(9,Wu(),lx.bind(null,p,y,u,o),null),Wt===null)throw Error(r(349));w||(bs&124)!==0||ox(p,o,u)}return u}function ox(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=mt.updateQueue,o===null?(o=I0(),mt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function lx(s,o,u,p){o.value=u,o.getSnapshot=p,ux(o)&&fx(s)}function cx(s,o,u){return u(function(){ux(o)&&fx(s)})}function ux(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!Cr(s,u)}catch{return!0}}function fx(s){var o=uo(s,2);o!==null&&Mr(o,s,2)}function P0(s){var o=yr();if(typeof s=="function"){var u=s;if(s=u(),yi){Dt(!0);try{u()}finally{Dt(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:s},o}function dx(s,o,u,p){return s.baseState=u,L0(s,Ht,typeof p=="function"?p:Wa)}function Ib(s,o,u,p,y){if(Ku(s))throw Error(r(485));if(s=o.action,s!==null){var w={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};se.T!==null?u(!0):w.isTransition=!1,p(w),u=o.pending,u===null?(w.next=o.pending=w,hx(o,w)):(w.next=u.next,o.pending=u.next=w)}}function hx(s,o){var u=o.action,p=o.payload,y=s.state;if(o.isTransition){var w=se.T,N={};se.T=N;try{var L=u(y,p),ne=se.S;ne!==null&&ne(N,L),mx(s,o,L)}catch(he){U0(s,o,he)}finally{se.T=w}}else try{w=u(y,p),mx(s,o,w)}catch(he){U0(s,o,he)}}function mx(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){px(s,o,p)},function(p){return U0(s,o,p)}):px(s,o,u)}function px(s,o,u){o.status="fulfilled",o.value=u,gx(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,hx(s,u)))}function U0(s,o,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,gx(o),o=o.next;while(o!==p)}s.action=null}function gx(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function xx(s,o){return o}function vx(s,o){if(Pt){var u=Wt.formState;if(u!==null){e:{var p=mt;if(Pt){if(mn){t:{for(var y=mn,w=va;y.nodeType!==8;){if(!w){y=null;break t}if(y=sa(y.nextSibling),y===null){y=null;break t}}w=y.data,y=w==="F!"||w==="F"?y:null}if(y){mn=sa(y.nextSibling),p=y.data==="F!";break e}}pi(p)}p=!1}p&&(o=u[0])}}return u=yr(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xx,lastRenderedState:o},u.queue=p,u=Px.bind(null,mt,p),p.dispatch=u,p=P0(!1),w=H0.bind(null,mt,!1,p.queue),p=yr(),y={state:o,dispatch:null,action:s,pending:null},p.queue=y,u=Ib.bind(null,mt,y,w,u),y.dispatch=u,p.memoizedState=s,[o,u,!1]}function yx(s){var o=En();return _x(o,Ht,s)}function _x(s,o,u){if(o=L0(s,o,xx)[0],s=Yu(Wa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Yl(o)}catch(N){throw N===Vl?Vu:N}else p=o;o=En();var y=o.queue,w=y.dispatch;return u!==o.memoizedState&&(mt.flags|=2048,_o(9,Wu(),Fb.bind(null,y,u),null)),[p,w,s]}function Fb(s,o){s.action=o}function wx(s){var o=En(),u=Ht;if(u!==null)return _x(o,u,s);En(),o=o.memoizedState,u=En();var p=u.queue.dispatch;return u.memoizedState=s,[o,p,!1]}function _o(s,o,u,p){return s={tag:s,create:u,deps:p,inst:o,next:null},o=mt.updateQueue,o===null&&(o=I0(),mt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,o.lastEffect=s),s}function Wu(){return{destroy:void 0,resource:void 0}}function Tx(){return En().memoizedState}function Ju(s,o,u,p){var y=yr();p=p===void 0?null:p,mt.flags|=s,y.memoizedState=_o(1|o,Wu(),u,p)}function Wl(s,o,u,p){var y=En();p=p===void 0?null:p;var w=y.memoizedState.inst;Ht!==null&&p!==null&&k0(p,Ht.memoizedState.deps)?y.memoizedState=_o(o,w,u,p):(mt.flags|=s,y.memoizedState=_o(1|o,w,u,p))}function Ex(s,o){Ju(8390656,8,s,o)}function Sx(s,o){Wl(2048,8,s,o)}function bx(s,o){return Wl(4,2,s,o)}function Cx(s,o){return Wl(4,4,s,o)}function Ax(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function kx(s,o,u){u=u!=null?u.concat([s]):null,Wl(4,4,Ax.bind(null,o,s),u)}function B0(){}function Nx(s,o){var u=En();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&k0(o,p[1])?p[0]:(u.memoizedState=[s,o],s)}function Rx(s,o){var u=En();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&k0(o,p[1]))return p[0];if(p=s(),yi){Dt(!0);try{s()}finally{Dt(!1)}}return u.memoizedState=[p,o],p}function j0(s,o,u){return u===void 0||(bs&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=Iv(),mt.lanes|=s,Ms|=s,u)}function Dx(s,o,u,p){return Cr(u,o)?u:xo.current!==null?(s=j0(s,u,p),Cr(s,o)||(On=!0),s):(bs&42)===0?(On=!0,s.memoizedState=u):(s=Iv(),mt.lanes|=s,Ms|=s,o)}function Mx(s,o,u,p,y){var w=me.p;me.p=w!==0&&8>w?w:8;var N=se.T,L={};se.T=L,H0(s,!1,o,u);try{var ne=y(),he=se.S;if(he!==null&&he(L,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var be=Rb(ne,p);Jl(s,o,be,Dr(s))}else Jl(s,o,p,Dr(s))}catch(Ne){Jl(s,o,{then:function(){},status:"rejected",reason:Ne},Dr())}finally{me.p=w,se.T=N}}function Lb(){}function V0(s,o,u,p){if(s.tag!==5)throw Error(r(476));var y=Ix(s).queue;Mx(s,y,o,re,u===null?Lb:function(){return Fx(s),u(p)})}function Ix(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:re},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Fx(s){var o=Ix(s).next.queue;Jl(s,o,{},Dr())}function $0(){return Kn(hc)}function Lx(){return En().memoizedState}function Ox(){return En().memoizedState}function Ob(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Dr();s=Es(u);var p=Ss(o,s,u);p!==null&&(Mr(p,o,u),Hl(p,o,u)),o={cache:v0()},s.payload=o;return}o=o.return}}function Pb(s,o,u){var p=Dr();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Ku(s)?Ux(o,u):(u=l0(s,o,u,p),u!==null&&(Mr(u,s,p),Bx(u,o,p)))}function Px(s,o,u){var p=Dr();Jl(s,o,u,p)}function Jl(s,o,u,p){var y={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ku(s))Ux(o,y);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,L=w(N,u);if(y.hasEagerState=!0,y.eagerState=L,Cr(L,N))return Iu(s,o,y,0),Wt===null&&Mu(),!1}catch{}finally{}if(u=l0(s,o,y,p),u!==null)return Mr(u,s,p),Bx(u,o,p),!0}return!1}function H0(s,o,u,p){if(p={lane:2,revertLane:wh(),action:p,hasEagerState:!1,eagerState:null,next:null},Ku(s)){if(o)throw Error(r(479))}else o=l0(s,u,p,2),o!==null&&Mr(o,s,2)}function Ku(s){var o=s.alternate;return s===mt||o!==null&&o===mt}function Ux(s,o){vo=Gu=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function Bx(s,o,u){if((u&4194048)!==0){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,gs(s,u)}}var Xu={readContext:Kn,use:qu,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn},jx={readContext:Kn,use:qu,useCallback:function(s,o){return yr().memoizedState=[s,o===void 0?null:o],s},useContext:Kn,useEffect:Ex,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Ju(4194308,4,Ax.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Ju(4194308,4,s,o)},useInsertionEffect:function(s,o){Ju(4,2,s,o)},useMemo:function(s,o){var u=yr();o=o===void 0?null:o;var p=s();if(yi){Dt(!0);try{s()}finally{Dt(!1)}}return u.memoizedState=[p,o],p},useReducer:function(s,o,u){var p=yr();if(u!==void 0){var y=u(o);if(yi){Dt(!0);try{u(o)}finally{Dt(!1)}}}else y=o;return p.memoizedState=p.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},p.queue=s,s=s.dispatch=Pb.bind(null,mt,s),[p.memoizedState,s]},useRef:function(s){var o=yr();return s={current:s},o.memoizedState=s},useState:function(s){s=P0(s);var o=s.queue,u=Px.bind(null,mt,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:B0,useDeferredValue:function(s,o){var u=yr();return j0(u,s,o)},useTransition:function(){var s=P0(!1);return s=Mx.bind(null,mt,s.queue,!0,!1),yr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var p=mt,y=yr();if(Pt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Wt===null)throw Error(r(349));(At&124)!==0||ox(p,o,u)}y.memoizedState=u;var w={value:u,getSnapshot:o};return y.queue=w,Ex(cx.bind(null,p,w,s),[s]),p.flags|=2048,_o(9,Wu(),lx.bind(null,p,w,u,o),null),u},useId:function(){var s=yr(),o=Wt.identifierPrefix;if(Pt){var u=za,p=Ga;u=(p&~(1<<32-it(p)-1)).toString(32)+u,o=""+o+"R"+u,u=zu++,0<u&&(o+="H"+u.toString(32)),o+=""}else u=Db++,o=""+o+"r"+u.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:$0,useFormState:vx,useActionState:vx,useOptimistic:function(s){var o=yr();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=H0.bind(null,mt,!0,u),u.dispatch=o,[s,o]},useMemoCache:F0,useCacheRefresh:function(){return yr().memoizedState=Ob.bind(null,mt)}},Vx={readContext:Kn,use:qu,useCallback:Nx,useContext:Kn,useEffect:Sx,useImperativeHandle:kx,useInsertionEffect:bx,useLayoutEffect:Cx,useMemo:Rx,useReducer:Yu,useRef:Tx,useState:function(){return Yu(Wa)},useDebugValue:B0,useDeferredValue:function(s,o){var u=En();return Dx(u,Ht.memoizedState,s,o)},useTransition:function(){var s=Yu(Wa)[0],o=En().memoizedState;return[typeof s=="boolean"?s:Yl(s),o]},useSyncExternalStore:ix,useId:Lx,useHostTransitionStatus:$0,useFormState:yx,useActionState:yx,useOptimistic:function(s,o){var u=En();return dx(u,Ht,s,o)},useMemoCache:F0,useCacheRefresh:Ox},Ub={readContext:Kn,use:qu,useCallback:Nx,useContext:Kn,useEffect:Sx,useImperativeHandle:kx,useInsertionEffect:bx,useLayoutEffect:Cx,useMemo:Rx,useReducer:O0,useRef:Tx,useState:function(){return O0(Wa)},useDebugValue:B0,useDeferredValue:function(s,o){var u=En();return Ht===null?j0(u,s,o):Dx(u,Ht.memoizedState,s,o)},useTransition:function(){var s=O0(Wa)[0],o=En().memoizedState;return[typeof s=="boolean"?s:Yl(s),o]},useSyncExternalStore:ix,useId:Lx,useHostTransitionStatus:$0,useFormState:wx,useActionState:wx,useOptimistic:function(s,o){var u=En();return Ht!==null?dx(u,Ht,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:F0,useCacheRefresh:Ox},wo=null,Kl=0;function Zu(s){var o=Kl;return Kl+=1,wo===null&&(wo=[]),Zg(wo,s,o)}function Xl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Qu(s,o){throw o.$$typeof===v?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function $x(s){var o=s._init;return o(s._payload)}function Hx(s){function o(ce,ie){if(s){var fe=ce.deletions;fe===null?(ce.deletions=[ie],ce.flags|=16):fe.push(ie)}}function u(ce,ie){if(!s)return null;for(;ie!==null;)o(ce,ie),ie=ie.sibling;return null}function p(ce){for(var ie=new Map;ce!==null;)ce.key!==null?ie.set(ce.key,ce):ie.set(ce.index,ce),ce=ce.sibling;return ie}function y(ce,ie){return ce=Ha(ce,ie),ce.index=0,ce.sibling=null,ce}function w(ce,ie,fe){return ce.index=fe,s?(fe=ce.alternate,fe!==null?(fe=fe.index,fe<ie?(ce.flags|=67108866,ie):fe):(ce.flags|=67108866,ie)):(ce.flags|=1048576,ie)}function N(ce){return s&&ce.alternate===null&&(ce.flags|=67108866),ce}function L(ce,ie,fe,Ae){return ie===null||ie.tag!==6?(ie=u0(fe,ce.mode,Ae),ie.return=ce,ie):(ie=y(ie,fe),ie.return=ce,ie)}function ne(ce,ie,fe,Ae){var Ve=fe.type;return Ve===E?be(ce,ie,fe.props.children,Ae,fe.key):ie!==null&&(ie.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===K&&$x(Ve)===ie.type)?(ie=y(ie,fe.props),Xl(ie,fe),ie.return=ce,ie):(ie=Lu(fe.type,fe.key,fe.props,null,ce.mode,Ae),Xl(ie,fe),ie.return=ce,ie)}function he(ce,ie,fe,Ae){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==fe.containerInfo||ie.stateNode.implementation!==fe.implementation?(ie=f0(fe,ce.mode,Ae),ie.return=ce,ie):(ie=y(ie,fe.children||[]),ie.return=ce,ie)}function be(ce,ie,fe,Ae,Ve){return ie===null||ie.tag!==7?(ie=fi(fe,ce.mode,Ae,Ve),ie.return=ce,ie):(ie=y(ie,fe),ie.return=ce,ie)}function Ne(ce,ie,fe){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=u0(""+ie,ce.mode,fe),ie.return=ce,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return fe=Lu(ie.type,ie.key,ie.props,null,ce.mode,fe),Xl(fe,ie),fe.return=ce,fe;case T:return ie=f0(ie,ce.mode,fe),ie.return=ce,ie;case K:var Ae=ie._init;return ie=Ae(ie._payload),Ne(ce,ie,fe)}if(ye(ie)||te(ie))return ie=fi(ie,ce.mode,fe,null),ie.return=ce,ie;if(typeof ie.then=="function")return Ne(ce,Zu(ie),fe);if(ie.$$typeof===C)return Ne(ce,Bu(ce,ie),fe);Qu(ce,ie)}return null}function ge(ce,ie,fe,Ae){var Ve=ie!==null?ie.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Ve!==null?null:L(ce,ie,""+fe,Ae);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:return fe.key===Ve?ne(ce,ie,fe,Ae):null;case T:return fe.key===Ve?he(ce,ie,fe,Ae):null;case K:return Ve=fe._init,fe=Ve(fe._payload),ge(ce,ie,fe,Ae)}if(ye(fe)||te(fe))return Ve!==null?null:be(ce,ie,fe,Ae,null);if(typeof fe.then=="function")return ge(ce,ie,Zu(fe),Ae);if(fe.$$typeof===C)return ge(ce,ie,Bu(ce,fe),Ae);Qu(ce,fe)}return null}function xe(ce,ie,fe,Ae,Ve){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ce=ce.get(fe)||null,L(ie,ce,""+Ae,Ve);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case _:return ce=ce.get(Ae.key===null?fe:Ae.key)||null,ne(ie,ce,Ae,Ve);case T:return ce=ce.get(Ae.key===null?fe:Ae.key)||null,he(ie,ce,Ae,Ve);case K:var pt=Ae._init;return Ae=pt(Ae._payload),xe(ce,ie,fe,Ae,Ve)}if(ye(Ae)||te(Ae))return ce=ce.get(fe)||null,be(ie,ce,Ae,Ve,null);if(typeof Ae.then=="function")return xe(ce,ie,fe,Zu(Ae),Ve);if(Ae.$$typeof===C)return xe(ce,ie,fe,Bu(ie,Ae),Ve);Qu(ie,Ae)}return null}function Qe(ce,ie,fe,Ae){for(var Ve=null,pt=null,qe=ie,Ze=ie=0,Un=null;qe!==null&&Ze<fe.length;Ze++){qe.index>Ze?(Un=qe,qe=null):Un=qe.sibling;var Lt=ge(ce,qe,fe[Ze],Ae);if(Lt===null){qe===null&&(qe=Un);break}s&&qe&&Lt.alternate===null&&o(ce,qe),ie=w(Lt,ie,Ze),pt===null?Ve=Lt:pt.sibling=Lt,pt=Lt,qe=Un}if(Ze===fe.length)return u(ce,qe),Pt&&hi(ce,Ze),Ve;if(qe===null){for(;Ze<fe.length;Ze++)qe=Ne(ce,fe[Ze],Ae),qe!==null&&(ie=w(qe,ie,Ze),pt===null?Ve=qe:pt.sibling=qe,pt=qe);return Pt&&hi(ce,Ze),Ve}for(qe=p(qe);Ze<fe.length;Ze++)Un=xe(qe,ce,Ze,fe[Ze],Ae),Un!==null&&(s&&Un.alternate!==null&&qe.delete(Un.key===null?Ze:Un.key),ie=w(Un,ie,Ze),pt===null?Ve=Un:pt.sibling=Un,pt=Un);return s&&qe.forEach(function(Vs){return o(ce,Vs)}),Pt&&hi(ce,Ze),Ve}function Je(ce,ie,fe,Ae){if(fe==null)throw Error(r(151));for(var Ve=null,pt=null,qe=ie,Ze=ie=0,Un=null,Lt=fe.next();qe!==null&&!Lt.done;Ze++,Lt=fe.next()){qe.index>Ze?(Un=qe,qe=null):Un=qe.sibling;var Vs=ge(ce,qe,Lt.value,Ae);if(Vs===null){qe===null&&(qe=Un);break}s&&qe&&Vs.alternate===null&&o(ce,qe),ie=w(Vs,ie,Ze),pt===null?Ve=Vs:pt.sibling=Vs,pt=Vs,qe=Un}if(Lt.done)return u(ce,qe),Pt&&hi(ce,Ze),Ve;if(qe===null){for(;!Lt.done;Ze++,Lt=fe.next())Lt=Ne(ce,Lt.value,Ae),Lt!==null&&(ie=w(Lt,ie,Ze),pt===null?Ve=Lt:pt.sibling=Lt,pt=Lt);return Pt&&hi(ce,Ze),Ve}for(qe=p(qe);!Lt.done;Ze++,Lt=fe.next())Lt=xe(qe,ce,Ze,Lt.value,Ae),Lt!==null&&(s&&Lt.alternate!==null&&qe.delete(Lt.key===null?Ze:Lt.key),ie=w(Lt,ie,Ze),pt===null?Ve=Lt:pt.sibling=Lt,pt=Lt);return s&&qe.forEach(function(BC){return o(ce,BC)}),Pt&&hi(ce,Ze),Ve}function zt(ce,ie,fe,Ae){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:e:{for(var Ve=fe.key;ie!==null;){if(ie.key===Ve){if(Ve=fe.type,Ve===E){if(ie.tag===7){u(ce,ie.sibling),Ae=y(ie,fe.props.children),Ae.return=ce,ce=Ae;break e}}else if(ie.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===K&&$x(Ve)===ie.type){u(ce,ie.sibling),Ae=y(ie,fe.props),Xl(Ae,fe),Ae.return=ce,ce=Ae;break e}u(ce,ie);break}else o(ce,ie);ie=ie.sibling}fe.type===E?(Ae=fi(fe.props.children,ce.mode,Ae,fe.key),Ae.return=ce,ce=Ae):(Ae=Lu(fe.type,fe.key,fe.props,null,ce.mode,Ae),Xl(Ae,fe),Ae.return=ce,ce=Ae)}return N(ce);case T:e:{for(Ve=fe.key;ie!==null;){if(ie.key===Ve)if(ie.tag===4&&ie.stateNode.containerInfo===fe.containerInfo&&ie.stateNode.implementation===fe.implementation){u(ce,ie.sibling),Ae=y(ie,fe.children||[]),Ae.return=ce,ce=Ae;break e}else{u(ce,ie);break}else o(ce,ie);ie=ie.sibling}Ae=f0(fe,ce.mode,Ae),Ae.return=ce,ce=Ae}return N(ce);case K:return Ve=fe._init,fe=Ve(fe._payload),zt(ce,ie,fe,Ae)}if(ye(fe))return Qe(ce,ie,fe,Ae);if(te(fe)){if(Ve=te(fe),typeof Ve!="function")throw Error(r(150));return fe=Ve.call(fe),Je(ce,ie,fe,Ae)}if(typeof fe.then=="function")return zt(ce,ie,Zu(fe),Ae);if(fe.$$typeof===C)return zt(ce,ie,Bu(ce,fe),Ae);Qu(ce,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ie!==null&&ie.tag===6?(u(ce,ie.sibling),Ae=y(ie,fe),Ae.return=ce,ce=Ae):(u(ce,ie),Ae=u0(fe,ce.mode,Ae),Ae.return=ce,ce=Ae),N(ce)):u(ce,ie)}return function(ce,ie,fe,Ae){try{Kl=0;var Ve=zt(ce,ie,fe,Ae);return wo=null,Ve}catch(qe){if(qe===Vl||qe===Vu)throw qe;var pt=Ar(29,qe,null,ce.mode);return pt.lanes=Ae,pt.return=ce,pt}finally{}}}var To=Hx(!0),Gx=Hx(!1),zr=ee(null),ya=null;function Cs(s){var o=s.alternate;W(Rn,Rn.current&1),W(zr,s),ya===null&&(o===null||xo.current!==null||o.memoizedState!==null)&&(ya=s)}function zx(s){if(s.tag===22){if(W(Rn,Rn.current),W(zr,s),ya===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(ya=s)}}else As()}function As(){W(Rn,Rn.current),W(zr,zr.current)}function Ja(s){I(zr),ya===s&&(ya=null),I(Rn)}var Rn=ee(0);function ef(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Ih(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function G0(s,o,u,p){o=s.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var z0={enqueueSetState:function(s,o,u){s=s._reactInternals;var p=Dr(),y=Es(p);y.payload=o,u!=null&&(y.callback=u),o=Ss(s,y,p),o!==null&&(Mr(o,s,p),Hl(o,s,p))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var p=Dr(),y=Es(p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Ss(s,y,p),o!==null&&(Mr(o,s,p),Hl(o,s,p))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Dr(),p=Es(u);p.tag=2,o!=null&&(p.callback=o),o=Ss(s,p,u),o!==null&&(Mr(o,s,u),Hl(o,s,u))}};function qx(s,o,u,p,y,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,w,N):o.prototype&&o.prototype.isPureReactComponent?!Il(u,p)||!Il(y,w):!0}function Yx(s,o,u,p){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==s&&z0.enqueueReplaceState(o,o.state,null)}function _i(s,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(s=s.defaultProps){u===o&&(u=g({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}var tf=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Wx(s){tf(s)}function Jx(s){console.error(s)}function Kx(s){tf(s)}function nf(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function Xx(s,o,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function q0(s,o,u){return u=Es(u),u.tag=3,u.payload={element:null},u.callback=function(){nf(s,o)},u}function Zx(s){return s=Es(s),s.tag=3,s}function Qx(s,o,u,p){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var w=p.value;s.payload=function(){return y(w)},s.callback=function(){Xx(o,u,p)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){Xx(o,u,p),typeof y!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var L=p.stack;this.componentDidCatch(p.value,{componentStack:L!==null?L:""})})}function Bb(s,o,u,p,y){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Ul(o,u,y,!0),u=zr.current,u!==null){switch(u.tag){case 13:return ya===null?gh():u.alternate===null&&pn===0&&(pn=3),u.flags&=-257,u.flags|=65536,u.lanes=y,p===w0?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),vh(s,p,y)),!1;case 22:return u.flags|=65536,p===w0?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),vh(s,p,y)),!1}throw Error(r(435,u.tag))}return vh(s,p,y),gh(),!1}if(Pt)return o=zr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,p!==m0&&(s=Error(r(422),{cause:p}),Pl(Vr(s,u)))):(p!==m0&&(o=Error(r(423),{cause:p}),Pl(Vr(o,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,p=Vr(p,u),y=q0(s.stateNode,p,y),S0(s,y),pn!==4&&(pn=2)),!1;var w=Error(r(520),{cause:p});if(w=Vr(w,u),ac===null?ac=[w]:ac.push(w),pn!==4&&(pn=2),o===null)return!0;p=Vr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=q0(u.stateNode,p,s),S0(u,s),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Is===null||!Is.has(w))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Zx(y),Qx(y,s,u,p),S0(u,y),!1}u=u.return}while(u!==null);return!1}var ev=Error(r(461)),On=!1;function Gn(s,o,u,p){o.child=s===null?Gx(o,null,u,p):To(o,s.child,u,p)}function tv(s,o,u,p,y){u=u.render;var w=o.ref;if("ref"in p){var N={};for(var L in p)L!=="ref"&&(N[L]=p[L])}else N=p;return xi(o),p=N0(s,o,u,N,w,y),L=R0(),s!==null&&!On?(D0(s,o,y),Ka(s,o,y)):(Pt&&L&&d0(o),o.flags|=1,Gn(s,o,p,y),o.child)}function nv(s,o,u,p,y){if(s===null){var w=u.type;return typeof w=="function"&&!c0(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,rv(s,o,w,p,y)):(s=Lu(u.type,null,p,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!eh(s,y)){var N=w.memoizedProps;if(u=u.compare,u=u!==null?u:Il,u(N,p)&&s.ref===o.ref)return Ka(s,o,y)}return o.flags|=1,s=Ha(w,p),s.ref=o.ref,s.return=o,o.child=s}function rv(s,o,u,p,y){if(s!==null){var w=s.memoizedProps;if(Il(w,p)&&s.ref===o.ref)if(On=!1,o.pendingProps=p=w,eh(s,y))(s.flags&131072)!==0&&(On=!0);else return o.lanes=s.lanes,Ka(s,o,y)}return Y0(s,o,u,p,y)}function av(s,o,u){var p=o.pendingProps,y=p.children,w=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=w!==null?w.baseLanes|u:u,s!==null){for(y=o.child=s.child,w=0;y!==null;)w=w|y.lanes|y.childLanes,y=y.sibling;o.childLanes=w&~p}else o.childLanes=0,o.child=null;return sv(s,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&ju(o,w!==null?w.cachePool:null),w!==null?rx(o,w):C0(),zx(o);else return o.lanes=o.childLanes=536870912,sv(s,o,w!==null?w.baseLanes|u:u,u)}else w!==null?(ju(o,w.cachePool),rx(o,w),As(),o.memoizedState=null):(s!==null&&ju(o,null),C0(),As());return Gn(s,o,y,u),o.child}function sv(s,o,u,p){var y=_0();return y=y===null?null:{parent:Nn._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},s!==null&&ju(o,null),C0(),zx(o),s!==null&&Ul(s,o,p,!0),null}function rf(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function Y0(s,o,u,p,y){return xi(o),u=N0(s,o,u,p,void 0,y),p=R0(),s!==null&&!On?(D0(s,o,y),Ka(s,o,y)):(Pt&&p&&d0(o),o.flags|=1,Gn(s,o,u,y),o.child)}function iv(s,o,u,p,y,w){return xi(o),o.updateQueue=null,u=sx(o,p,u,y),ax(s),p=R0(),s!==null&&!On?(D0(s,o,w),Ka(s,o,w)):(Pt&&p&&d0(o),o.flags|=1,Gn(s,o,u,w),o.child)}function ov(s,o,u,p,y){if(xi(o),o.stateNode===null){var w=fo,N=u.contextType;typeof N=="object"&&N!==null&&(w=Kn(N)),w=new u(p,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=z0,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=p,w.state=o.memoizedState,w.refs={},T0(o),N=u.contextType,w.context=typeof N=="object"&&N!==null?Kn(N):fo,w.state=o.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(G0(o,u,N,p),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&z0.enqueueReplaceState(w,w.state,null),zl(o,p,w,y),Gl(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(s===null){w=o.stateNode;var L=o.memoizedProps,ne=_i(u,L);w.props=ne;var he=w.context,be=u.contextType;N=fo,typeof be=="object"&&be!==null&&(N=Kn(be));var Ne=u.getDerivedStateFromProps;be=typeof Ne=="function"||typeof w.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,be||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(L||he!==N)&&Yx(o,w,p,N),Ts=!1;var ge=o.memoizedState;w.state=ge,zl(o,p,w,y),Gl(),he=o.memoizedState,L||ge!==he||Ts?(typeof Ne=="function"&&(G0(o,u,Ne,p),he=o.memoizedState),(ne=Ts||qx(o,u,ne,p,ge,he,N))?(be||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=he),w.props=p,w.state=he,w.context=N,p=ne):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{w=o.stateNode,E0(s,o),N=o.memoizedProps,be=_i(u,N),w.props=be,Ne=o.pendingProps,ge=w.context,he=u.contextType,ne=fo,typeof he=="object"&&he!==null&&(ne=Kn(he)),L=u.getDerivedStateFromProps,(he=typeof L=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==Ne||ge!==ne)&&Yx(o,w,p,ne),Ts=!1,ge=o.memoizedState,w.state=ge,zl(o,p,w,y),Gl();var xe=o.memoizedState;N!==Ne||ge!==xe||Ts||s!==null&&s.dependencies!==null&&Uu(s.dependencies)?(typeof L=="function"&&(G0(o,u,L,p),xe=o.memoizedState),(be=Ts||qx(o,u,be,p,ge,xe,ne)||s!==null&&s.dependencies!==null&&Uu(s.dependencies))?(he||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(p,xe,ne),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(p,xe,ne)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=xe),w.props=p,w.state=xe,w.context=ne,p=be):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),p=!1)}return w=p,rf(s,o),p=(o.flags&128)!==0,w||p?(w=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&p?(o.child=To(o,s.child,null,y),o.child=To(o,null,u,y)):Gn(s,o,u,y),o.memoizedState=w.state,s=o.child):s=Ka(s,o,y),s}function lv(s,o,u,p){return Ol(),o.flags|=256,Gn(s,o,u,p),o.child}var W0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function J0(s){return{baseLanes:s,cachePool:Jg()}}function K0(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=qr),s}function cv(s,o,u){var p=o.pendingProps,y=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),N&&(y=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(Pt){if(y?Cs(o):As(),Pt){var L=mn,ne;if(ne=L){e:{for(ne=L,L=va;ne.nodeType!==8;){if(!L){L=null;break e}if(ne=sa(ne.nextSibling),ne===null){L=null;break e}}L=ne}L!==null?(o.memoizedState={dehydrated:L,treeContext:di!==null?{id:Ga,overflow:za}:null,retryLane:536870912,hydrationErrors:null},ne=Ar(18,null,null,0),ne.stateNode=L,ne.return=o,o.child=ne,cr=o,mn=null,ne=!0):ne=!1}ne||pi(o)}if(L=o.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return Ih(L)?o.lanes=32:o.lanes=536870912,null;Ja(o)}return L=p.children,p=p.fallback,y?(As(),y=o.mode,L=af({mode:"hidden",children:L},y),p=fi(p,y,u,null),L.return=o,p.return=o,L.sibling=p,o.child=L,y=o.child,y.memoizedState=J0(u),y.childLanes=K0(s,N,u),o.memoizedState=W0,p):(Cs(o),X0(o,L))}if(ne=s.memoizedState,ne!==null&&(L=ne.dehydrated,L!==null)){if(w)o.flags&256?(Cs(o),o.flags&=-257,o=Z0(s,o,u)):o.memoizedState!==null?(As(),o.child=s.child,o.flags|=128,o=null):(As(),y=p.fallback,L=o.mode,p=af({mode:"visible",children:p.children},L),y=fi(y,L,u,null),y.flags|=2,p.return=o,y.return=o,p.sibling=y,o.child=p,To(o,s.child,null,u),p=o.child,p.memoizedState=J0(u),p.childLanes=K0(s,N,u),o.memoizedState=W0,o=y);else if(Cs(o),Ih(L)){if(N=L.nextSibling&&L.nextSibling.dataset,N)var he=N.dgst;N=he,p=Error(r(419)),p.stack="",p.digest=N,Pl({value:p,source:null,stack:null}),o=Z0(s,o,u)}else if(On||Ul(s,o,u,!1),N=(u&s.childLanes)!==0,On||N){if(N=Wt,N!==null&&(p=u&-u,p=(p&42)!==0?1:ja(p),p=(p&(N.suspendedLanes|u))!==0?0:p,p!==0&&p!==ne.retryLane))throw ne.retryLane=p,uo(s,p),Mr(N,s,p),ev;L.data==="$?"||gh(),o=Z0(s,o,u)}else L.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=ne.treeContext,mn=sa(L.nextSibling),cr=o,Pt=!0,mi=null,va=!1,s!==null&&(Hr[Gr++]=Ga,Hr[Gr++]=za,Hr[Gr++]=di,Ga=s.id,za=s.overflow,di=o),o=X0(o,p.children),o.flags|=4096);return o}return y?(As(),y=p.fallback,L=o.mode,ne=s.child,he=ne.sibling,p=Ha(ne,{mode:"hidden",children:p.children}),p.subtreeFlags=ne.subtreeFlags&65011712,he!==null?y=Ha(he,y):(y=fi(y,L,u,null),y.flags|=2),y.return=o,p.return=o,p.sibling=y,o.child=p,p=y,y=o.child,L=s.child.memoizedState,L===null?L=J0(u):(ne=L.cachePool,ne!==null?(he=Nn._currentValue,ne=ne.parent!==he?{parent:he,pool:he}:ne):ne=Jg(),L={baseLanes:L.baseLanes|u,cachePool:ne}),y.memoizedState=L,y.childLanes=K0(s,N,u),o.memoizedState=W0,p):(Cs(o),u=s.child,s=u.sibling,u=Ha(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=u,o.memoizedState=null,u)}function X0(s,o){return o=af({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function af(s,o){return s=Ar(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Z0(s,o,u){return To(o,s.child,null,u),s=X0(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function uv(s,o,u){s.lanes|=o;var p=s.alternate;p!==null&&(p.lanes|=o),g0(s.return,o,u)}function Q0(s,o,u,p,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:y}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=u,w.tailMode=y)}function fv(s,o,u){var p=o.pendingProps,y=p.revealOrder,w=p.tail;if(Gn(s,o,p.children,u),p=Rn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&uv(s,u,o);else if(s.tag===19)uv(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(W(Rn,p),y){case"forwards":for(u=o.child,y=null;u!==null;)s=u.alternate,s!==null&&ef(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),Q0(o,!1,y,u,w);break;case"backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&ef(s)===null){o.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}Q0(o,!0,u,null,w);break;case"together":Q0(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ka(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Ms|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Ul(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=Ha(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Ha(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function eh(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Uu(s)))}function jb(s,o,u){switch(o.tag){case 3:Se(o,o.stateNode.containerInfo),ws(o,Nn,s.memoizedState.cache),Ol();break;case 27:case 5:Ce(o);break;case 4:Se(o,o.stateNode.containerInfo);break;case 10:ws(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(Cs(o),o.flags|=128,null):(u&o.child.childLanes)!==0?cv(s,o,u):(Cs(o),s=Ka(s,o,u),s!==null?s.sibling:null);Cs(o);break;case 19:var y=(s.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Ul(s,o,u,!1),p=(u&o.childLanes)!==0),y){if(p)return fv(s,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),W(Rn,Rn.current),p)break;return null;case 22:case 23:return o.lanes=0,av(s,o,u);case 24:ws(o,Nn,s.memoizedState.cache)}return Ka(s,o,u)}function dv(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)On=!0;else{if(!eh(s,u)&&(o.flags&128)===0)return On=!1,jb(s,o,u);On=(s.flags&131072)!==0}else On=!1,Pt&&(o.flags&1048576)!==0&&$g(o,Pu,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var p=o.elementType,y=p._init;if(p=y(p._payload),o.type=p,typeof p=="function")c0(p)?(s=_i(p,s),o.tag=1,o=ov(null,o,p,s,u)):(o.tag=0,o=Y0(null,o,p,s,u));else{if(p!=null){if(y=p.$$typeof,y===M){o.tag=11,o=tv(null,o,p,s,u);break e}else if(y===F){o.tag=14,o=nv(null,o,p,s,u);break e}}throw o=Re(p)||p,Error(r(306,o,""))}}return o;case 0:return Y0(s,o,o.type,o.pendingProps,u);case 1:return p=o.type,y=_i(p,o.pendingProps),ov(s,o,p,y,u);case 3:e:{if(Se(o,o.stateNode.containerInfo),s===null)throw Error(r(387));p=o.pendingProps;var w=o.memoizedState;y=w.element,E0(s,o),zl(o,p,null,u);var N=o.memoizedState;if(p=N.cache,ws(o,Nn,p),p!==w.cache&&x0(o,[Nn],u,!0),Gl(),p=N.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=lv(s,o,p,u);break e}else if(p!==y){y=Vr(Error(r(424)),o),Pl(y),o=lv(s,o,p,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mn=sa(s.firstChild),cr=o,Pt=!0,mi=null,va=!0,u=Gx(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ol(),p===y){o=Ka(s,o,u);break e}Gn(s,o,p,u)}o=o.child}return o;case 26:return rf(s,o),s===null?(u=g1(o.type,null,o.pendingProps,null))?o.memoizedState=u:Pt||(u=o.type,s=o.pendingProps,p=yf(oe.current).createElement(u),p[un]=o,p[fn]=s,qn(p,u,s),le(p),o.stateNode=p):o.memoizedState=g1(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Ce(o),s===null&&Pt&&(p=o.stateNode=h1(o.type,o.pendingProps,oe.current),cr=o,va=!0,y=mn,Os(o.type)?(Fh=y,mn=sa(p.firstChild)):mn=y),Gn(s,o,o.pendingProps.children,u),rf(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Pt&&((y=p=mn)&&(p=mC(p,o.type,o.pendingProps,va),p!==null?(o.stateNode=p,cr=o,mn=sa(p.firstChild),va=!1,y=!0):y=!1),y||pi(o)),Ce(o),y=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,p=w.children,Rh(y,w)?p=null:N!==null&&Rh(y,N)&&(o.flags|=32),o.memoizedState!==null&&(y=N0(s,o,Mb,null,null,u),hc._currentValue=y),rf(s,o),Gn(s,o,p,u),o.child;case 6:return s===null&&Pt&&((s=u=mn)&&(u=pC(u,o.pendingProps,va),u!==null?(o.stateNode=u,cr=o,mn=null,s=!0):s=!1),s||pi(o)),null;case 13:return cv(s,o,u);case 4:return Se(o,o.stateNode.containerInfo),p=o.pendingProps,s===null?o.child=To(o,null,p,u):Gn(s,o,p,u),o.child;case 11:return tv(s,o,o.type,o.pendingProps,u);case 7:return Gn(s,o,o.pendingProps,u),o.child;case 8:return Gn(s,o,o.pendingProps.children,u),o.child;case 12:return Gn(s,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,ws(o,o.type,p.value),Gn(s,o,p.children,u),o.child;case 9:return y=o.type._context,p=o.pendingProps.children,xi(o),y=Kn(y),p=p(y),o.flags|=1,Gn(s,o,p,u),o.child;case 14:return nv(s,o,o.type,o.pendingProps,u);case 15:return rv(s,o,o.type,o.pendingProps,u);case 19:return fv(s,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},s===null?(u=af(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Ha(s.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return av(s,o,u);case 24:return xi(o),p=Kn(Nn),s===null?(y=_0(),y===null&&(y=Wt,w=v0(),y.pooledCache=w,w.refCount++,w!==null&&(y.pooledCacheLanes|=u),y=w),o.memoizedState={parent:p,cache:y},T0(o),ws(o,Nn,y)):((s.lanes&u)!==0&&(E0(s,o),zl(o,null,null,u),Gl()),y=s.memoizedState,w=o.memoizedState,y.parent!==p?(y={parent:p,cache:p},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),ws(o,Nn,p)):(p=w.cache,ws(o,Nn,p),p!==y.cache&&x0(o,[Nn],u,!0))),Gn(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Xa(s){s.flags|=4}function hv(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!w1(o)){if(o=zr.current,o!==null&&((At&4194048)===At?ya!==null:(At&62914560)!==At&&(At&536870912)===0||o!==ya))throw $l=w0,Kg;s.flags|=8192}}function sf(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Ua():536870912,s.lanes|=o,Co|=o)}function Zl(s,o){if(!Pt)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function on(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(o)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=p,s.childLanes=u,o}function Vb(s,o,u){var p=o.pendingProps;switch(h0(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(o),null;case 1:return on(o),null;case 3:return u=o.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Ya(Nn),Ee(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Ll(o)?Xa(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zg())),on(o),null;case 26:return u=o.memoizedState,s===null?(Xa(o),u!==null?(on(o),hv(o,u)):(on(o),o.flags&=-16777217)):u?u!==s.memoizedState?(Xa(o),on(o),hv(o,u)):(on(o),o.flags&=-16777217):(s.memoizedProps!==p&&Xa(o),on(o),o.flags&=-16777217),null;case 27:Ke(o),u=oe.current;var y=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return on(o),null}s=X.current,Ll(o)?Hg(o):(s=h1(y,p,u),o.stateNode=s,Xa(o))}return on(o),null;case 5:if(Ke(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return on(o),null}if(s=X.current,Ll(o))Hg(o);else{switch(y=yf(oe.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?y.createElement(u,{is:p.is}):y.createElement(u)}}s[un]=o,s[fn]=p;e:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break e;for(;y.sibling===null;){if(y.return===null||y.return===o)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=s;e:switch(qn(s,u,p),u){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Xa(o)}}return on(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(s=oe.current,Ll(o)){if(s=o.stateNode,u=o.memoizedProps,p=null,y=cr,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}s[un]=o,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||i1(s.nodeValue,u)),s||pi(o)}else s=yf(s).createTextNode(p),s[un]=o,o.stateNode=s}return on(o),null;case 13:if(p=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Ll(o),p!==null&&p.dehydrated!==null){if(s===null){if(!y)throw Error(r(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[un]=o}else Ol(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;on(o),y=!1}else y=zg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Ja(o),o):(Ja(o),null)}if(Ja(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,s=s!==null&&s.memoizedState!==null,u){p=o.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var w=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==y&&(p.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),sf(o,o.updateQueue),on(o),null;case 4:return Ee(),s===null&&bh(o.stateNode.containerInfo),on(o),null;case 10:return Ya(o.type),on(o),null;case 19:if(I(Rn),y=o.memoizedState,y===null)return on(o),null;if(p=(o.flags&128)!==0,w=y.rendering,w===null)if(p)Zl(y,!1);else{if(pn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=ef(s),w!==null){for(o.flags|=128,Zl(y,!1),s=w.updateQueue,o.updateQueue=s,sf(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)Vg(u,s),u=u.sibling;return W(Rn,Rn.current&1|2),o.child}s=s.sibling}y.tail!==null&&Fe()>cf&&(o.flags|=128,p=!0,Zl(y,!1),o.lanes=4194304)}else{if(!p)if(s=ef(w),s!==null){if(o.flags|=128,p=!0,s=s.updateQueue,o.updateQueue=s,sf(o,s),Zl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!w.alternate&&!Pt)return on(o),null}else 2*Fe()-y.renderingStartTime>cf&&u!==536870912&&(o.flags|=128,p=!0,Zl(y,!1),o.lanes=4194304);y.isBackwards?(w.sibling=o.child,o.child=w):(s=y.last,s!==null?s.sibling=w:o.child=w,y.last=w)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Fe(),o.sibling=null,s=Rn.current,W(Rn,p?s&1|2:s&1),o):(on(o),null);case 22:case 23:return Ja(o),A0(),p=o.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(on(o),o.subtreeFlags&6&&(o.flags|=8192)):on(o),u=o.updateQueue,u!==null&&sf(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),s!==null&&I(vi),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ya(Nn),on(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function $b(s,o){switch(h0(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Ya(Nn),Ee(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Ke(o),null;case 13:if(Ja(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Ol()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return I(Rn),null;case 4:return Ee(),null;case 10:return Ya(o.type),null;case 22:case 23:return Ja(o),A0(),s!==null&&I(vi),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Ya(Nn),null;case 25:return null;default:return null}}function mv(s,o){switch(h0(o),o.tag){case 3:Ya(Nn),Ee();break;case 26:case 27:case 5:Ke(o);break;case 4:Ee();break;case 13:Ja(o);break;case 19:I(Rn);break;case 10:Ya(o.type);break;case 22:case 23:Ja(o),A0(),s!==null&&I(vi);break;case 24:Ya(Nn)}}function Ql(s,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&s)===s){p=void 0;var w=u.create,N=u.inst;p=w(),N.destroy=p}u=u.next}while(u!==y)}}catch(L){qt(o,o.return,L)}}function ks(s,o,u){try{var p=o.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var w=y.next;p=w;do{if((p.tag&s)===s){var N=p.inst,L=N.destroy;if(L!==void 0){N.destroy=void 0,y=o;var ne=u,he=L;try{he()}catch(be){qt(y,ne,be)}}}p=p.next}while(p!==w)}}catch(be){qt(o,o.return,be)}}function pv(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{nx(o,u)}catch(p){qt(s,s.return,p)}}}function gv(s,o,u){u.props=_i(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){qt(s,o,p)}}function ec(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(y){qt(s,o,y)}}function _a(s,o){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(y){qt(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){qt(s,o,y)}else u.current=null}function xv(s){var o=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(y){qt(s,s.return,y)}}function th(s,o,u){try{var p=s.stateNode;cC(p,s.type,u,o),p[fn]=o}catch(y){qt(s,s.return,y)}}function vv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Os(s.type)||s.tag===4}function nh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||vv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Os(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function rh(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=vf));else if(p!==4&&(p===27&&Os(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(rh(s,o,u),s=s.sibling;s!==null;)rh(s,o,u),s=s.sibling}function of(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(p!==4&&(p===27&&Os(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(of(s,o,u),s=s.sibling;s!==null;)of(s,o,u),s=s.sibling}function yv(s){var o=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);qn(o,p,u),o[un]=s,o[fn]=u}catch(w){qt(s,s.return,w)}}var Za=!1,_n=!1,ah=!1,_v=typeof WeakSet=="function"?WeakSet:Set,Pn=null;function Hb(s,o){if(s=s.containerInfo,kh=bf,s=Dg(s),n0(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var y=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var N=0,L=-1,ne=-1,he=0,be=0,Ne=s,ge=null;t:for(;;){for(var xe;Ne!==u||y!==0&&Ne.nodeType!==3||(L=N+y),Ne!==w||p!==0&&Ne.nodeType!==3||(ne=N+p),Ne.nodeType===3&&(N+=Ne.nodeValue.length),(xe=Ne.firstChild)!==null;)ge=Ne,Ne=xe;for(;;){if(Ne===s)break t;if(ge===u&&++he===y&&(L=N),ge===w&&++be===p&&(ne=N),(xe=Ne.nextSibling)!==null)break;Ne=ge,ge=Ne.parentNode}Ne=xe}u=L===-1||ne===-1?null:{start:L,end:ne}}else u=null}u=u||{start:0,end:0}}else u=null;for(Nh={focusedElem:s,selectionRange:u},bf=!1,Pn=o;Pn!==null;)if(o=Pn,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Pn=s;else for(;Pn!==null;){switch(o=Pn,w=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,u=o,y=w.memoizedProps,w=w.memoizedState,p=u.stateNode;try{var Qe=_i(u.type,y,u.elementType===u.type);s=p.getSnapshotBeforeUpdate(Qe,w),p.__reactInternalSnapshotBeforeUpdate=s}catch(Je){qt(u,u.return,Je)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)Mh(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Mh(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Pn=s;break}Pn=o.return}}function wv(s,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Ns(s,u),p&4&&Ql(5,u);break;case 1:if(Ns(s,u),p&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(N){qt(u,u.return,N)}else{var y=_i(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){qt(u,u.return,N)}}p&64&&pv(u),p&512&&ec(u,u.return);break;case 3:if(Ns(s,u),p&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{nx(s,o)}catch(N){qt(u,u.return,N)}}break;case 27:o===null&&p&4&&yv(u);case 26:case 5:Ns(s,u),o===null&&p&4&&xv(u),p&512&&ec(u,u.return);break;case 12:Ns(s,u);break;case 13:Ns(s,u),p&4&&Sv(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=Zb.bind(null,u),gC(s,u))));break;case 22:if(p=u.memoizedState!==null||Za,!p){o=o!==null&&o.memoizedState!==null||_n,y=Za;var w=_n;Za=p,(_n=o)&&!w?Rs(s,u,(u.subtreeFlags&8772)!==0):Ns(s,u),Za=y,_n=w}break;case 30:break;default:Ns(s,u)}}function Tv(s){var o=s.alternate;o!==null&&(s.alternate=null,Tv(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&V(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var tn=null,_r=!1;function Qa(s,o,u){for(u=u.child;u!==null;)Ev(s,o,u),u=u.sibling}function Ev(s,o,u){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(vn,u)}catch{}switch(u.tag){case 26:_n||_a(u,o),Qa(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:_n||_a(u,o);var p=tn,y=_r;Os(u.type)&&(tn=u.stateNode,_r=!1),Qa(s,o,u),cc(u.stateNode),tn=p,_r=y;break;case 5:_n||_a(u,o);case 6:if(p=tn,y=_r,tn=null,Qa(s,o,u),tn=p,_r=y,tn!==null)if(_r)try{(tn.nodeType===9?tn.body:tn.nodeName==="HTML"?tn.ownerDocument.body:tn).removeChild(u.stateNode)}catch(w){qt(u,o,w)}else try{tn.removeChild(u.stateNode)}catch(w){qt(u,o,w)}break;case 18:tn!==null&&(_r?(s=tn,f1(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),xc(s)):f1(tn,u.stateNode));break;case 4:p=tn,y=_r,tn=u.stateNode.containerInfo,_r=!0,Qa(s,o,u),tn=p,_r=y;break;case 0:case 11:case 14:case 15:_n||ks(2,u,o),_n||ks(4,u,o),Qa(s,o,u);break;case 1:_n||(_a(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&gv(u,o,p)),Qa(s,o,u);break;case 21:Qa(s,o,u);break;case 22:_n=(p=_n)||u.memoizedState!==null,Qa(s,o,u),_n=p;break;default:Qa(s,o,u)}}function Sv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{xc(s)}catch(u){qt(o,o.return,u)}}function Gb(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new _v),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new _v),o;default:throw Error(r(435,s.tag))}}function sh(s,o){var u=Gb(s);o.forEach(function(p){var y=Qb.bind(null,s,p);u.has(p)||(u.add(p),p.then(y,y))})}function kr(s,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var y=u[p],w=s,N=o,L=N;e:for(;L!==null;){switch(L.tag){case 27:if(Os(L.type)){tn=L.stateNode,_r=!1;break e}break;case 5:tn=L.stateNode,_r=!1;break e;case 3:case 4:tn=L.stateNode.containerInfo,_r=!0;break e}L=L.return}if(tn===null)throw Error(r(160));Ev(w,N,y),tn=null,_r=!1,w=y.alternate,w!==null&&(w.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)bv(o,s),o=o.sibling}var aa=null;function bv(s,o){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:kr(o,s),Nr(s),p&4&&(ks(3,s,s.return),Ql(3,s),ks(5,s,s.return));break;case 1:kr(o,s),Nr(s),p&512&&(_n||u===null||_a(u,u.return)),p&64&&Za&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var y=aa;if(kr(o,s),Nr(s),p&512&&(_n||u===null||_a(u,u.return)),p&4){var w=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":w=y.getElementsByTagName("title")[0],(!w||w[O]||w[un]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=y.createElement(p),y.head.insertBefore(w,y.querySelector("head > title"))),qn(w,p,u),w[un]=s,le(w),p=w;break e;case"link":var N=y1("link","href",y).get(p+(u.href||""));if(N){for(var L=0;L<N.length;L++)if(w=N[L],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(L,1);break t}}w=y.createElement(p),qn(w,p,u),y.head.appendChild(w);break;case"meta":if(N=y1("meta","content",y).get(p+(u.content||""))){for(L=0;L<N.length;L++)if(w=N[L],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(L,1);break t}}w=y.createElement(p),qn(w,p,u),y.head.appendChild(w);break;default:throw Error(r(468,p))}w[un]=s,le(w),p=w}s.stateNode=p}else _1(y,s.type,s.stateNode);else s.stateNode=v1(y,p,s.memoizedProps);else w!==p?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,p===null?_1(y,s.type,s.stateNode):v1(y,p,s.memoizedProps)):p===null&&s.stateNode!==null&&th(s,s.memoizedProps,u.memoizedProps)}break;case 27:kr(o,s),Nr(s),p&512&&(_n||u===null||_a(u,u.return)),u!==null&&p&4&&th(s,s.memoizedProps,u.memoizedProps);break;case 5:if(kr(o,s),Nr(s),p&512&&(_n||u===null||_a(u,u.return)),s.flags&32){y=s.stateNode;try{ro(y,"")}catch(xe){qt(s,s.return,xe)}}p&4&&s.stateNode!=null&&(y=s.memoizedProps,th(s,y,u!==null?u.memoizedProps:y)),p&1024&&(ah=!0);break;case 6:if(kr(o,s),Nr(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(xe){qt(s,s.return,xe)}}break;case 3:if(Tf=null,y=aa,aa=_f(o.containerInfo),kr(o,s),aa=y,Nr(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{xc(o.containerInfo)}catch(xe){qt(s,s.return,xe)}ah&&(ah=!1,Cv(s));break;case 4:p=aa,aa=_f(s.stateNode.containerInfo),kr(o,s),Nr(s),aa=p;break;case 12:kr(o,s),Nr(s);break;case 13:kr(o,s),Nr(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(fh=Fe()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,sh(s,p)));break;case 22:y=s.memoizedState!==null;var ne=u!==null&&u.memoizedState!==null,he=Za,be=_n;if(Za=he||y,_n=be||ne,kr(o,s),_n=be,Za=he,Nr(s),p&8192)e:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||ne||Za||_n||wi(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){ne=u=o;try{if(w=ne.stateNode,y)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{L=ne.stateNode;var Ne=ne.memoizedProps.style,ge=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null;L.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(xe){qt(ne,ne.return,xe)}}}else if(o.tag===6){if(u===null){ne=o;try{ne.stateNode.nodeValue=y?"":ne.memoizedProps}catch(xe){qt(ne,ne.return,xe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,sh(s,u))));break;case 19:kr(o,s),Nr(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,sh(s,p)));break;case 30:break;case 21:break;default:kr(o,s),Nr(s)}}function Nr(s){var o=s.flags;if(o&2){try{for(var u,p=s.return;p!==null;){if(vv(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var y=u.stateNode,w=nh(s);of(s,w,y);break;case 5:var N=u.stateNode;u.flags&32&&(ro(N,""),u.flags&=-33);var L=nh(s);of(s,L,N);break;case 3:case 4:var ne=u.stateNode.containerInfo,he=nh(s);rh(s,he,ne);break;default:throw Error(r(161))}}catch(be){qt(s,s.return,be)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Cv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Cv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Ns(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)wv(s,o.alternate,o),o=o.sibling}function wi(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:ks(4,o,o.return),wi(o);break;case 1:_a(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&gv(o,o.return,u),wi(o);break;case 27:cc(o.stateNode);case 26:case 5:_a(o,o.return),wi(o);break;case 22:o.memoizedState===null&&wi(o);break;case 30:wi(o);break;default:wi(o)}s=s.sibling}}function Rs(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,y=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:Rs(y,w,u),Ql(4,w);break;case 1:if(Rs(y,w,u),p=w,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(he){qt(p,p.return,he)}if(p=w,y=p.updateQueue,y!==null){var L=p.stateNode;try{var ne=y.shared.hiddenCallbacks;if(ne!==null)for(y.shared.hiddenCallbacks=null,y=0;y<ne.length;y++)tx(ne[y],L)}catch(he){qt(p,p.return,he)}}u&&N&64&&pv(w),ec(w,w.return);break;case 27:yv(w);case 26:case 5:Rs(y,w,u),u&&p===null&&N&4&&xv(w),ec(w,w.return);break;case 12:Rs(y,w,u);break;case 13:Rs(y,w,u),u&&N&4&&Sv(y,w);break;case 22:w.memoizedState===null&&Rs(y,w,u),ec(w,w.return);break;case 30:break;default:Rs(y,w,u)}o=o.sibling}}function ih(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Bl(u))}function oh(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Bl(s))}function wa(s,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Av(s,o,u,p),o=o.sibling}function Av(s,o,u,p){var y=o.flags;switch(o.tag){case 0:case 11:case 15:wa(s,o,u,p),y&2048&&Ql(9,o);break;case 1:wa(s,o,u,p);break;case 3:wa(s,o,u,p),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Bl(s)));break;case 12:if(y&2048){wa(s,o,u,p),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,L=w.onPostCommit;typeof L=="function"&&L(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ne){qt(o,o.return,ne)}}else wa(s,o,u,p);break;case 13:wa(s,o,u,p);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?wa(s,o,u,p):tc(s,o):w._visibility&2?wa(s,o,u,p):(w._visibility|=2,Eo(s,o,u,p,(o.subtreeFlags&10256)!==0)),y&2048&&ih(N,o);break;case 24:wa(s,o,u,p),y&2048&&oh(o.alternate,o);break;default:wa(s,o,u,p)}}function Eo(s,o,u,p,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var w=s,N=o,L=u,ne=p,he=N.flags;switch(N.tag){case 0:case 11:case 15:Eo(w,N,L,ne,y),Ql(8,N);break;case 23:break;case 22:var be=N.stateNode;N.memoizedState!==null?be._visibility&2?Eo(w,N,L,ne,y):tc(w,N):(be._visibility|=2,Eo(w,N,L,ne,y)),y&&he&2048&&ih(N.alternate,N);break;case 24:Eo(w,N,L,ne,y),y&&he&2048&&oh(N.alternate,N);break;default:Eo(w,N,L,ne,y)}o=o.sibling}}function tc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,p=o,y=p.flags;switch(p.tag){case 22:tc(u,p),y&2048&&ih(p.alternate,p);break;case 24:tc(u,p),y&2048&&oh(p.alternate,p);break;default:tc(u,p)}o=o.sibling}}var nc=8192;function So(s){if(s.subtreeFlags&nc)for(s=s.child;s!==null;)kv(s),s=s.sibling}function kv(s){switch(s.tag){case 26:So(s),s.flags&nc&&s.memoizedState!==null&&NC(aa,s.memoizedState,s.memoizedProps);break;case 5:So(s);break;case 3:case 4:var o=aa;aa=_f(s.stateNode.containerInfo),So(s),aa=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=nc,nc=16777216,So(s),nc=o):So(s));break;default:So(s)}}function Nv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function rc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pn=p,Dv(p,s)}Nv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Rv(s),s=s.sibling}function Rv(s){switch(s.tag){case 0:case 11:case 15:rc(s),s.flags&2048&&ks(9,s,s.return);break;case 3:rc(s);break;case 12:rc(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,lf(s)):rc(s);break;default:rc(s)}}function lf(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pn=p,Dv(p,s)}Nv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:ks(8,o,o.return),lf(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,lf(o));break;default:lf(o)}s=s.sibling}}function Dv(s,o){for(;Pn!==null;){var u=Pn;switch(u.tag){case 0:case 11:case 15:ks(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Bl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Pn=p;else e:for(u=s;Pn!==null;){p=Pn;var y=p.sibling,w=p.return;if(Tv(p),p===u){Pn=null;break e}if(y!==null){y.return=w,Pn=y;break e}Pn=w}}}var zb={getCacheForType:function(s){var o=Kn(Nn),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},qb=typeof WeakMap=="function"?WeakMap:Map,Bt=0,Wt=null,vt=null,At=0,jt=0,Rr=null,Ds=!1,bo=!1,lh=!1,es=0,pn=0,Ms=0,Ti=0,ch=0,qr=0,Co=0,ac=null,wr=null,uh=!1,fh=0,cf=1/0,uf=null,Is=null,zn=0,Fs=null,Ao=null,ko=0,dh=0,hh=null,Mv=null,sc=0,mh=null;function Dr(){if((Bt&2)!==0&&At!==0)return At&-At;if(se.T!==null){var s=po;return s!==0?s:wh()}return xs()}function Iv(){qr===0&&(qr=(At&536870912)===0||Pt?Ur():536870912);var s=zr.current;return s!==null&&(s.flags|=32),qr}function Mr(s,o,u){(s===Wt&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(No(s,0),Ls(s,At,qr,!1)),ta(s,u),((Bt&2)===0||s!==Wt)&&(s===Wt&&((Bt&2)===0&&(Ti|=u),pn===4&&Ls(s,At,qr,!1)),Ta(s))}function Fv(s,o,u){if((Bt&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&s.expiredLanes)===0||nt(s,o),y=p?Jb(s,o):xh(s,o,!0),w=p;do{if(y===0){bo&&!p&&Ls(s,o,0,!1);break}else{if(u=s.current.alternate,w&&!Yb(u)){y=xh(s,o,!1),w=!1;continue}if(y===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var L=s;y=ac;var ne=L.current.memoizedState.isDehydrated;if(ne&&(No(L,N).flags|=256),N=xh(L,N,!1),N!==2){if(lh&&!ne){L.errorRecoveryDisabledLanes|=w,Ti|=w,y=4;break e}w=wr,wr=y,w!==null&&(wr===null?wr=w:wr.push.apply(wr,w))}y=N}if(w=!1,y!==2)continue}}if(y===1){No(s,0),Ls(s,o,0,!0);break}e:{switch(p=s,w=y,w){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Ls(p,o,qr,!Ds);break e;case 2:wr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(y=fh+300-Fe(),10<y)){if(Ls(p,o,qr,!Ds),We(p,0,!0)!==0)break e;p.timeoutHandle=c1(Lv.bind(null,p,u,wr,uf,uh,o,qr,Ti,Co,Ds,w,2,-0,0),y);break e}Lv(p,u,wr,uf,uh,o,qr,Ti,Co,Ds,w,0,-0,0)}}break}while(!0);Ta(s)}function Lv(s,o,u,p,y,w,N,L,ne,he,be,Ne,ge,xe){if(s.timeoutHandle=-1,Ne=o.subtreeFlags,(Ne&8192||(Ne&16785408)===16785408)&&(dc={stylesheets:null,count:0,unsuspend:kC},kv(o),Ne=RC(),Ne!==null)){s.cancelPendingCommit=Ne($v.bind(null,s,o,w,u,p,y,N,L,ne,be,1,ge,xe)),Ls(s,w,N,!he);return}$v(s,o,w,u,p,y,N,L,ne)}function Yb(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var y=u[p],w=y.getSnapshot;y=y.value;try{if(!Cr(w(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ls(s,o,u,p){o&=~ch,o&=~Ti,s.suspendedLanes|=o,s.pingedLanes&=~o,p&&(s.warmLanes|=o),p=s.expirationTimes;for(var y=o;0<y;){var w=31-it(y),N=1<<w;p[w]=-1,y&=~N}u!==0&&ps(s,u,o)}function ff(){return(Bt&6)===0?(ic(0),!1):!0}function ph(){if(vt!==null){if(jt===0)var s=vt.return;else s=vt,qa=gi=null,M0(s),wo=null,Kl=0,s=vt;for(;s!==null;)mv(s.alternate,s),s=s.return;vt=null}}function No(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,fC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),ph(),Wt=s,vt=u=Ha(s.current,null),At=o,jt=0,Rr=null,Ds=!1,bo=nt(s,o),lh=!1,Co=qr=ch=Ti=Ms=pn=0,wr=ac=null,uh=!1,(o&8)!==0&&(o|=o&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=o;0<p;){var y=31-it(p),w=1<<y;o|=s[y],p&=~w}return es=o,Mu(),u}function Ov(s,o){mt=null,se.H=Xu,o===Vl||o===Vu?(o=Qg(),jt=3):o===Kg?(o=Qg(),jt=4):jt=o===ev?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Rr=o,vt===null&&(pn=1,nf(s,Vr(o,s.current)))}function Pv(){var s=se.H;return se.H=Xu,s===null?Xu:s}function Uv(){var s=se.A;return se.A=zb,s}function gh(){pn=4,Ds||(At&4194048)!==At&&zr.current!==null||(bo=!0),(Ms&134217727)===0&&(Ti&134217727)===0||Wt===null||Ls(Wt,At,qr,!1)}function xh(s,o,u){var p=Bt;Bt|=2;var y=Pv(),w=Uv();(Wt!==s||At!==o)&&(uf=null,No(s,o)),o=!1;var N=pn;e:do try{if(jt!==0&&vt!==null){var L=vt,ne=Rr;switch(jt){case 8:ph(),N=6;break e;case 3:case 2:case 9:case 6:zr.current===null&&(o=!0);var he=jt;if(jt=0,Rr=null,Ro(s,L,ne,he),u&&bo){N=0;break e}break;default:he=jt,jt=0,Rr=null,Ro(s,L,ne,he)}}Wb(),N=pn;break}catch(be){Ov(s,be)}while(!0);return o&&s.shellSuspendCounter++,qa=gi=null,Bt=p,se.H=y,se.A=w,vt===null&&(Wt=null,At=0,Mu()),N}function Wb(){for(;vt!==null;)Bv(vt)}function Jb(s,o){var u=Bt;Bt|=2;var p=Pv(),y=Uv();Wt!==s||At!==o?(uf=null,cf=Fe()+500,No(s,o)):bo=nt(s,o);e:do try{if(jt!==0&&vt!==null){o=vt;var w=Rr;t:switch(jt){case 1:jt=0,Rr=null,Ro(s,o,w,1);break;case 2:case 9:if(Xg(w)){jt=0,Rr=null,jv(o);break}o=function(){jt!==2&&jt!==9||Wt!==s||(jt=7),Ta(s)},w.then(o,o);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:Xg(w)?(jt=0,Rr=null,jv(o)):(jt=0,Rr=null,Ro(s,o,w,7));break;case 5:var N=null;switch(vt.tag){case 26:N=vt.memoizedState;case 5:case 27:var L=vt;if(!N||w1(N)){jt=0,Rr=null;var ne=L.sibling;if(ne!==null)vt=ne;else{var he=L.return;he!==null?(vt=he,df(he)):vt=null}break t}}jt=0,Rr=null,Ro(s,o,w,5);break;case 6:jt=0,Rr=null,Ro(s,o,w,6);break;case 8:ph(),pn=6;break e;default:throw Error(r(462))}}Kb();break}catch(be){Ov(s,be)}while(!0);return qa=gi=null,se.H=p,se.A=y,Bt=u,vt!==null?0:(Wt=null,At=0,Mu(),pn)}function Kb(){for(;vt!==null&&!wt();)Bv(vt)}function Bv(s){var o=dv(s.alternate,s,es);s.memoizedProps=s.pendingProps,o===null?df(s):vt=o}function jv(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=iv(u,o,o.pendingProps,o.type,void 0,At);break;case 11:o=iv(u,o,o.pendingProps,o.type.render,o.ref,At);break;case 5:M0(o);default:mv(u,o),o=vt=Vg(o,es),o=dv(u,o,es)}s.memoizedProps=s.pendingProps,o===null?df(s):vt=o}function Ro(s,o,u,p){qa=gi=null,M0(o),wo=null,Kl=0;var y=o.return;try{if(Bb(s,y,o,u,At)){pn=1,nf(s,Vr(u,s.current)),vt=null;return}}catch(w){if(y!==null)throw vt=y,w;pn=1,nf(s,Vr(u,s.current)),vt=null;return}o.flags&32768?(Pt||p===1?s=!0:bo||(At&536870912)!==0?s=!1:(Ds=s=!0,(p===2||p===9||p===3||p===6)&&(p=zr.current,p!==null&&p.tag===13&&(p.flags|=16384))),Vv(o,s)):df(o)}function df(s){var o=s;do{if((o.flags&32768)!==0){Vv(o,Ds);return}s=o.return;var u=Vb(o.alternate,o,es);if(u!==null){vt=u;return}if(o=o.sibling,o!==null){vt=o;return}vt=o=s}while(o!==null);pn===0&&(pn=5)}function Vv(s,o){do{var u=$b(s.alternate,s);if(u!==null){u.flags&=32767,vt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){vt=s;return}vt=s=u}while(s!==null);pn=6,vt=null}function $v(s,o,u,p,y,w,N,L,ne){s.cancelPendingCommit=null;do hf();while(zn!==0);if((Bt&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(w=o.lanes|o.childLanes,w|=o0,xa(s,u,w,N,L,ne),s===Wt&&(vt=Wt=null,At=0),Ao=o,Fs=s,ko=u,dh=w,hh=y,Mv=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,eC(an,function(){return Yv(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=se.T,se.T=null,y=me.p,me.p=2,N=Bt,Bt|=4;try{Hb(s,o,u)}finally{Bt=N,me.p=y,se.T=p}}zn=1,Hv(),Gv(),zv()}}function Hv(){if(zn===1){zn=0;var s=Fs,o=Ao,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=se.T,se.T=null;var p=me.p;me.p=2;var y=Bt;Bt|=4;try{bv(o,s);var w=Nh,N=Dg(s.containerInfo),L=w.focusedElem,ne=w.selectionRange;if(N!==L&&L&&L.ownerDocument&&Rg(L.ownerDocument.documentElement,L)){if(ne!==null&&n0(L)){var he=ne.start,be=ne.end;if(be===void 0&&(be=he),"selectionStart"in L)L.selectionStart=he,L.selectionEnd=Math.min(be,L.value.length);else{var Ne=L.ownerDocument||document,ge=Ne&&Ne.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),Qe=L.textContent.length,Je=Math.min(ne.start,Qe),zt=ne.end===void 0?Je:Math.min(ne.end,Qe);!xe.extend&&Je>zt&&(N=zt,zt=Je,Je=N);var ce=Ng(L,Je),ie=Ng(L,zt);if(ce&&ie&&(xe.rangeCount!==1||xe.anchorNode!==ce.node||xe.anchorOffset!==ce.offset||xe.focusNode!==ie.node||xe.focusOffset!==ie.offset)){var fe=Ne.createRange();fe.setStart(ce.node,ce.offset),xe.removeAllRanges(),Je>zt?(xe.addRange(fe),xe.extend(ie.node,ie.offset)):(fe.setEnd(ie.node,ie.offset),xe.addRange(fe))}}}}for(Ne=[],xe=L;xe=xe.parentNode;)xe.nodeType===1&&Ne.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<Ne.length;L++){var Ae=Ne[L];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}bf=!!kh,Nh=kh=null}finally{Bt=y,me.p=p,se.T=u}}s.current=o,zn=2}}function Gv(){if(zn===2){zn=0;var s=Fs,o=Ao,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=se.T,se.T=null;var p=me.p;me.p=2;var y=Bt;Bt|=4;try{wv(s,o.alternate,o)}finally{Bt=y,me.p=p,se.T=u}}zn=3}}function zv(){if(zn===4||zn===3){zn=0,rt();var s=Fs,o=Ao,u=ko,p=Mv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?zn=5:(zn=0,Ao=Fs=null,qv(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Is=null),Va(u),o=o.stateNode,Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(vn,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=se.T,y=me.p,me.p=2,se.T=null;try{for(var w=s.onRecoverableError,N=0;N<p.length;N++){var L=p[N];w(L.value,{componentStack:L.stack})}}finally{se.T=o,me.p=y}}(ko&3)!==0&&hf(),Ta(s),y=s.pendingLanes,(u&4194090)!==0&&(y&42)!==0?s===mh?sc++:(sc=0,mh=s):sc=0,ic(0)}}function qv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Bl(o)))}function hf(s){return Hv(),Gv(),zv(),Yv()}function Yv(){if(zn!==5)return!1;var s=Fs,o=dh;dh=0;var u=Va(ko),p=se.T,y=me.p;try{me.p=32>u?32:u,se.T=null,u=hh,hh=null;var w=Fs,N=ko;if(zn=0,Ao=Fs=null,ko=0,(Bt&6)!==0)throw Error(r(331));var L=Bt;if(Bt|=4,Rv(w.current),Av(w,w.current,N,u),Bt=L,ic(0,!1),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(vn,w)}catch{}return!0}finally{me.p=y,se.T=p,qv(s,o)}}function Wv(s,o,u){o=Vr(u,o),o=q0(s.stateNode,o,2),s=Ss(s,o,2),s!==null&&(ta(s,2),Ta(s))}function qt(s,o,u){if(s.tag===3)Wv(s,s,u);else for(;o!==null;){if(o.tag===3){Wv(o,s,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Is===null||!Is.has(p))){s=Vr(u,s),u=Zx(2),p=Ss(o,u,2),p!==null&&(Qx(u,p,o,s),ta(p,2),Ta(p));break}}o=o.return}}function vh(s,o,u){var p=s.pingCache;if(p===null){p=s.pingCache=new qb;var y=new Set;p.set(o,y)}else y=p.get(o),y===void 0&&(y=new Set,p.set(o,y));y.has(u)||(lh=!0,y.add(u),s=Xb.bind(null,s,o,u),o.then(s,s))}function Xb(s,o,u){var p=s.pingCache;p!==null&&p.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Wt===s&&(At&u)===u&&(pn===4||pn===3&&(At&62914560)===At&&300>Fe()-fh?(Bt&2)===0&&No(s,0):ch|=u,Co===At&&(Co=0)),Ta(s)}function Jv(s,o){o===0&&(o=Ua()),s=uo(s,o),s!==null&&(ta(s,o),Ta(s))}function Zb(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),Jv(s,u)}function Qb(s,o){var u=0;switch(s.tag){case 13:var p=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),Jv(s,u)}function eC(s,o){return ft(s,o)}var mf=null,Do=null,yh=!1,pf=!1,_h=!1,Ei=0;function Ta(s){s!==Do&&s.next===null&&(Do===null?mf=Do=s:Do=Do.next=s),pf=!0,yh||(yh=!0,nC())}function ic(s,o){if(!_h&&pf){_h=!0;do for(var u=!1,p=mf;p!==null;){if(s!==0){var y=p.pendingLanes;if(y===0)var w=0;else{var N=p.suspendedLanes,L=p.pingedLanes;w=(1<<31-it(42|s)+1)-1,w&=y&~(N&~L),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,Qv(p,w))}else w=At,w=We(p,p===Wt?w:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(w&3)===0||nt(p,w)||(u=!0,Qv(p,w));p=p.next}while(u);_h=!1}}function tC(){Kv()}function Kv(){pf=yh=!1;var s=0;Ei!==0&&(uC()&&(s=Ei),Ei=0);for(var o=Fe(),u=null,p=mf;p!==null;){var y=p.next,w=Xv(p,o);w===0?(p.next=null,u===null?mf=y:u.next=y,y===null&&(Do=u)):(u=p,(s!==0||(w&3)!==0)&&(pf=!0)),p=y}ic(s)}function Xv(s,o){for(var u=s.suspendedLanes,p=s.pingedLanes,y=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-it(w),L=1<<N,ne=y[N];ne===-1?((L&u)===0||(L&p)!==0)&&(y[N]=lr(L,o)):ne<=o&&(s.expiredLanes|=L),w&=~L}if(o=Wt,u=At,u=We(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===o&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&Xe(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||nt(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(p!==null&&Xe(p),Va(u)){case 2:case 8:u=rn;break;case 32:u=an;break;case 268435456:u=Tt;break;default:u=an}return p=Zv.bind(null,s),u=ft(u,p),s.callbackPriority=o,s.callbackNode=u,o}return p!==null&&p!==null&&Xe(p),s.callbackPriority=2,s.callbackNode=null,2}function Zv(s,o){if(zn!==0&&zn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(hf()&&s.callbackNode!==u)return null;var p=At;return p=We(s,s===Wt?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(Fv(s,p,o),Xv(s,Fe()),s.callbackNode!=null&&s.callbackNode===u?Zv.bind(null,s):null)}function Qv(s,o){if(hf())return null;Fv(s,o,!0)}function nC(){dC(function(){(Bt&6)!==0?ft(cn,tC):Kv()})}function wh(){return Ei===0&&(Ei=Ur()),Ei}function e1(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:bu(""+s)}function t1(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function rC(s,o,u,p,y){if(o==="submit"&&u&&u.stateNode===y){var w=e1((y[fn]||null).action),N=p.submitter;N&&(o=(o=N[fn]||null)?e1(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var L=new Nu("action","action",null,p,y);s.push({event:L,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Ei!==0){var ne=N?t1(y,N):new FormData(y);V0(u,{pending:!0,data:ne,method:y.method,action:w},null,ne)}}else typeof w=="function"&&(L.preventDefault(),ne=N?t1(y,N):new FormData(y),V0(u,{pending:!0,data:ne,method:y.method,action:w},w,ne))},currentTarget:y}]})}}for(var Th=0;Th<i0.length;Th++){var Eh=i0[Th],aC=Eh.toLowerCase(),sC=Eh[0].toUpperCase()+Eh.slice(1);ra(aC,"on"+sC)}ra(Fg,"onAnimationEnd"),ra(Lg,"onAnimationIteration"),ra(Og,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(Tb,"onTransitionRun"),ra(Eb,"onTransitionStart"),ra(Sb,"onTransitionCancel"),ra(Pg,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),De("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),De("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),De("onBeforeInput",["compositionend","keypress","textInput","paste"]),De("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oc));function n1(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],y=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var N=p.length-1;0<=N;N--){var L=p[N],ne=L.instance,he=L.currentTarget;if(L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=he;try{w(y)}catch(be){tf(be)}y.currentTarget=null,w=ne}else for(N=0;N<p.length;N++){if(L=p[N],ne=L.instance,he=L.currentTarget,L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=he;try{w(y)}catch(be){tf(be)}y.currentTarget=null,w=ne}}}}function yt(s,o){var u=o[gt];u===void 0&&(u=o[gt]=new Set);var p=s+"__bubble";u.has(p)||(r1(o,s,2,!1),u.add(p))}function Sh(s,o,u){var p=0;o&&(p|=4),r1(u,s,p,o)}var gf="_reactListening"+Math.random().toString(36).slice(2);function bh(s){if(!s[gf]){s[gf]=!0,de.forEach(function(u){u!=="selectionchange"&&(iC.has(u)||Sh(u,!1,s),Sh(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[gf]||(o[gf]=!0,Sh("selectionchange",!1,o))}}function r1(s,o,u,p){switch(A1(o)){case 2:var y=IC;break;case 8:y=FC;break;default:y=Bh}u=y.bind(null,o,u,s),y=void 0,!Yd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),p?y!==void 0?s.addEventListener(o,u,{capture:!0,passive:y}):s.addEventListener(o,u,!0):y!==void 0?s.addEventListener(o,u,{passive:y}):s.addEventListener(o,u,!1)}function Ch(s,o,u,p,y){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var N=p.tag;if(N===3||N===4){var L=p.stateNode.containerInfo;if(L===y)break;if(N===4)for(N=p.return;N!==null;){var ne=N.tag;if((ne===3||ne===4)&&N.stateNode.containerInfo===y)return;N=N.return}for(;L!==null;){if(N=z(L),N===null)return;if(ne=N.tag,ne===5||ne===6||ne===26||ne===27){p=w=N;continue e}L=L.parentNode}}p=p.return}ug(function(){var he=w,be=zd(u),Ne=[];e:{var ge=Ug.get(s);if(ge!==void 0){var xe=Nu,Qe=s;switch(s){case"keypress":if(Au(u)===0)break e;case"keydown":case"keyup":xe=eb;break;case"focusin":Qe="focus",xe=Xd;break;case"focusout":Qe="blur",xe=Xd;break;case"beforeblur":case"afterblur":xe=Xd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=hg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=$S;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=rb;break;case Fg:case Lg:case Og:xe=zS;break;case Pg:xe=sb;break;case"scroll":case"scrollend":xe=jS;break;case"wheel":xe=ob;break;case"copy":case"cut":case"paste":xe=YS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=pg;break;case"toggle":case"beforetoggle":xe=cb}var Je=(o&4)!==0,zt=!Je&&(s==="scroll"||s==="scrollend"),ce=Je?ge!==null?ge+"Capture":null:ge;Je=[];for(var ie=he,fe;ie!==null;){var Ae=ie;if(fe=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||fe===null||ce===null||(Ae=Cl(ie,ce),Ae!=null&&Je.push(lc(ie,Ae,fe))),zt)break;ie=ie.return}0<Je.length&&(ge=new xe(ge,Qe,null,u,be),Ne.push({event:ge,listeners:Je}))}}if((o&7)===0){e:{if(ge=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ge&&u!==Gd&&(Qe=u.relatedTarget||u.fromElement)&&(z(Qe)||Qe[Br]))break e;if((xe||ge)&&(ge=be.window===be?be:(ge=be.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(Qe=u.relatedTarget||u.toElement,xe=he,Qe=Qe?z(Qe):null,Qe!==null&&(zt=i(Qe),Je=Qe.tag,Qe!==zt||Je!==5&&Je!==27&&Je!==6)&&(Qe=null)):(xe=null,Qe=he),xe!==Qe)){if(Je=hg,Ae="onMouseLeave",ce="onMouseEnter",ie="mouse",(s==="pointerout"||s==="pointerover")&&(Je=pg,Ae="onPointerLeave",ce="onPointerEnter",ie="pointer"),zt=xe==null?ge:ue(xe),fe=Qe==null?ge:ue(Qe),ge=new Je(Ae,ie+"leave",xe,u,be),ge.target=zt,ge.relatedTarget=fe,Ae=null,z(be)===he&&(Je=new Je(ce,ie+"enter",Qe,u,be),Je.target=fe,Je.relatedTarget=zt,Ae=Je),zt=Ae,xe&&Qe)t:{for(Je=xe,ce=Qe,ie=0,fe=Je;fe;fe=Mo(fe))ie++;for(fe=0,Ae=ce;Ae;Ae=Mo(Ae))fe++;for(;0<ie-fe;)Je=Mo(Je),ie--;for(;0<fe-ie;)ce=Mo(ce),fe--;for(;ie--;){if(Je===ce||ce!==null&&Je===ce.alternate)break t;Je=Mo(Je),ce=Mo(ce)}Je=null}else Je=null;xe!==null&&a1(Ne,ge,xe,Je,!1),Qe!==null&&zt!==null&&a1(Ne,zt,Qe,Je,!0)}}e:{if(ge=he?ue(he):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var Ve=Eg;else if(wg(ge))if(Sg)Ve=yb;else{Ve=xb;var pt=gb}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?he&&Hd(he.elementType)&&(Ve=Eg):Ve=vb;if(Ve&&(Ve=Ve(s,he))){Tg(Ne,Ve,u,be);break e}pt&&pt(s,ge,he),s==="focusout"&&he&&ge.type==="number"&&he.memoizedProps.value!=null&&na(ge,"number",ge.value)}switch(pt=he?ue(he):window,s){case"focusin":(wg(pt)||pt.contentEditable==="true")&&(oo=pt,r0=he,Fl=null);break;case"focusout":Fl=r0=oo=null;break;case"mousedown":a0=!0;break;case"contextmenu":case"mouseup":case"dragend":a0=!1,Mg(Ne,u,be);break;case"selectionchange":if(wb)break;case"keydown":case"keyup":Mg(Ne,u,be)}var qe;if(Qd)e:{switch(s){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else io?yg(s,u)&&(Ze="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ze="onCompositionStart");Ze&&(gg&&u.locale!=="ko"&&(io||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&io&&(qe=fg()):(_s=be,Wd="value"in _s?_s.value:_s.textContent,io=!0)),pt=xf(he,Ze),0<pt.length&&(Ze=new mg(Ze,s,null,u,be),Ne.push({event:Ze,listeners:pt}),qe?Ze.data=qe:(qe=_g(u),qe!==null&&(Ze.data=qe)))),(qe=fb?db(s,u):hb(s,u))&&(Ze=xf(he,"onBeforeInput"),0<Ze.length&&(pt=new mg("onBeforeInput","beforeinput",null,u,be),Ne.push({event:pt,listeners:Ze}),pt.data=qe)),rC(Ne,s,he,u,be)}n1(Ne,o)})}function lc(s,o,u){return{instance:s,listener:o,currentTarget:u}}function xf(s,o){for(var u=o+"Capture",p=[];s!==null;){var y=s,w=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||w===null||(y=Cl(s,u),y!=null&&p.unshift(lc(s,y,w)),y=Cl(s,o),y!=null&&p.push(lc(s,y,w))),s.tag===3)return p;s=s.return}return[]}function Mo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function a1(s,o,u,p,y){for(var w=o._reactName,N=[];u!==null&&u!==p;){var L=u,ne=L.alternate,he=L.stateNode;if(L=L.tag,ne!==null&&ne===p)break;L!==5&&L!==26&&L!==27||he===null||(ne=he,y?(he=Cl(u,w),he!=null&&N.unshift(lc(u,he,ne))):y||(he=Cl(u,w),he!=null&&N.push(lc(u,he,ne)))),u=u.return}N.length!==0&&s.push({event:o,listeners:N})}var oC=/\r\n?/g,lC=/\u0000|\uFFFD/g;function s1(s){return(typeof s=="string"?s:""+s).replace(oC,`
`).replace(lC,"")}function i1(s,o){return o=s1(o),s1(s)===o}function vf(){}function Gt(s,o,u,p,y,w){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||ro(s,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&ro(s,""+p);break;case"className":Pe(s,"class",p);break;case"tabIndex":Pe(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Pe(s,u,p);break;case"style":lg(s,p,w);break;case"data":if(o!=="object"){Pe(s,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=bu(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&Gt(s,o,"name",y.name,y,null),Gt(s,o,"formEncType",y.formEncType,y,null),Gt(s,o,"formMethod",y.formMethod,y,null),Gt(s,o,"formTarget",y.formTarget,y,null)):(Gt(s,o,"encType",y.encType,y,null),Gt(s,o,"method",y.method,y,null),Gt(s,o,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=bu(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=vf);break;case"onScroll":p!=null&&yt("scroll",s);break;case"onScrollEnd":p!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=bu(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":yt("beforetoggle",s),yt("toggle",s),ke(s,"popover",p);break;case"xlinkActuate":je(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":je(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":je(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":je(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":je(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":je(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":je(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":je(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":je(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ke(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=US.get(u)||u,ke(s,u,p))}}function Ah(s,o,u,p,y,w){switch(u){case"style":lg(s,p,w);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?ro(s,p):(typeof p=="number"||typeof p=="bigint")&&ro(s,""+p);break;case"onScroll":p!=null&&yt("scroll",s);break;case"onScrollEnd":p!=null&&yt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=vf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pe.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),w=s[fn]||null,w=w!=null?w[u]:null,typeof w=="function"&&s.removeEventListener(o,w,y),typeof p=="function")){typeof w!="function"&&w!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,p,y);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):ke(s,u,p)}}}function qn(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var p=!1,y=!1,w;for(w in u)if(u.hasOwnProperty(w)){var N=u[w];if(N!=null)switch(w){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Gt(s,o,w,N,u,null)}}y&&Gt(s,o,"srcSet",u.srcSet,u,null),p&&Gt(s,o,"src",u.src,u,null);return;case"input":yt("invalid",s);var L=w=N=y=null,ne=null,he=null;for(p in u)if(u.hasOwnProperty(p)){var be=u[p];if(be!=null)switch(p){case"name":y=be;break;case"type":N=be;break;case"checked":ne=be;break;case"defaultChecked":he=be;break;case"value":w=be;break;case"defaultValue":L=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,o));break;default:Gt(s,o,p,be,u,null)}}oi(s,w,L,ne,he,N,y,!1),ys(s);return;case"select":yt("invalid",s),p=N=w=null;for(y in u)if(u.hasOwnProperty(y)&&(L=u[y],L!=null))switch(y){case"value":w=L;break;case"defaultValue":N=L;break;case"multiple":p=L;default:Gt(s,o,y,L,u,null)}o=w,u=N,s.multiple=!!p,o!=null?br(s,!!p,o,!1):u!=null&&br(s,!!p,u,!0);return;case"textarea":yt("invalid",s),w=y=p=null;for(N in u)if(u.hasOwnProperty(N)&&(L=u[N],L!=null))switch(N){case"value":p=L;break;case"defaultValue":y=L;break;case"children":w=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:Gt(s,o,N,L,u,null)}ig(s,p,y,w),ys(s);return;case"option":for(ne in u)if(u.hasOwnProperty(ne)&&(p=u[ne],p!=null))switch(ne){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Gt(s,o,ne,p,u,null)}return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(p=0;p<oc.length;p++)yt(oc[p],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in u)if(u.hasOwnProperty(he)&&(p=u[he],p!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Gt(s,o,he,p,u,null)}return;default:if(Hd(o)){for(be in u)u.hasOwnProperty(be)&&(p=u[be],p!==void 0&&Ah(s,o,be,p,u,void 0));return}}for(L in u)u.hasOwnProperty(L)&&(p=u[L],p!=null&&Gt(s,o,L,p,u,null))}function cC(s,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,w=null,N=null,L=null,ne=null,he=null,be=null;for(xe in u){var Ne=u[xe];if(u.hasOwnProperty(xe)&&Ne!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":ne=Ne;default:p.hasOwnProperty(xe)||Gt(s,o,xe,null,p,Ne)}}for(var ge in p){var xe=p[ge];if(Ne=u[ge],p.hasOwnProperty(ge)&&(xe!=null||Ne!=null))switch(ge){case"type":w=xe;break;case"name":y=xe;break;case"checked":he=xe;break;case"defaultChecked":be=xe;break;case"value":N=xe;break;case"defaultValue":L=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,o));break;default:xe!==Ne&&Gt(s,o,ge,xe,p,Ne)}}kn(s,N,L,ne,he,be,w,y);return;case"select":xe=N=L=ge=null;for(w in u)if(ne=u[w],u.hasOwnProperty(w)&&ne!=null)switch(w){case"value":break;case"multiple":xe=ne;default:p.hasOwnProperty(w)||Gt(s,o,w,null,p,ne)}for(y in p)if(w=p[y],ne=u[y],p.hasOwnProperty(y)&&(w!=null||ne!=null))switch(y){case"value":ge=w;break;case"defaultValue":L=w;break;case"multiple":N=w;default:w!==ne&&Gt(s,o,y,w,p,ne)}o=L,u=N,p=xe,ge!=null?br(s,!!u,ge,!1):!!p!=!!u&&(o!=null?br(s,!!u,o,!0):br(s,!!u,u?[]:"",!1));return;case"textarea":xe=ge=null;for(L in u)if(y=u[L],u.hasOwnProperty(L)&&y!=null&&!p.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Gt(s,o,L,null,p,y)}for(N in p)if(y=p[N],w=u[N],p.hasOwnProperty(N)&&(y!=null||w!=null))switch(N){case"value":ge=y;break;case"defaultValue":xe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==w&&Gt(s,o,N,y,p,w)}Su(s,ge,xe);return;case"option":for(var Qe in u)if(ge=u[Qe],u.hasOwnProperty(Qe)&&ge!=null&&!p.hasOwnProperty(Qe))switch(Qe){case"selected":s.selected=!1;break;default:Gt(s,o,Qe,null,p,ge)}for(ne in p)if(ge=p[ne],xe=u[ne],p.hasOwnProperty(ne)&&ge!==xe&&(ge!=null||xe!=null))switch(ne){case"selected":s.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Gt(s,o,ne,ge,p,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in u)ge=u[Je],u.hasOwnProperty(Je)&&ge!=null&&!p.hasOwnProperty(Je)&&Gt(s,o,Je,null,p,ge);for(he in p)if(ge=p[he],xe=u[he],p.hasOwnProperty(he)&&ge!==xe&&(ge!=null||xe!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:Gt(s,o,he,ge,p,xe)}return;default:if(Hd(o)){for(var zt in u)ge=u[zt],u.hasOwnProperty(zt)&&ge!==void 0&&!p.hasOwnProperty(zt)&&Ah(s,o,zt,void 0,p,ge);for(be in p)ge=p[be],xe=u[be],!p.hasOwnProperty(be)||ge===xe||ge===void 0&&xe===void 0||Ah(s,o,be,ge,p,xe);return}}for(var ce in u)ge=u[ce],u.hasOwnProperty(ce)&&ge!=null&&!p.hasOwnProperty(ce)&&Gt(s,o,ce,null,p,ge);for(Ne in p)ge=p[Ne],xe=u[Ne],!p.hasOwnProperty(Ne)||ge===xe||ge==null&&xe==null||Gt(s,o,Ne,ge,p,xe)}var kh=null,Nh=null;function yf(s){return s.nodeType===9?s:s.ownerDocument}function o1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function l1(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Rh(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Dh=null;function uC(){var s=window.event;return s&&s.type==="popstate"?s===Dh?!1:(Dh=s,!0):(Dh=null,!1)}var c1=typeof setTimeout=="function"?setTimeout:void 0,fC=typeof clearTimeout=="function"?clearTimeout:void 0,u1=typeof Promise=="function"?Promise:void 0,dC=typeof queueMicrotask=="function"?queueMicrotask:typeof u1<"u"?function(s){return u1.resolve(null).then(s).catch(hC)}:c1;function hC(s){setTimeout(function(){throw s})}function Os(s){return s==="head"}function f1(s,o){var u=o,p=0,y=0;do{var w=u.nextSibling;if(s.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"){if(0<p&&8>p){u=p;var N=s.ownerDocument;if(u&1&&cc(N.documentElement),u&2&&cc(N.body),u&4)for(u=N.head,cc(u),N=u.firstChild;N;){var L=N.nextSibling,ne=N.nodeName;N[O]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&N.rel.toLowerCase()==="stylesheet"||u.removeChild(N),N=L}}if(y===0){s.removeChild(w),xc(o);return}y--}else u==="$"||u==="$?"||u==="$!"?y++:p=u.charCodeAt(0)-48;else p=0;u=w}while(u);xc(o)}function Mh(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Mh(u),V(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function mC(s,o,u,p){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[O])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=sa(s.nextSibling),s===null)break}return null}function pC(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=sa(s.nextSibling),s===null))return null;return s}function Ih(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function gC(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function sa(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Fh=null;function d1(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function h1(s,o,u){switch(o=yf(u),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function cc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);V(s)}var Yr=new Map,m1=new Set;function _f(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ts=me.d;me.d={f:xC,r:vC,D:yC,C:_C,L:wC,m:TC,X:SC,S:EC,M:bC};function xC(){var s=ts.f(),o=ff();return s||o}function vC(s){var o=Y(s);o!==null&&o.tag===5&&o.type==="form"?Fx(o):ts.r(s)}var Io=typeof document>"u"?null:document;function p1(s,o,u){var p=Io;if(p&&typeof o=="string"&&o){var y=xt(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),m1.has(y)||(m1.add(y),s={rel:s,crossOrigin:u,href:o},p.querySelector(y)===null&&(o=p.createElement("link"),qn(o,"link",s),le(o),p.head.appendChild(o)))}}function yC(s){ts.D(s),p1("dns-prefetch",s,null)}function _C(s,o){ts.C(s,o),p1("preconnect",s,o)}function wC(s,o,u){ts.L(s,o,u);var p=Io;if(p&&s&&o){var y='link[rel="preload"][as="'+xt(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+xt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+xt(u.imageSizes)+'"]')):y+='[href="'+xt(s)+'"]';var w=y;switch(o){case"style":w=Fo(s);break;case"script":w=Lo(s)}Yr.has(w)||(s=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Yr.set(w,s),p.querySelector(y)!==null||o==="style"&&p.querySelector(uc(w))||o==="script"&&p.querySelector(fc(w))||(o=p.createElement("link"),qn(o,"link",s),le(o),p.head.appendChild(o)))}}function TC(s,o){ts.m(s,o);var u=Io;if(u&&s){var p=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+xt(p)+'"][href="'+xt(s)+'"]',w=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Lo(s)}if(!Yr.has(w)&&(s=g({rel:"modulepreload",href:s},o),Yr.set(w,s),u.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(fc(w)))return}p=u.createElement("link"),qn(p,"link",s),le(p),u.head.appendChild(p)}}}function EC(s,o,u){ts.S(s,o,u);var p=Io;if(p&&s){var y=ve(p).hoistableStyles,w=Fo(s);o=o||"default";var N=y.get(w);if(!N){var L={loading:0,preload:null};if(N=p.querySelector(uc(w)))L.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Yr.get(w))&&Lh(s,u);var ne=N=p.createElement("link");le(ne),qn(ne,"link",s),ne._p=new Promise(function(he,be){ne.onload=he,ne.onerror=be}),ne.addEventListener("load",function(){L.loading|=1}),ne.addEventListener("error",function(){L.loading|=2}),L.loading|=4,wf(N,o,p)}N={type:"stylesheet",instance:N,count:1,state:L},y.set(w,N)}}}function SC(s,o){ts.X(s,o);var u=Io;if(u&&s){var p=ve(u).hoistableScripts,y=Lo(s),w=p.get(y);w||(w=u.querySelector(fc(y)),w||(s=g({src:s,async:!0},o),(o=Yr.get(y))&&Oh(s,o),w=u.createElement("script"),le(w),qn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function bC(s,o){ts.M(s,o);var u=Io;if(u&&s){var p=ve(u).hoistableScripts,y=Lo(s),w=p.get(y);w||(w=u.querySelector(fc(y)),w||(s=g({src:s,async:!0,type:"module"},o),(o=Yr.get(y))&&Oh(s,o),w=u.createElement("script"),le(w),qn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function g1(s,o,u,p){var y=(y=oe.current)?_f(y):null;if(!y)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Fo(u.href),u=ve(y).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Fo(u.href);var w=ve(y).hoistableStyles,N=w.get(s);if(N||(y=y.ownerDocument||y,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=y.querySelector(uc(s)))&&!w._p&&(N.instance=w,N.state.loading=5),Yr.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Yr.set(s,u),w||CC(y,s,u,N.state))),o&&p===null)throw Error(r(528,""));return N}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Lo(u),u=ve(y).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Fo(s){return'href="'+xt(s)+'"'}function uc(s){return'link[rel="stylesheet"]['+s+"]"}function x1(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function CC(s,o,u,p){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=s.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),qn(o,"link",u),le(o),s.head.appendChild(o))}function Lo(s){return'[src="'+xt(s)+'"]'}function fc(s){return"script[async]"+s}function v1(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=s.querySelector('style[data-href~="'+xt(u.href)+'"]');if(p)return o.instance=p,le(p),p;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),le(p),qn(p,"style",y),wf(p,u.precedence,s),o.instance=p;case"stylesheet":y=Fo(u.href);var w=s.querySelector(uc(y));if(w)return o.state.loading|=4,o.instance=w,le(w),w;p=x1(u),(y=Yr.get(y))&&Lh(p,y),w=(s.ownerDocument||s).createElement("link"),le(w);var N=w;return N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),qn(w,"link",p),o.state.loading|=4,wf(w,u.precedence,s),o.instance=w;case"script":return w=Lo(u.src),(y=s.querySelector(fc(w)))?(o.instance=y,le(y),y):(p=u,(y=Yr.get(w))&&(p=g({},u),Oh(p,y)),s=s.ownerDocument||s,y=s.createElement("script"),le(y),qn(y,"link",p),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,wf(p,u.precedence,s));return o.instance}function wf(s,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,w=y,N=0;N<p.length;N++){var L=p[N];if(L.dataset.precedence===o)w=L;else if(w!==y)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function Lh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Oh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Tf=null;function y1(s,o,u){if(Tf===null){var p=new Map,y=Tf=new Map;y.set(u,p)}else y=Tf,p=y.get(u),p||(p=new Map,y.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var w=u[y];if(!(w[O]||w[un]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var L=p.get(N);L?L.push(w):p.set(N,[w])}}return p}function _1(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function AC(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function w1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var dc=null;function kC(){}function NC(s,o,u){if(dc===null)throw Error(r(475));var p=dc;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=Fo(u.href),w=s.querySelector(uc(y));if(w){s=w._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=Ef.bind(p),s.then(p,p)),o.state.loading|=4,o.instance=w,le(w);return}w=s.ownerDocument||s,u=x1(u),(y=Yr.get(y))&&Lh(u,y),w=w.createElement("link"),le(w);var N=w;N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),qn(w,"link",u),o.instance=w}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=Ef.bind(p),s.addEventListener("load",o),s.addEventListener("error",o))}}function RC(){if(dc===null)throw Error(r(475));var s=dc;return s.stylesheets&&s.count===0&&Ph(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&Ph(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Ef(){if(this.count--,this.count===0){if(this.stylesheets)Ph(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Sf=null;function Ph(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Sf=new Map,o.forEach(DC,s),Sf=null,Ef.call(s))}function DC(s,o){if(!(o.state.loading&4)){var u=Sf.get(s);if(u)var p=u.get(null);else{u=new Map,Sf.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<y.length;w++){var N=y[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),p=N)}p&&u.set(null,p)}y=o.instance,N=y.getAttribute("data-precedence"),w=u.get(N)||p,w===p&&u.set(null,y),u.set(N,y),this.count++,p=Ef.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),w?w.parentNode.insertBefore(y,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var hc={$$typeof:C,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function MC(s,o,u,p,y,w,N,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ba(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ba(0),this.hiddenUpdates=Ba(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function T1(s,o,u,p,y,w,N,L,ne,he,be,Ne){return s=new MC(s,o,u,N,L,ne,he,Ne),o=1,w===!0&&(o|=24),w=Ar(3,null,null,o),s.current=w,w.stateNode=s,o=v0(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:p,isDehydrated:u,cache:o},T0(w),s}function E1(s){return s?(s=fo,s):fo}function S1(s,o,u,p,y,w){y=E1(y),p.context===null?p.context=y:p.pendingContext=y,p=Es(o),p.payload={element:u},w=w===void 0?null:w,w!==null&&(p.callback=w),u=Ss(s,p,o),u!==null&&(Mr(u,s,o),Hl(u,s,o))}function b1(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function Uh(s,o){b1(s,o),(s=s.alternate)&&b1(s,o)}function C1(s){if(s.tag===13){var o=uo(s,67108864);o!==null&&Mr(o,s,67108864),Uh(s,67108864)}}var bf=!0;function IC(s,o,u,p){var y=se.T;se.T=null;var w=me.p;try{me.p=2,Bh(s,o,u,p)}finally{me.p=w,se.T=y}}function FC(s,o,u,p){var y=se.T;se.T=null;var w=me.p;try{me.p=8,Bh(s,o,u,p)}finally{me.p=w,se.T=y}}function Bh(s,o,u,p){if(bf){var y=jh(p);if(y===null)Ch(s,o,p,Cf,u),k1(s,p);else if(OC(y,s,o,u,p))p.stopPropagation();else if(k1(s,p),o&4&&-1<LC.indexOf(s)){for(;y!==null;){var w=Y(y);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=Ge(w.pendingLanes);if(N!==0){var L=w;for(L.pendingLanes|=2,L.entangledLanes|=2;N;){var ne=1<<31-it(N);L.entanglements[1]|=ne,N&=~ne}Ta(w),(Bt&6)===0&&(cf=Fe()+500,ic(0))}}break;case 13:L=uo(w,2),L!==null&&Mr(L,w,2),ff(),Uh(w,2)}if(w=jh(p),w===null&&Ch(s,o,p,Cf,u),w===y)break;y=w}y!==null&&p.stopPropagation()}else Ch(s,o,p,null,u)}}function jh(s){return s=zd(s),Vh(s)}var Cf=null;function Vh(s){if(Cf=null,s=z(s),s!==null){var o=i(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Cf=s,null}function A1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ut()){case cn:return 2;case rn:return 8;case an:case Ln:return 32;case Tt:return 268435456;default:return 32}default:return 32}}var $h=!1,Ps=null,Us=null,Bs=null,mc=new Map,pc=new Map,js=[],LC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function k1(s,o){switch(s){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Us=null;break;case"mouseover":case"mouseout":Bs=null;break;case"pointerover":case"pointerout":mc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":pc.delete(o.pointerId)}}function gc(s,o,u,p,y,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:w,targetContainers:[y]},o!==null&&(o=Y(o),o!==null&&C1(o)),s):(s.eventSystemFlags|=p,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function OC(s,o,u,p,y){switch(o){case"focusin":return Ps=gc(Ps,s,o,u,p,y),!0;case"dragenter":return Us=gc(Us,s,o,u,p,y),!0;case"mouseover":return Bs=gc(Bs,s,o,u,p,y),!0;case"pointerover":var w=y.pointerId;return mc.set(w,gc(mc.get(w)||null,s,o,u,p,y)),!0;case"gotpointercapture":return w=y.pointerId,pc.set(w,gc(pc.get(w)||null,s,o,u,p,y)),!0}return!1}function N1(s){var o=z(s.target);if(o!==null){var u=i(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,si(s.priority,function(){if(u.tag===13){var p=Dr();p=ja(p);var y=uo(u,p);y!==null&&Mr(y,u,p),Uh(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Af(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=jh(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);Gd=p,u.target.dispatchEvent(p),Gd=null}else return o=Y(u),o!==null&&C1(o),s.blockedOn=u,!1;o.shift()}return!0}function R1(s,o,u){Af(s)&&u.delete(o)}function PC(){$h=!1,Ps!==null&&Af(Ps)&&(Ps=null),Us!==null&&Af(Us)&&(Us=null),Bs!==null&&Af(Bs)&&(Bs=null),mc.forEach(R1),pc.forEach(R1)}function kf(s,o){s.blockedOn===o&&(s.blockedOn=null,$h||($h=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,PC)))}var Nf=null;function D1(s){Nf!==s&&(Nf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Nf===s&&(Nf=null);for(var o=0;o<s.length;o+=3){var u=s[o],p=s[o+1],y=s[o+2];if(typeof p!="function"){if(Vh(p||u)===null)continue;break}var w=Y(u);w!==null&&(s.splice(o,3),o-=3,V0(w,{pending:!0,data:y,method:u.method,action:p},p,y))}}))}function xc(s){function o(ne){return kf(ne,s)}Ps!==null&&kf(Ps,s),Us!==null&&kf(Us,s),Bs!==null&&kf(Bs,s),mc.forEach(o),pc.forEach(o);for(var u=0;u<js.length;u++){var p=js[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<js.length&&(u=js[0],u.blockedOn===null);)N1(u),u.blockedOn===null&&js.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var y=u[p],w=u[p+1],N=y[fn]||null;if(typeof w=="function")N||D1(u);else if(N){var L=null;if(w&&w.hasAttribute("formAction")){if(y=w,N=w[fn]||null)L=N.formAction;else if(Vh(y)!==null)continue}else L=N.action;typeof L=="function"?u[p+1]=L:(u.splice(p,3),p-=3),D1(u)}}}function Hh(s){this._internalRoot=s}Rf.prototype.render=Hh.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=Dr();S1(u,p,s,o,null,null)},Rf.prototype.unmount=Hh.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;S1(s.current,2,null,s,null,null),ff(),o[Br]=null}};function Rf(s){this._internalRoot=s}Rf.prototype.unstable_scheduleHydration=function(s){if(s){var o=xs();s={blockedOn:null,target:s,priority:o};for(var u=0;u<js.length&&o!==0&&o<js[u].priority;u++);js.splice(u,0,s),u===0&&N1(s)}};var M1=e.version;if(M1!=="19.1.0")throw Error(r(527,M1,"19.1.0"));me.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var UC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{vn=Df.inject(UC),Zt=Df}catch{}}return yc.createRoot=function(s,o){if(!a(s))throw Error(r(299));var u=!1,p="",y=Wx,w=Jx,N=Kx,L=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(L=o.unstable_transitionCallbacks)),o=T1(s,1,!1,null,null,u,p,y,w,N,L,null),s[Br]=o.current,bh(s),new Hh(o)},yc.hydrateRoot=function(s,o,u){if(!a(s))throw Error(r(299));var p=!1,y="",w=Wx,N=Jx,L=Kx,ne=null,he=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(L=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ne=u.unstable_transitionCallbacks),u.formState!==void 0&&(he=u.formState)),o=T1(s,1,!0,o,u??null,p,y,w,N,L,ne,he),o.context=E1(null),u=o.current,p=Dr(),p=ja(p),y=Es(p),y.callback=null,Ss(u,y,p),u=p,o.current.lanes=u,ta(o,u),Ta(o),s[Br]=o.current,bh(s),new Rf(o)},yc.version="19.1.0",yc}var $1;function JC(){if($1)return qh.exports;$1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),qh.exports=WC(),qh.exports}var KC=JC();const XC=cp(KC);var _c={},H1;function ZC(){if(H1)return _c;H1=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.parse=l,_c.serialize=f;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function l(_,T){const E=new i,S=_.length;if(S<2)return E;const b=(T==null?void 0:T.decode)||g;let k=0;do{const A=_.indexOf("=",k);if(A===-1)break;const C=_.indexOf(";",k),M=C===-1?S:C;if(A>M){k=_.lastIndexOf(";",A-1)+1;continue}const B=c(_,k,A),H=d(_,A,B),F=_.slice(B,H);if(E[F]===void 0){let K=c(_,A+1,M),P=d(_,M,K);const ae=b(_.slice(K,P));E[F]=ae}k=M+1}while(k<S);return E}function c(_,T,E){do{const S=_.charCodeAt(T);if(S!==32&&S!==9)return T}while(++T<E);return E}function d(_,T,E){for(;T>E;){const S=_.charCodeAt(--T);if(S!==32&&S!==9)return T+1}return E}function f(_,T,E){const S=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const b=S(T);if(!e.test(b))throw new TypeError(`argument val is invalid: ${T}`);let k=_+"="+b;if(!E)return k;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);k+="; Max-Age="+E.maxAge}if(E.domain){if(!n.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);k+="; Domain="+E.domain}if(E.path){if(!r.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);k+="; Path="+E.path}if(E.expires){if(!v(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);k+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(k+="; HttpOnly"),E.secure&&(k+="; Secure"),E.partitioned&&(k+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return k}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function v(_){return a.call(_)==="[object Date]"}return _c}ZC();var G1="popstate";function QC(t={}){function e(r,a){let{pathname:i,search:l,hash:c}=r.location;return wm("",{pathname:i,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Yc(a)}return tA(e,n,null,t)}function ln(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ra(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eA(){return Math.random().toString(36).substring(2,10)}function z1(t,e){return{usr:t.state,key:t.key,idx:e}}function wm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ml(e):e,state:n,key:e&&e.key||r||eA()}}function Yc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ml(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function tA(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,l=a.history,c="POP",d=null,f=g();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function g(){return(l.state||{idx:null}).idx}function v(){c="POP";let b=g(),k=b==null?null:b-f;f=b,d&&d({action:c,location:S.location,delta:k})}function _(b,k){c="PUSH";let A=wm(S.location,b,k);f=g()+1;let C=z1(A,f),M=S.createHref(A);try{l.pushState(C,"",M)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(M)}i&&d&&d({action:c,location:S.location,delta:1})}function T(b,k){c="REPLACE";let A=wm(S.location,b,k);f=g();let C=z1(A,f),M=S.createHref(A);l.replaceState(C,"",M),i&&d&&d({action:c,location:S.location,delta:0})}function E(b){return nA(b)}let S={get action(){return c},get location(){return t(a,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(G1,v),d=b,()=>{a.removeEventListener(G1,v),d=null}},createHref(b){return e(a,b)},createURL:E,encodeLocation(b){let k=E(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:_,replace:T,go(b){return l.go(b)}};return S}function nA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ln(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Yc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function vT(t,e,n="/"){return rA(t,e,n,!1)}function rA(t,e,n,r){let a=typeof e=="string"?ml(e):e,i=cs(a.pathname||"/",n);if(i==null)return null;let l=yT(t);aA(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let f=pA(i);c=hA(l[d],f,r)}return c}function yT(t,e=[],n=[],r=""){let a=(i,l,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};d.relativePath.startsWith("/")&&(ln(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let f=ss([r,d.relativePath]),g=n.concat(d);i.children&&i.children.length>0&&(ln(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),yT(i.children,e,g,f)),!(i.path==null&&!i.index)&&e.push({path:f,score:fA(f,i.index),routesMeta:g})};return t.forEach((i,l)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,l);else for(let d of _T(i.path))a(i,l,d)}),e}function _T(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let l=_T(r.join("/")),c=[];return c.push(...l.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function aA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:dA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var sA=/^:[\w-]+$/,iA=3,oA=2,lA=1,cA=10,uA=-2,q1=t=>t==="*";function fA(t,e){let n=t.split("/"),r=n.length;return n.some(q1)&&(r+=uA),e&&(r+=oA),n.filter(a=>!q1(a)).reduce((a,i)=>a+(sA.test(i)?iA:i===""?lA:cA),r)}function dA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function hA(t,e,n=!1){let{routesMeta:r}=t,a={},i="/",l=[];for(let c=0;c<r.length;++c){let d=r[c],f=c===r.length-1,g=i==="/"?e:e.slice(i.length)||"/",v=nd({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},g),_=d.route;if(!v&&f&&n&&!r[r.length-1].route.index&&(v=nd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!v)return null;Object.assign(a,v.params),l.push({params:a,pathname:ss([i,v.pathname]),pathnameBase:yA(ss([i,v.pathnameBase])),route:_}),v.pathnameBase!=="/"&&(i=ss([i,v.pathnameBase]))}return l}function nd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=mA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((f,{paramName:g,isOptional:v},_)=>{if(g==="*"){let E=c[_]||"";l=i.slice(0,i.length-E.length).replace(/(.)\/+$/,"$1")}const T=c[_];return v&&!T?f[g]=void 0:f[g]=(T||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:l,pattern:t}}function mA(t,e=!1,n=!0){Ra(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function pA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ra(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function cs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function gA(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?ml(t):t;return{pathname:n?n.startsWith("/")?n:xA(n,e):e,search:_A(r),hash:wA(a)}}function xA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Kh(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wT(t){let e=vA(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function TT(t,e,n,r=!1){let a;typeof t=="string"?a=ml(t):(a={...t},ln(!a.pathname||!a.pathname.includes("?"),Kh("?","pathname","search",a)),ln(!a.pathname||!a.pathname.includes("#"),Kh("#","pathname","hash",a)),ln(!a.search||!a.search.includes("#"),Kh("#","search","hash",a)));let i=t===""||a.pathname==="",l=i?"/":a.pathname,c;if(l==null)c=n;else{let v=e.length-1;if(!r&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),v-=1;a.pathname=_.join("/")}c=v>=0?e[v]:"/"}let d=gA(a,c),f=l&&l!=="/"&&l.endsWith("/"),g=(i||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||g)&&(d.pathname+="/"),d}var ss=t=>t.join("/").replace(/\/\/+/g,"/"),yA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_A=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function TA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var ET=["POST","PUT","PATCH","DELETE"];new Set(ET);var EA=["GET",...ET];new Set(EA);var pl=U.createContext(null);pl.displayName="DataRouter";var Ad=U.createContext(null);Ad.displayName="DataRouterState";var ST=U.createContext({isTransitioning:!1});ST.displayName="ViewTransition";var SA=U.createContext(new Map);SA.displayName="Fetchers";var bA=U.createContext(null);bA.displayName="Await";var Ia=U.createContext(null);Ia.displayName="Navigation";var cu=U.createContext(null);cu.displayName="Location";var Fa=U.createContext({outlet:null,matches:[],isDataRoute:!1});Fa.displayName="Route";var fp=U.createContext(null);fp.displayName="RouteError";function CA(t,{relative:e}={}){ln(uu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=U.useContext(Ia),{hash:a,pathname:i,search:l}=fu(t,{relative:e}),c=i;return n!=="/"&&(c=i==="/"?n:ss([n,i])),r.createHref({pathname:c,search:l,hash:a})}function uu(){return U.useContext(cu)!=null}function Gi(){return ln(uu(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(cu).location}var bT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function CT(t){U.useContext(Ia).static||U.useLayoutEffect(t)}function AT(){let{isDataRoute:t}=U.useContext(Fa);return t?jA():AA()}function AA(){ln(uu(),"useNavigate() may be used only in the context of a <Router> component.");let t=U.useContext(pl),{basename:e,navigator:n}=U.useContext(Ia),{matches:r}=U.useContext(Fa),{pathname:a}=Gi(),i=JSON.stringify(wT(r)),l=U.useRef(!1);return CT(()=>{l.current=!0}),U.useCallback((d,f={})=>{if(Ra(l.current,bT),!l.current)return;if(typeof d=="number"){n.go(d);return}let g=TT(d,JSON.parse(i),a,f.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:ss([e,g.pathname])),(f.replace?n.replace:n.push)(g,f.state,f)},[e,n,i,a,t])}U.createContext(null);function kA(){let{matches:t}=U.useContext(Fa),e=t[t.length-1];return e?e.params:{}}function fu(t,{relative:e}={}){let{matches:n}=U.useContext(Fa),{pathname:r}=Gi(),a=JSON.stringify(wT(n));return U.useMemo(()=>TT(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function NA(t,e){return kT(t,e)}function kT(t,e,n,r){var k;ln(uu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Ia),{matches:i}=U.useContext(Fa),l=i[i.length-1],c=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",g=l&&l.route;{let A=g&&g.path||"";NT(d,!g||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let v=Gi(),_;if(e){let A=typeof e=="string"?ml(e):e;ln(f==="/"||((k=A.pathname)==null?void 0:k.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${A.pathname}" was given in the \`location\` prop.`),_=A}else _=v;let T=_.pathname||"/",E=T;if(f!=="/"){let A=f.replace(/^\//,"").split("/");E="/"+T.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=vT(t,{pathname:E});Ra(g||S!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Ra(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=FA(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},c,A.params),pathname:ss([f,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?f:ss([f,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),i,n,r);return e&&b?U.createElement(cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},b):b}function RA(){let t=BA(),e=TA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:i},"ErrorBoundary")," or"," ",U.createElement("code",{style:i},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),n?U.createElement("pre",{style:a},n):null,l)}var DA=U.createElement(RA,null),MA=class extends U.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?U.createElement(Fa.Provider,{value:this.props.routeContext},U.createElement(fp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IA({routeContext:t,match:e,children:n}){let r=U.useContext(pl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Fa.Provider,{value:t},n)}function FA(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,i=n==null?void 0:n.errors;if(i!=null){let d=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);ln(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,c=-1;if(n)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=d),f.route.id){let{loaderData:g,errors:v}=n,_=f.route.loader&&!g.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||_){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,f,g)=>{let v,_=!1,T=null,E=null;n&&(v=i&&f.route.id?i[f.route.id]:void 0,T=f.route.errorElement||DA,l&&(c<0&&g===0?(NT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):c===g&&(_=!0,E=f.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,g+1)),b=()=>{let k;return v?k=T:_?k=E:f.route.Component?k=U.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,U.createElement(IA,{match:f,routeContext:{outlet:d,matches:S,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?U.createElement(MA,{location:n.location,revalidation:n.revalidation,component:T,error:v,children:b(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):b()},null)}function dp(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LA(t){let e=U.useContext(pl);return ln(e,dp(t)),e}function OA(t){let e=U.useContext(Ad);return ln(e,dp(t)),e}function PA(t){let e=U.useContext(Fa);return ln(e,dp(t)),e}function hp(t){let e=PA(t),n=e.matches[e.matches.length-1];return ln(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function UA(){return hp("useRouteId")}function BA(){var r;let t=U.useContext(fp),e=OA("useRouteError"),n=hp("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function jA(){let{router:t}=LA("useNavigate"),e=hp("useNavigate"),n=U.useRef(!1);return CT(()=>{n.current=!0}),U.useCallback(async(a,i={})=>{Ra(n.current,bT),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var Y1={};function NT(t,e,n){!e&&!Y1[t]&&(Y1[t]=!0,Ra(!1,n))}U.memo(VA);function VA({routes:t,future:e,state:n}){return kT(t,void 0,n,e)}function Tm(t){ln(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function $A({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:i=!1}){ln(!uu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=U.useMemo(()=>({basename:l,navigator:a,static:i,future:{}}),[l,a,i]);typeof n=="string"&&(n=ml(n));let{pathname:d="/",search:f="",hash:g="",state:v=null,key:_="default"}=n,T=U.useMemo(()=>{let E=cs(d,l);return E==null?null:{location:{pathname:E,search:f,hash:g,state:v,key:_},navigationType:r}},[l,d,f,g,v,_,r]);return Ra(T!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:U.createElement(Ia.Provider,{value:c},U.createElement(cu.Provider,{children:e,value:T}))}function HA({children:t,location:e}){return NA(Em(t),e)}function Em(t,e=[]){let n=[];return U.Children.forEach(t,(r,a)=>{if(!U.isValidElement(r))return;let i=[...e,a];if(r.type===U.Fragment){n.push.apply(n,Em(r.props.children,i));return}ln(r.type===Tm,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ln(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Em(r.props.children,i)),n.push(l)}),n}var Xf="get",Zf="application/x-www-form-urlencoded";function kd(t){return t!=null&&typeof t.tagName=="string"}function GA(t){return kd(t)&&t.tagName.toLowerCase()==="button"}function zA(t){return kd(t)&&t.tagName.toLowerCase()==="form"}function qA(t){return kd(t)&&t.tagName.toLowerCase()==="input"}function YA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WA(t,e){return t.button===0&&(!e||e==="_self")&&!YA(t)}var Mf=null;function JA(){if(Mf===null)try{new FormData(document.createElement("form"),0),Mf=!1}catch{Mf=!0}return Mf}var KA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xh(t){return t!=null&&!KA.has(t)?(Ra(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Zf}"`),null):t}function XA(t,e){let n,r,a,i,l;if(zA(t)){let c=t.getAttribute("action");r=c?cs(c,e):null,n=t.getAttribute("method")||Xf,a=Xh(t.getAttribute("enctype"))||Zf,i=new FormData(t)}else if(GA(t)||qA(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||c.getAttribute("action");if(r=d?cs(d,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||Xf,a=Xh(t.getAttribute("formenctype"))||Xh(c.getAttribute("enctype"))||Zf,i=new FormData(c,t),!JA()){let{name:f,type:g,value:v}=t;if(g==="image"){let _=f?`${f}.`:"";i.append(`${_}x`,"0"),i.append(`${_}y`,"0")}else f&&i.append(f,v)}}else{if(kd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Xf,r=null,a=Zf,l=t}return i&&a==="text/plain"&&(l=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:l}}function mp(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function ZA(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function QA(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function ek(t,e,n){let r=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let l=await ZA(i,n);return l.links?l.links():[]}return[]}));return ak(r.flat(1).filter(QA).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function W1(t,e,n,r,a,i){let l=(d,f)=>n[f]?d.route.id!==n[f].route.id:!0,c=(d,f)=>{var g;return n[f].pathname!==d.pathname||((g=n[f].route.path)==null?void 0:g.endsWith("*"))&&n[f].params["*"]!==d.params["*"]};return i==="assets"?e.filter((d,f)=>l(d,f)||c(d,f)):i==="data"?e.filter((d,f)=>{var v;let g=r.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(l(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let _=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function tk(t,e,{includeHydrateFallback:n}={}){return nk(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function nk(t){return[...new Set(t)]}function rk(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function ak(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let i=JSON.stringify(rk(a));return n.has(i)||(n.add(i),r.push({key:i,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var sk=new Set([100,101,204,205]);function ik(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&cs(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function RT(){let t=U.useContext(pl);return mp(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function ok(){let t=U.useContext(Ad);return mp(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var pp=U.createContext(void 0);pp.displayName="FrameworkContext";function DT(){let t=U.useContext(pp);return mp(t,"You must render this element inside a <HydratedRouter> element"),t}function lk(t,e){let n=U.useContext(pp),[r,a]=U.useState(!1),[i,l]=U.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:g,onTouchStart:v}=e,_=U.useRef(null);U.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let S=k=>{k.forEach(A=>{l(A.isIntersecting)})},b=new IntersectionObserver(S,{threshold:.5});return _.current&&b.observe(_.current),()=>{b.disconnect()}}},[t]),U.useEffect(()=>{if(r){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[r]);let T=()=>{a(!0)},E=()=>{a(!1),l(!1)};return n?t!=="intent"?[i,_,{}]:[i,_,{onFocus:wc(c,T),onBlur:wc(d,E),onMouseEnter:wc(f,T),onMouseLeave:wc(g,E),onTouchStart:wc(v,T)}]:[!1,_,{}]}function wc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function ck({page:t,...e}){let{router:n}=RT(),r=U.useMemo(()=>vT(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?U.createElement(fk,{page:t,matches:r,...e}):null}function uk(t){let{manifest:e,routeModules:n}=DT(),[r,a]=U.useState([]);return U.useEffect(()=>{let i=!1;return ek(t,e,n).then(l=>{i||a(l)}),()=>{i=!0}},[t,e,n]),r}function fk({page:t,matches:e,...n}){let r=Gi(),{manifest:a,routeModules:i}=DT(),{basename:l}=RT(),{loaderData:c,matches:d}=ok(),f=U.useMemo(()=>W1(t,e,d,a,r,"data"),[t,e,d,a,r]),g=U.useMemo(()=>W1(t,e,d,a,r,"assets"),[t,e,d,a,r]),v=U.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let E=new Set,S=!1;if(e.forEach(k=>{var C;let A=a.routes[k.route.id];!A||!A.hasLoader||(!f.some(M=>M.route.id===k.route.id)&&k.route.id in c&&((C=i[k.route.id])!=null&&C.shouldRevalidate)||A.hasClientLoader?S=!0:E.add(k.route.id))}),E.size===0)return[];let b=ik(t,l);return S&&E.size>0&&b.searchParams.set("_routes",e.filter(k=>E.has(k.route.id)).map(k=>k.route.id).join(",")),[b.pathname+b.search]},[l,c,r,a,f,e,t,i]),_=U.useMemo(()=>tk(g,a),[g,a]),T=uk(g);return U.createElement(U.Fragment,null,v.map(E=>U.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...n})),_.map(E=>U.createElement("link",{key:E,rel:"modulepreload",href:E,...n})),T.map(({key:E,link:S})=>U.createElement("link",{key:E,...S})))}function dk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var MT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{MT&&(window.__reactRouterVersion="7.6.3")}catch{}function hk({basename:t,children:e,window:n}){let r=U.useRef();r.current==null&&(r.current=QC({window:n,v5Compat:!0}));let a=r.current,[i,l]=U.useState({action:a.action,location:a.location}),c=U.useCallback(d=>{U.startTransition(()=>l(d))},[l]);return U.useLayoutEffect(()=>a.listen(c),[a,c]),U.createElement($A,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:a})}var IT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,FT=U.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:i,replace:l,state:c,target:d,to:f,preventScrollReset:g,viewTransition:v,..._},T){let{basename:E}=U.useContext(Ia),S=typeof f=="string"&&IT.test(f),b,k=!1;if(typeof f=="string"&&S&&(b=f,MT))try{let P=new URL(window.location.href),ae=f.startsWith("//")?new URL(P.protocol+f):new URL(f),G=cs(ae.pathname,E);ae.origin===P.origin&&G!=null?f=G+ae.search+ae.hash:k=!0}catch{Ra(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=CA(f,{relative:a}),[C,M,B]=lk(r,_),H=xk(f,{replace:l,state:c,target:d,preventScrollReset:g,relative:a,viewTransition:v});function F(P){e&&e(P),P.defaultPrevented||H(P)}let K=U.createElement("a",{..._,...B,href:b||A,onClick:k||i?e:F,ref:dk(T,M),target:d,"data-discover":!S&&n==="render"?"true":void 0});return C&&!S?U.createElement(U.Fragment,null,K,U.createElement(ck,{page:A})):K});FT.displayName="Link";var mk=U.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:i,to:l,viewTransition:c,children:d,...f},g){let v=fu(l,{relative:f.relative}),_=Gi(),T=U.useContext(Ad),{navigator:E,basename:S}=U.useContext(Ia),b=T!=null&&Tk(v)&&c===!0,k=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,A=_.pathname,C=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(A=A.toLowerCase(),C=C?C.toLowerCase():null,k=k.toLowerCase()),C&&S&&(C=cs(C,S)||C);const M=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let B=A===k||!a&&A.startsWith(k)&&A.charAt(M)==="/",H=C!=null&&(C===k||!a&&C.startsWith(k)&&C.charAt(k.length)==="/"),F={isActive:B,isPending:H,isTransitioning:b},K=B?e:void 0,P;typeof r=="function"?P=r(F):P=[r,B?"active":null,H?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let ae=typeof i=="function"?i(F):i;return U.createElement(FT,{...f,"aria-current":K,className:P,ref:g,style:ae,to:l,viewTransition:c},typeof d=="function"?d(F):d)});mk.displayName="NavLink";var pk=U.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:i,method:l=Xf,action:c,onSubmit:d,relative:f,preventScrollReset:g,viewTransition:v,..._},T)=>{let E=_k(),S=wk(c,{relative:f}),b=l.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&IT.test(c),A=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let M=C.nativeEvent.submitter,B=(M==null?void 0:M.getAttribute("formmethod"))||l;E(M||C.currentTarget,{fetcherKey:e,method:B,navigate:n,replace:a,state:i,relative:f,preventScrollReset:g,viewTransition:v})};return U.createElement("form",{ref:T,method:b,action:S,onSubmit:r?d:A,..._,"data-discover":!k&&t==="render"?"true":void 0})});pk.displayName="Form";function gk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LT(t){let e=U.useContext(pl);return ln(e,gk(t)),e}function xk(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:l}={}){let c=AT(),d=Gi(),f=fu(t,{relative:i});return U.useCallback(g=>{if(WA(g,e)){g.preventDefault();let v=n!==void 0?n:Yc(d)===Yc(f);c(t,{replace:v,state:r,preventScrollReset:a,relative:i,viewTransition:l})}},[d,c,f,n,r,e,t,a,i,l])}var vk=0,yk=()=>`__${String(++vk)}__`;function _k(){let{router:t}=LT("useSubmit"),{basename:e}=U.useContext(Ia),n=UA();return U.useCallback(async(r,a={})=>{let{action:i,method:l,encType:c,formData:d,body:f}=XA(r,e);if(a.navigate===!1){let g=a.fetcherKey||yk();await t.fetch(g,n,a.action||i,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,flushSync:a.flushSync})}else await t.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function wk(t,{relative:e}={}){let{basename:n}=U.useContext(Ia),r=U.useContext(Fa);ln(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...fu(t||".",{relative:e})},l=Gi();if(t==null){i.search=l.search;let c=new URLSearchParams(i.search),d=c.getAll("index");if(d.some(g=>g==="")){c.delete("index"),d.filter(v=>v).forEach(v=>c.append("index",v));let g=c.toString();i.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:ss([n,i.pathname])),Yc(i)}function Tk(t,e={}){let n=U.useContext(ST);ln(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=LT("useViewTransitionState"),a=fu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=cs(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=cs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return nd(a.pathname,l)!=null||nd(a.pathname,i)!=null}[...sk];const Ek="modulepreload",Sk=function(t){return"/"+t},J1={},du=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(f=>{if(f=Sk(f),f in J1)return;J1[f]=!0;const g=f.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":Ek,g||(_.as="script"),_.crossOrigin="",_.href=f,d&&_.setAttribute("nonce",d),document.head.appendChild(_),g)return new Promise((T,E)=>{_.addEventListener("load",T),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},bk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>du(async()=>{const{default:r}=await Promise.resolve().then(()=>gl);return{default:r}},[]).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class gp extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Ck extends gp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class K1 extends gp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class X1 extends gp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Sm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Sm||(Sm={}));var Ak=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class kk{constructor(e,{headers:n={},customFetch:r,region:a=Sm.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=bk(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return Ak(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:l}=n;let c={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const v=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new Ck(S)}),_=v.headers.get("x-relay-error");if(_&&_==="true")throw new K1(v);if(!v.ok)throw new X1(v);let T=((r=v.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return T==="application/json"?E=yield v.json():T==="application/octet-stream"?E=yield v.blob():T==="text/event-stream"?E=v:T==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(a){return{data:null,error:a,response:a instanceof X1||a instanceof K1?a.context:void 0}}})}}var Bn={},Oo={},Po={},Uo={},Bo={},jo={},Nk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},sl=Nk();const Rk=sl.fetch,OT=sl.fetch.bind(sl),PT=sl.Headers,Dk=sl.Request,Mk=sl.Response,gl=Object.freeze(Object.defineProperty({__proto__:null,Headers:PT,Request:Dk,Response:Mk,default:OT,fetch:Rk},Symbol.toStringTag,{value:"Module"})),Ik=jC(gl);var If={},Z1;function UT(){if(Z1)return If;Z1=1,Object.defineProperty(If,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return If.default=t,If}var Q1;function BT(){if(Q1)return jo;Q1=1;var t=jo&&jo.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(jo,"__esModule",{value:!0});const e=t(Ik),n=t(UT());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,l){return this.headers=Object.assign({},this.headers),this.headers[i]=l,this}then(i,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,v,_;let T=null,E=null,S=null,b=f.status,k=f.statusText;if(f.ok){if(this.method!=="HEAD"){const B=await f.text();B===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=B:E=JSON.parse(B))}const C=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),M=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");C&&M&&M.length>1&&(S=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(T={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,b=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const C=await f.text();try{T=JSON.parse(C),Array.isArray(T)&&f.status===404&&(E=[],T=null,b=200,k="OK")}catch{f.status===404&&C===""?(b=204,k="No Content"):T={message:C}}if(T&&this.isMaybeSingle&&(!((_=T==null?void 0:T.details)===null||_===void 0)&&_.includes("0 rows"))&&(T=null,b=200,k="OK"),T&&this.shouldThrowOnError)throw new n.default(T)}return{error:T,data:E,count:S,status:b,statusText:k}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,v,_;return{error:{message:`${(g=f==null?void 0:f.name)!==null&&g!==void 0?g:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(v=f==null?void 0:f.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=f==null?void 0:f.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),d.then(i,l)}returns(){return this}overrideTypes(){return this}}return jo.default=r,jo}var ey;function jT(){if(ey)return Bo;ey=1;var t=Bo&&Bo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bo,"__esModule",{value:!0});const e=t(BT());class n extends e.default{select(a){let i=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:i=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${i?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,i,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this.url.searchParams.set(f,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:i=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var g;const v=[a?"analyze":null,i?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${_}"; options=${v};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Bo.default=n,Bo}var ty;function xp(){if(ty)return Uo;ty=1;var t=Uo&&Uo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Uo,"__esModule",{value:!0});const e=t(jT());class n extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${f}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return Uo.default=n,Uo}var ny;function VT(){if(ny)return Po;ny=1;var t=Po&&Po.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Po,"__esModule",{value:!0});const e=t(xp());class n{constructor(a,{headers:i={},schema:l,fetch:c}){this.url=a,this.headers=i,this.schema=l,this.fetch=c}select(a,{head:i=!1,count:l}={}){const c=i?"HEAD":"GET";let d=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:i,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),i&&d.push(`count=${i}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const f=a.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(f.length>0){const g=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:i,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const f="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),d||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const v=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(v.length>0){const _=[...new Set(v)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:i}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const i="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Po.default=n,Po}var Tc={},Ec={},ry;function Fk(){return ry||(ry=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.version=void 0,Ec.version="0.0.0-automated"),Ec}var ay;function Lk(){if(ay)return Tc;ay=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.DEFAULT_HEADERS=void 0;const t=Fk();return Tc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Tc}var sy;function Ok(){if(sy)return Oo;sy=1;var t=Oo&&Oo.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Oo,"__esModule",{value:!0});const e=t(VT()),n=t(xp()),r=Lk();class a{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:g}={}){let v;const _=new URL(`${this.url}/rpc/${l}`);let T;d||f?(v=d?"HEAD":"GET",Object.entries(c).filter(([S,b])=>b!==void 0).map(([S,b])=>[S,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([S,b])=>{_.searchParams.append(S,b)})):(v="POST",T=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:v,url:_,headers:E,schema:this.schemaName,body:T,fetch:this.fetch,allowEmpty:!1})}}return Oo.default=a,Oo}var iy;function Pk(){if(iy)return Bn;iy=1;var t=Bn&&Bn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.PostgrestError=Bn.PostgrestBuilder=Bn.PostgrestTransformBuilder=Bn.PostgrestFilterBuilder=Bn.PostgrestQueryBuilder=Bn.PostgrestClient=void 0;const e=t(Ok());Bn.PostgrestClient=e.default;const n=t(VT());Bn.PostgrestQueryBuilder=n.default;const r=t(xp());Bn.PostgrestFilterBuilder=r.default;const a=t(jT());Bn.PostgrestTransformBuilder=a.default;const i=t(BT());Bn.PostgrestBuilder=i.default;const l=t(UT());return Bn.PostgrestError=l.default,Bn.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:l.default},Bn}var Uk=Pk();const Bk=cp(Uk),{PostgrestClient:jk,PostgrestQueryBuilder:pG,PostgrestFilterBuilder:gG,PostgrestTransformBuilder:xG,PostgrestBuilder:vG,PostgrestError:yG}=Bk;function Vk(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const $k=Vk(),Hk="2.11.15",Gk=`realtime-js/${Hk}`,zk="1.0.0",$T=1e4,qk=1e3;var Ic;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ic||(Ic={}));var Qn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Qn||(Qn={}));var ca;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ca||(ca={}));var bm;(function(t){t.websocket="websocket"})(bm||(bm={}));var Ai;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ai||(Ai={}));class Yk{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const d=r.decode(e.slice(l,l+i));l=l+i;const f=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class HT{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Jt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Jt||(Jt={}));const oy=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,l)=>(i[l]=Wk(l,t,e,a),i),{})},Wk=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,l=n[t];return i&&!r.includes(i)?GT(i,l):Cm(l)},GT=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Zk(e,n)}switch(t){case Jt.bool:return Jk(e);case Jt.float4:case Jt.float8:case Jt.int2:case Jt.int4:case Jt.int8:case Jt.numeric:case Jt.oid:return Kk(e);case Jt.json:case Jt.jsonb:return Xk(e);case Jt.timestamp:return Qk(e);case Jt.abstime:case Jt.date:case Jt.daterange:case Jt.int4range:case Jt.int8range:case Jt.money:case Jt.reltime:case Jt.text:case Jt.time:case Jt.timestamptz:case Jt.timetz:case Jt.tsrange:case Jt.tstzrange:return Cm(e);default:return Cm(e)}},Cm=t=>t,Jk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Kk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Xk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Zk=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const l=t.slice(1,n);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>GT(e,c))}return t},Qk=t=>typeof t=="string"?t.replace(" ","T"):t,zT=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Zh{constructor(e,n,r={},a=$T){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ly;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ly||(ly={}));class Fc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fc.syncState(this.state,a,i,l),this.pendingDiffs.forEach(d=>{this.state=Fc.syncDiff(this.state,d,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Fc.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(i,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const v=i[f];if(v){const _=g.map(b=>b.presence_ref),T=v.map(b=>b.presence_ref),E=g.filter(b=>T.indexOf(b.presence_ref)<0),S=v.filter(b=>_.indexOf(b.presence_ref)<0);E.length>0&&(c[f]=E),S.length>0&&(d[f]=S)}else c[f]=g}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var f;const g=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),g.length>0){const v=e[c].map(T=>T.presence_ref),_=g.filter(T=>v.indexOf(T.presence_ref)<0);e[c].unshift(..._)}r(c,g,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const g=d.map(v=>v.presence_ref);f=f.filter(v=>g.indexOf(v.presence_ref)<0),e[c]=f,a(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var cy;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(cy||(cy={}));var uy;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(uy||(uy={}));var rs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(rs||(rs={}));class vp{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Qn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Zh(this,ca.join,this.params,this.timeout),this.rejoinTimer=new HT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Qn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Qn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Qn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Qn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ca.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Fc(this),this.broadcastEndpointURL=zT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Qn.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e(rs.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(rs.CLOSED));const d={},f={broadcast:i,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var v;if(this.socket.setAuth(),g===void 0){e==null||e(rs.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,T=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,E=[];for(let S=0;S<T;S++){const b=_[S],{filter:{event:k,schema:A,table:C,filter:M}}=b,B=g&&g[S];if(B&&B.event===k&&B.schema===A&&B.table===C&&B.filter===M)E.push(Object.assign(Object.assign({},b),{id:B.id}));else{this.unsubscribe(),this.state=Qn.errored,e==null||e(rs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(rs.SUBSCRIBED);return}}).receive("error",g=>{this.state=Qn.errored,e==null||e(rs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(rs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Qn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ca.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Zh(this,ca.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Zh(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:g}=ca;if(r&&[c,d,f,g].indexOf(l)>=0&&r!==this._joinRef())return;let _=this._onMessage(l,n,r);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var E,S,b;return((E=T.filter)===null||E===void 0?void 0:E.event)==="*"||((b=(S=T.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===l}).map(T=>T.callback(_,r)):(i=this.bindings[l])===null||i===void 0||i.filter(T=>{var E,S,b,k,A,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const M=T.id,B=(E=T.filter)===null||E===void 0?void 0:E.event;return M&&((S=n.ids)===null||S===void 0?void 0:S.includes(M))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const M=(A=(k=T==null?void 0:T.filter)===null||k===void 0?void 0:k.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return M==="*"||M===((C=n==null?void 0:n.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:S,table:b,commit_timestamp:k,type:A,errors:C}=E;_=Object.assign(Object.assign({},{schema:S,table:b,commit_timestamp:k,eventType:A,new:{},old:{},errors:C}),this._getPayloadRecords(E))}T.callback(_,r)})}_isClosed(){return this.state===Qn.closed}_isJoined(){return this.state===Qn.joined}_isJoining(){return this.state===Qn.joining}_isLeaving(){return this.state===Qn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&vp.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ca.close,{},e)}_onError(e){this._on(ca.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Qn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=oy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=oy(e.columns,e.old_record)),n}}const fy=()=>{},e4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class t4{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$T,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fy,this.ref=0,this.logger=fy,this.conn=null,this.sendBuffer=[],this.serializer=new Yk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...c)=>du(async()=>{const{default:d}=await Promise.resolve().then(()=>gl);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${bm.websocket}`,this.httpEndpoint=zT(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,l)=>l(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new HT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=$k),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:zk}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ic.connecting:return Ai.Connecting;case Ic.open:return Ai.Open;case Ic.closing:return Ai.Closing;default:return Ai.Closed}}isConnected(){return this.connectionState()===Ai.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new vp(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:Gk};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(ca.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(qk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ca.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([e4],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class yp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class n4 extends yp{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Am extends yp{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var r4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const qT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>du(async()=>{const{default:r}=await Promise.resolve().then(()=>gl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},a4=()=>r4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield du(()=>Promise.resolve().then(()=>gl),void 0)).Response:Response}),km=t=>{if(Array.isArray(t))return t.map(n=>km(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=km(r)}),e};var zi=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const Qh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),s4=(t,e,n)=>zi(void 0,void 0,void 0,function*(){const r=yield a4();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new n4(Qh(a),t.status||500))}).catch(a=>{e(new Am(Qh(a),a))}):e(new Am(Qh(t),t))}),i4=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function hu(t,e,n,r,a,i){return zi(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,i4(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>s4(d,c,r))})})}function rd(t,e,n,r){return zi(this,void 0,void 0,function*(){return hu(t,"GET",e,n,r)})}function Gs(t,e,n,r,a){return zi(this,void 0,void 0,function*(){return hu(t,"POST",e,r,a,n)})}function o4(t,e,n,r,a){return zi(this,void 0,void 0,function*(){return hu(t,"PUT",e,r,a,n)})}function l4(t,e,n,r){return zi(this,void 0,void 0,function*(){return hu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function YT(t,e,n,r,a){return zi(this,void 0,void 0,function*(){return hu(t,"DELETE",e,r,a,n)})}var Tr=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const c4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},dy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class u4{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=qT(a)}uploadOrUpdate(e,n,r,a){return Tr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},dy),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),v=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:i,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),_=yield v.json();return v.ok?{data:{path:f,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(i){if(jn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return Tr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),l=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let d;const f=Object.assign({upsert:dy.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",f.cacheControl)):(d=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const v=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:g}),_=yield v.json();return v.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(d){if(jn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return Tr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Gs(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+i.url),c=l.searchParams.get("token");if(!c)throw new yp("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}update(e,n,r){return Tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Tr(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return Tr(this,void 0,void 0,function*(){try{return{data:{path:(yield Gs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return Tr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Gs(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return Tr(this,void 0,void 0,function*(){try{const a=yield Gs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}download(e,n){return Tr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield rd(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(jn(c))return{data:null,error:c};throw c}})}info(e){return Tr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield rd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:km(r),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}exists(e){return Tr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield l4(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(jn(r)&&r instanceof Am){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(e){return Tr(this,void 0,void 0,function*(){try{return{data:yield YT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}list(e,n,r){return Tr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},c4),n),{prefix:e||""});return{data:yield Gs(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const f4="2.7.1",d4={"X-Client-Info":`storage-js/${f4}`};var Vo=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class h4{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},d4),n),this.fetch=qT(r)}listBuckets(){return Vo(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(jn(e))return{data:null,error:e};throw e}})}getBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield rd(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Vo(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Vo(this,void 0,void 0,function*(){try{return{data:yield o4(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Vo(this,void 0,void 0,function*(){try{return{data:yield YT(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}}class m4 extends h4{constructor(e,n={},r){super(e,n,r)}from(e){return new u4(this.url,this.headers,e,this.fetch)}}const p4="2.50.3";let bc="";typeof Deno<"u"?bc="deno":typeof document<"u"?bc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?bc="react-native":bc="node";const g4={"X-Client-Info":`supabase-js-${bc}/${p4}`},x4={headers:g4},v4={schema:"public"},y4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_4={};var w4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const T4=t=>{let e;return t?e=t:typeof fetch>"u"?e=OT:e=fetch,(...n)=>e(...n)},E4=()=>typeof Headers>"u"?PT:Headers,S4=(t,e,n)=>{const r=T4(n),a=E4();return(i,l)=>w4(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},l),{headers:f}))})};var b4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};function C4(t){return t.endsWith("/")?t:t+"/"}function A4(t,e){var n,r;const{db:a,auth:i,realtime:l,global:c}=t,{db:d,auth:f,realtime:g,global:v}=e,_={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),i),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(n=v==null?void 0:v.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>b4(this,void 0,void 0,function*(){return""})};return t.accessToken?_.accessToken=t.accessToken:delete _.accessToken,_}const WT="2.70.0",Jo=30*1e3,Nm=3,em=Nm*Jo,k4="http://localhost:9999",N4="supabase.auth.token",R4={"X-Client-Info":`gotrue-js/${WT}`},Rm="X-Supabase-Api-Version",JT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},D4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,M4=6e5;class _p extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ct(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class I4 extends _p{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function F4(t){return ct(t)&&t.name==="AuthApiError"}class KT extends _p{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ri extends _p{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Hs extends ri{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function L4(t){return ct(t)&&t.name==="AuthSessionMissingError"}class Ff extends ri{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lf extends ri{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Of extends ri{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function O4(t){return ct(t)&&t.name==="AuthImplicitGrantRedirectError"}class hy extends ri{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Dm extends ri{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function tm(t){return ct(t)&&t.name==="AuthRetryableFetchError"}class my extends ri{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Lc extends ri{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ad="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),py=` 	
\r=`.split(""),P4=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<py.length;e+=1)t[py[e].charCodeAt(0)]=-2;for(let e=0;e<ad.length;e+=1)t[ad[e].charCodeAt(0)]=e;return t})();function gy(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ad[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ad[r]),e.queuedBits-=6}}function XT(t,e,n){const r=P4[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function xy(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{j4(l,r,n)};for(let l=0;l<t.length;l+=1)XT(t.charCodeAt(l),a,i);return e.join("")}function U4(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function B4(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}U4(r,e)}}function j4(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function V4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)XT(t.charCodeAt(a),n,r);return new Uint8Array(e)}function $4(t){const e=[];return B4(t,n=>e.push(n)),new Uint8Array(e)}function H4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>gy(a,n,r)),gy(null,n,r),e.join("")}function G4(t){return Math.round(Date.now()/1e3)+t}function z4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const la=()=>typeof window<"u"&&typeof document<"u",Si={tested:!1,writable:!1},Oc=()=>{if(!la())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Si.tested)return Si.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Si.tested=!0,Si.writable=!0}catch{Si.tested=!0,Si.writable=!1}return Si.writable};function q4(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const ZT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>du(async()=>{const{default:r}=await Promise.resolve().then(()=>gl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Y4=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",QT=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Pf=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Uf=async(t,e)=>{await t.removeItem(e)};class Nd{constructor(){this.promise=new Nd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Nd.promiseConstructor=Promise;function nm(t){const e=t.split(".");if(e.length!==3)throw new Lc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!D4.test(e[r]))throw new Lc("JWT not in base64url format");return{header:JSON.parse(xy(e[0])),payload:JSON.parse(xy(e[1])),signature:V4(e[2]),raw:{header:e[0],payload:e[1]}}}async function W4(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function J4(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await t(i);if(!e(i,null,l)){r(l);return}}catch(l){if(!e(i,l)){a(l);return}}})()})}function K4(t){return("0"+t.toString(16)).substr(-2)}function X4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,K4).join("")}async function Z4(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Q4(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Z4(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $o(t,e,n=!1){const r=X4();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await QT(t,`${e}-code-verifier`,a);const i=await Q4(r);return[i,r===i?"plain":"s256"]}const eN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function tN(t){const e=t.headers.get(Rm);if(!e||!e.match(eN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nN(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function rN(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const aN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ho(t){if(!aN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var sN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Ci=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),iN=[502,503,504];async function vy(t){var e;if(!Y4(t))throw new Dm(Ci(t),0);if(iN.includes(t.status))throw new Dm(Ci(t),t.status);let n;try{n=await t.json()}catch(i){throw new KT(Ci(i),i)}let r;const a=tN(t);if(a&&a.getTime()>=JT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new my(Ci(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Hs}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new my(Ci(n),t.status,n.weak_password.reasons);throw new I4(Ci(n),t.status||500,r)}const oN=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function _t(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Rm]||(i[Rm]=JT["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await lN(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function lN(t,e,n,r,a,i){const l=oN(e,r,a,i);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new Dm(Ci(d),0)}if(c.ok||await vy(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await vy(d)}}function ns(t){var e;let n=null;dN(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=G4(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function yy(t){const e=ns(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function qs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function cN(t){return{data:t,error:null}}function uN(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,l=sN(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function fN(t){return t}function dN(t){return t.access_token&&t.refresh_token&&t.expires_in}const rm=["global","local","others"];var hN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class mN{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=ZT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=rm[0]){if(rm.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${rm.join(", ")}`);try{return await _t(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await _t(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:qs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=hN(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await _t(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:uN,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ct(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await _t(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qs})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},g=await _t(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:fN});if(g.error)throw g.error;const v=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(d=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return T.length>0&&(T.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(E.split(";")[1].split("=")[1]);f[`${b}Page`]=S}),f.total=parseInt(_)),{data:Object.assign(Object.assign({},v),f),error:null}}catch(f){if(ct(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Ho(e);try{return await _t(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qs})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ho(e);try{return await _t(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:qs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Ho(e);try{return await _t(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:qs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ho(e.userId);try{const{data:n,error:r}=await _t(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ho(e.userId),Ho(e.id);try{return{data:await _t(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}}const pN={getItem:t=>Oc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Oc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Oc()&&globalThis.localStorage.removeItem(t)}};function _y(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function gN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Go={debug:!!(globalThis&&Oc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class e2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class xN extends e2{}async function vN(t,e,n){Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Go.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Go.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new xN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Go.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}gN();const yN={url:k4,storageKey:N4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:R4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function wy(t,e,n){return await n()}class Wc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Wc.nextInstanceID,Wc.nextInstanceID+=1,this.instanceID>0&&la()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},yN),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new mN({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ZT(a.fetch),this.lock=a.lock||wy,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:la()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=vN:this.lock=wy,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Oc()?this.storage=pN:(this.memoryStorage={},this.storage=_y(this.memoryStorage)):(this.memoryStorage={},this.storage=_y(this.memoryStorage)),la()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${WT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=q4(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),la()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),O4(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ct(n)?{error:n}:{error:new KT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ns}),{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:g,password:v,options:_}=e;let T=null,E=null;this.flowType==="pkce"&&([T,E]=await $o(this.storage,this.storageKey)),i=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:g,password:v,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:T,code_challenge_method:E},xform:ns})}else if("phone"in e){const{phone:g,password:v,options:_}=e;i=await _t(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(a=_==null?void 0:_.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:ns})}else throw new Lf("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:l,options:c}=e;n=await _t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:yy})}else if("phone"in e){const{phone:i,password:l,options:c}=e;n=await _t(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:yy})}else throw new Lf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ff}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,l,c,d,f,g,v,_,T;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:b,wallet:k,statement:A,options:C}=e;let M;if(la())if(typeof k=="object")M=k;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))M=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=k}const B=new URL((n=C==null?void 0:C.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in M&&M.signIn){const H=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),A?{statement:A}:null));let F;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")F=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)F=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)E=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),S=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${B.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(a=(r=C==null?void 0:C.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=C==null?void 0:C.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C==null?void 0:C.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C==null?void 0:C.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C==null?void 0:C.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C==null?void 0:C.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((v=(g=C==null?void 0:C.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...C.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const H=await M.signMessage(new TextEncoder().encode(E),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=H}}try{const{data:b,error:k}=await _t(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:H4(S)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:ns});if(k)throw k;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new Ff}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:k})}catch(b){if(ct(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(e){const n=await Pf(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:l}=await _t(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ns});if(await Uf(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ff}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:l}=e,c=await _t(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ns}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Ff}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await $o(this.storage,this.storageKey));const{error:v}=await _t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:g}=await _t(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g}}throw new Lf("You must provide either an email or phone number.")}catch(c){if(ct(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await _t(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ns});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ct(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await $o(this.storage,this.storageKey)),await _t(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:cN})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Hs;const{error:a}=await _t(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(ct(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:l}=await _t(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:l,error:c}=await _t(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new Lf("You must provide either an email or phone number and a type")}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Pf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<em:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await _t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qs}):await this._useSession(async n=>{var r,a,i;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Hs}:await _t(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:qs})})}catch(n){if(ct(n))return L4(n)&&(await this._removeSession(),await Uf(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Hs;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await $o(this.storage,this.storageKey));const{data:f,error:g}=await _t(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:qs});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Hs;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:l}=nm(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ct(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Hs;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!la())throw new Of("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Of(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new hy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Of("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new hy("No code detected.");const{data:A,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!i||!c||!l||!f)throw new Of("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(c);let _=g+v;d&&(_=parseInt(d));const T=_-g;T*1e3<=Jo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${v}s`);const E=_-v;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,g);const{data:S,error:b}=await this._getUser(i);if(b)throw b;const k={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:v,expires_at:_,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:e.type},error:null}}catch(r){if(ct(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Pf(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(F4(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Uf(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=z4(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await $o(this.storage,this.storageKey,!0));try{return await _t(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var l,c,d,f,g;const{data:v,error:_}=i;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await _t(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(f=v.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return la()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ct(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)throw l;return await _t(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await J4(async a=>(a>0&&await W4(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await _t(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ns})),(a,i)=>{const l=200*Math.pow(2,a);return i&&tm(i)&&Date.now()+l-r<Jo})}catch(r){if(this._debug(n,"error",r),ct(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),la()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Pf(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<em;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${em}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),tm(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Hs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Nd;const{data:i,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!i.session)throw new Hs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),ct(i)){const l={session:null,error:i};return tm(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await QT(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Uf(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&la()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Jo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Jo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Jo}ms, refresh threshold is ${Nm} ticks`),a<=Nm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof e2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!la()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,l]=await $o(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await _t(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await _t(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:l,error:c}=await _t(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await _t(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=nm(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+M4>Date.now()))return r;const{data:a,error:i}=await _t(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Lc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(l=>l.kid===e),!r)throw new Lc("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:T,error:E}=await this.getSession();if(E||!T.session)return{data:null,error:E};r=T.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:d}}=nm(r);if(nN(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:T}=await this.getUser(r);if(T)throw T;return{data:{claims:i,header:a,signature:l},error:null}}const f=rN(a.alg),g=await this.fetchJwk(a.kid,n),v=await crypto.subtle.importKey("jwk",g,f,!0,["verify"]);if(!await crypto.subtle.verify(f,v,l,$4(`${c}.${d}`)))throw new Lc("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}}Wc.nextInstanceID=0;const _N=Wc;class wN extends _N{constructor(e){super(e)}}var TN=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class EN{constructor(e,n,r){var a,i,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=C4(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,g={db:v4,realtime:_4,auth:Object.assign(Object.assign({},y4),{storageKey:f}),global:x4},v=A4(r??{},g);this.storageKey=(a=v.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=v.global.headers)!==null&&i!==void 0?i:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=S4(n,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new jk(new URL("rest/v1",d).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),v.accessToken||this._listenForAuthEvents()}get functions(){return new kk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new m4(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return TN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:l,lock:c,debug:d},f,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wN({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new t4(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SN=(t,e,n)=>new EN(t,e,n),bN="https://vohnpmlehdtsijbbyfrj.supabase.co",CN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvaG5wbWxlaGR0c2lqYmJ5ZnJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwMjIwMjEsImV4cCI6MjA2NzU5ODAyMX0.csCXhNXTWJrhnf4T5XtCq9U8KxUziMkM3f8-8ysg0rw",Yt=SN(bN,CN);var ur=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t))(ur||{}),Mm=(t=>(t.PENDING="pending",t.ACHIEVED="achieved",t.MISSED="missed",t))(Mm||{}),Ni=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t.BLOCKED="Blocked",t))(Ni||{}),ba=(t=>(t[t.INPUT_FORM=0]="INPUT_FORM",t[t.PROJECT_FLOW=1]="PROJECT_FLOW",t[t.TASK_DETAIL=2]="TASK_DETAIL",t))(ba||{}),Ot;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const l of a)i[l]=l;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of i)l[c]=a[c];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.push(l);return i},t.find=(a,i)=>{for(const l of a)if(i(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Ot||(Ot={}));var Ty;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Ty||(Ty={}));const $e=Ot.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),zs=t=>{switch(typeof t){case"undefined":return $e.undefined;case"string":return $e.string;case"number":return Number.isNaN(t)?$e.nan:$e.number;case"boolean":return $e.boolean;case"function":return $e.function;case"bigint":return $e.bigint;case"symbol":return $e.symbol;case"object":return Array.isArray(t)?$e.array:t===null?$e.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?$e.promise:typeof Map<"u"&&t instanceof Map?$e.map:typeof Set<"u"&&t instanceof Set?$e.set:typeof Date<"u"&&t instanceof Date?$e.date:$e.object;default:return $e.unknown}},Oe=Ot.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class us extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),r}static assert(e){if(!(e instanceof us))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ot.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];n[i]=n[i]||[],n[i].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}us.create=t=>new us(t);const Im=(t,e)=>{let n;switch(t.code){case Oe.invalid_type:t.received===$e.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Oe.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ot.jsonStringifyReplacer)}`;break;case Oe.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ot.joinValues(t.keys,", ")}`;break;case Oe.invalid_union:n="Invalid input";break;case Oe.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ot.joinValues(t.options)}`;break;case Oe.invalid_enum_value:n=`Invalid enum value. Expected ${Ot.joinValues(t.options)}, received '${t.received}'`;break;case Oe.invalid_arguments:n="Invalid function arguments";break;case Oe.invalid_return_type:n="Invalid function return type";break;case Oe.invalid_date:n="Invalid date";break;case Oe.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ot.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Oe.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Oe.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Oe.custom:n="Invalid input";break;case Oe.invalid_intersection_types:n="Intersection results could not be merged";break;case Oe.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Oe.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ot.assertNever(t)}return{message:n}};let AN=Im;function kN(){return AN}const NN=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],l={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:i,message:c}};function Be(t,e){const n=kN(),r=NN({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Im?void 0:Im].filter(a=>!!a)});t.common.issues.push(r)}class pr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return st;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,l=await a.value;r.push({key:i,value:l})}return pr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:l}=a;if(i.status==="aborted"||l.status==="aborted")return st;i.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[i.value]=l.value)}return{status:e.value,value:r}}}const st=Object.freeze({status:"aborted"}),Cc=t=>({status:"dirty",value:t}),Qr=t=>({status:"valid",value:t}),Ey=t=>t.status==="aborted",Sy=t=>t.status==="dirty",il=t=>t.status==="valid",sd=t=>typeof Promise<"u"&&t instanceof Promise;var He;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(He||(He={}));class Da{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const by=(t,e)=>{if(il(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new us(t.common.issues);return this._error=n,this._error}}};function ht(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??n??c.defaultError}},description:a}}class Ct{get description(){return this._def.description}_getType(e){return zs(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:zs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new pr,ctx:{common:e.parent.common,data:e.data,parsedType:zs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(sd(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zs(e)},a=this._parseSync({data:e,path:r.path,parent:r});return by(r,a)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zs(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return il(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(a=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>il(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zs(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(sd(a)?a:Promise.resolve(a));return by(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const l=e(a),c=()=>i.addIssue({code:Oe.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new cl({schema:this,typeName:at.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ks.create(this,this._def)}nullable(){return ul.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Na.create(this)}promise(){return ud.create(this,this._def)}or(e){return od.create([this,e],this._def)}and(e){return ld.create(this,e,this._def)}transform(e){return new cl({...ht(this._def),schema:this,typeName:at.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Pm({...ht(this._def),innerType:this,defaultValue:n,typeName:at.ZodDefault})}brand(){return new ZN({typeName:at.ZodBranded,type:this,...ht(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Um({...ht(this._def),innerType:this,catchValue:n,typeName:at.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return wp.create(this,e)}readonly(){return Bm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const RN=/^c[^\s-]{8,}$/i,DN=/^[0-9a-z]+$/,MN=/^[0-9A-HJKMNP-TV-Z]{26}$/i,IN=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,FN=/^[a-z0-9_-]{21}$/i,LN=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ON=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,PN=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,UN="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let am;const BN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,VN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,$N=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,HN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,GN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,t2="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",zN=new RegExp(`^${t2}$`);function n2(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function qN(t){return new RegExp(`^${n2(t)}$`)}function YN(t){let e=`${t2}T${n2(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function WN(t,e){return!!((e==="v4"||!e)&&BN.test(t)||(e==="v6"||!e)&&VN.test(t))}function JN(t,e){if(!LN.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function KN(t,e){return!!((e==="v4"||!e)&&jN.test(t)||(e==="v6"||!e)&&$N.test(t))}class Aa extends Ct{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==$e.string){const i=this._getOrReturnCtx(e);return Be(i,{code:Oe.invalid_type,expected:$e.string,received:i.parsedType}),st}const r=new pr;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const l=e.data.length>i.value,c=e.data.length<i.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?Be(a,{code:Oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&Be(a,{code:Oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")PN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"email",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")am||(am=new RegExp(UN,"u")),am.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"emoji",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")IN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"uuid",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")FN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"nanoid",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")RN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"cuid",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")DN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"cuid2",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")MN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"ulid",code:Oe.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Be(a,{validation:"url",code:Oe.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"regex",code:Oe.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?YN(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?zN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?qN(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?ON.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"duration",code:Oe.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?WN(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"ip",code:Oe.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?JN(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"jwt",code:Oe.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?KN(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"cidr",code:Oe.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?HN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"base64",code:Oe.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?GN.test(e.data)||(a=this._getOrReturnCtx(e,a),Be(a,{validation:"base64url",code:Oe.invalid_string,message:i.message}),r.dirty()):Ot.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Oe.invalid_string,...He.errToObj(r)})}_addCheck(e){return new Aa({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...He.errToObj(e)})}url(e){return this._addCheck({kind:"url",...He.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...He.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...He.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...He.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...He.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...He.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...He.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...He.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...He.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...He.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...He.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...He.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...He.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...He.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...He.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...He.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...He.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...He.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...He.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...He.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...He.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...He.errToObj(n)})}nonempty(e){return this.min(1,He.errToObj(e))}trim(){return new Aa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Aa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Aa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Aa.create=t=>new Aa({checks:[],typeName:at.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...ht(t)});function XN(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return i%l/10**a}class Fi extends Ct{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==$e.number){const i=this._getOrReturnCtx(e);return Be(i,{code:Oe.invalid_type,expected:$e.number,received:i.parsedType}),st}let r;const a=new pr;for(const i of this._def.checks)i.kind==="int"?Ot.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?XN(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.not_finite,message:i.message}),a.dirty()):Ot.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,He.toString(n))}gt(e,n){return this.setLimit("min",e,!1,He.toString(n))}lte(e,n){return this.setLimit("max",e,!0,He.toString(n))}lt(e,n){return this.setLimit("max",e,!1,He.toString(n))}setLimit(e,n,r,a){return new Fi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:He.toString(a)}]})}_addCheck(e){return new Fi({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:He.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:He.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:He.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:He.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:He.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:He.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:He.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:He.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:He.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ot.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Fi.create=t=>new Fi({checks:[],typeName:at.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ht(t)});class Li extends Ct{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==$e.bigint)return this._getInvalidInput(e);let r;const a=new pr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Be(r,{code:Oe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Ot.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Be(n,{code:Oe.invalid_type,expected:$e.bigint,received:n.parsedType}),st}gte(e,n){return this.setLimit("min",e,!0,He.toString(n))}gt(e,n){return this.setLimit("min",e,!1,He.toString(n))}lte(e,n){return this.setLimit("max",e,!0,He.toString(n))}lt(e,n){return this.setLimit("max",e,!1,He.toString(n))}setLimit(e,n,r,a){return new Li({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:He.toString(a)}]})}_addCheck(e){return new Li({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:He.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:He.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:He.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:He.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:He.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Li.create=t=>new Li({checks:[],typeName:at.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...ht(t)});class id extends Ct{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==$e.boolean){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.boolean,received:r.parsedType}),st}return Qr(e.data)}}id.create=t=>new id({typeName:at.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ht(t)});class ol extends Ct{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==$e.date){const i=this._getOrReturnCtx(e);return Be(i,{code:Oe.invalid_type,expected:$e.date,received:i.parsedType}),st}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Be(i,{code:Oe.invalid_date}),st}const r=new pr;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),Be(a,{code:Oe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ot.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ol({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:He.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:He.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}ol.create=t=>new ol({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:at.ZodDate,...ht(t)});class Cy extends Ct{_parse(e){if(this._getType(e)!==$e.symbol){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.symbol,received:r.parsedType}),st}return Qr(e.data)}}Cy.create=t=>new Cy({typeName:at.ZodSymbol,...ht(t)});class Ay extends Ct{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.undefined,received:r.parsedType}),st}return Qr(e.data)}}Ay.create=t=>new Ay({typeName:at.ZodUndefined,...ht(t)});class ky extends Ct{_parse(e){if(this._getType(e)!==$e.null){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.null,received:r.parsedType}),st}return Qr(e.data)}}ky.create=t=>new ky({typeName:at.ZodNull,...ht(t)});class Ny extends Ct{constructor(){super(...arguments),this._any=!0}_parse(e){return Qr(e.data)}}Ny.create=t=>new Ny({typeName:at.ZodAny,...ht(t)});class Fm extends Ct{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Qr(e.data)}}Fm.create=t=>new Fm({typeName:at.ZodUnknown,...ht(t)});class ei extends Ct{_parse(e){const n=this._getOrReturnCtx(e);return Be(n,{code:Oe.invalid_type,expected:$e.never,received:n.parsedType}),st}}ei.create=t=>new ei({typeName:at.ZodNever,...ht(t)});class Ry extends Ct{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.void,received:r.parsedType}),st}return Qr(e.data)}}Ry.create=t=>new Ry({typeName:at.ZodVoid,...ht(t)});class Na extends Ct{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==$e.array)return Be(n,{code:Oe.invalid_type,expected:$e.array,received:n.parsedType}),st;if(a.exactLength!==null){const l=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(l||c)&&(Be(n,{code:l?Oe.too_big:Oe.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Be(n,{code:Oe.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Be(n,{code:Oe.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>a.type._parseAsync(new Da(n,l,n.path,c)))).then(l=>pr.mergeArray(r,l));const i=[...n.data].map((l,c)=>a.type._parseSync(new Da(n,l,n.path,c)));return pr.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Na({...this._def,minLength:{value:e,message:He.toString(n)}})}max(e,n){return new Na({...this._def,maxLength:{value:e,message:He.toString(n)}})}length(e,n){return new Na({...this._def,exactLength:{value:e,message:He.toString(n)}})}nonempty(e){return this.min(1,e)}}Na.create=(t,e)=>new Na({type:t,minLength:null,maxLength:null,exactLength:null,typeName:at.ZodArray,...ht(e)});function Ko(t){if(t instanceof An){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ks.create(Ko(r))}return new An({...t._def,shape:()=>e})}else return t instanceof Na?new Na({...t._def,type:Ko(t.element)}):t instanceof Ks?Ks.create(Ko(t.unwrap())):t instanceof ul?ul.create(Ko(t.unwrap())):t instanceof Oi?Oi.create(t.items.map(e=>Ko(e))):t}class An extends Ct{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ot.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==$e.object){const f=this._getOrReturnCtx(e);return Be(f,{code:Oe.invalid_type,expected:$e.object,received:f.parsedType}),st}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof ei&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const g=i[f],v=a.data[f];d.push({key:{status:"valid",value:f},value:g._parse(new Da(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof ei){const f=this._def.unknownKeys;if(f==="passthrough")for(const g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(f==="strict")c.length>0&&(Be(a,{code:Oe.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const g of c){const v=a.data[g];d.push({key:{status:"valid",value:g},value:f._parse(new Da(a,v,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const g of d){const v=await g.key,_=await g.value;f.push({key:v,value:_,alwaysSet:g.alwaysSet})}return f}).then(f=>pr.mergeObjectSync(r,f)):pr.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return He.errToObj,new An({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,l;const a=((l=(i=this._def).errorMap)==null?void 0:l.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:He.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new An({...this._def,unknownKeys:"strip"})}passthrough(){return new An({...this._def,unknownKeys:"passthrough"})}extend(e){return new An({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new An({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:at.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new An({...this._def,catchall:e})}pick(e){const n={};for(const r of Ot.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new An({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Ot.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new An({...this._def,shape:()=>n})}deepPartial(){return Ko(this)}partial(e){const n={};for(const r of Ot.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}return new An({...this._def,shape:()=>n})}required(e){const n={};for(const r of Ot.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ks;)i=i._def.innerType;n[r]=i}return new An({...this._def,shape:()=>n})}keyof(){return r2(Ot.objectKeys(this.shape))}}An.create=(t,e)=>new An({shape:()=>t,unknownKeys:"strip",catchall:ei.create(),typeName:at.ZodObject,...ht(e)});An.strictCreate=(t,e)=>new An({shape:()=>t,unknownKeys:"strict",catchall:ei.create(),typeName:at.ZodObject,...ht(e)});An.lazycreate=(t,e)=>new An({shape:t,unknownKeys:"strip",catchall:ei.create(),typeName:at.ZodObject,...ht(e)});class od extends Ct{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=i.map(c=>new us(c.ctx.common.issues));return Be(n,{code:Oe.invalid_union,unionErrors:l}),st}if(n.common.async)return Promise.all(r.map(async i=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(a);{let i;const l=[];for(const d of r){const f={...n,common:{...n.common,issues:[]},parent:null},g=d._parseSync({data:n.data,path:n.path,parent:f});if(g.status==="valid")return g;g.status==="dirty"&&!i&&(i={result:g,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=l.map(d=>new us(d));return Be(n,{code:Oe.invalid_union,unionErrors:c}),st}}get options(){return this._def.options}}od.create=(t,e)=>new od({options:t,typeName:at.ZodUnion,...ht(e)});function Lm(t,e){const n=zs(t),r=zs(e);if(t===e)return{valid:!0,data:t};if(n===$e.object&&r===$e.object){const a=Ot.objectKeys(e),i=Ot.objectKeys(t).filter(c=>a.indexOf(c)!==-1),l={...t,...e};for(const c of i){const d=Lm(t[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(n===$e.array&&r===$e.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const l=t[i],c=e[i],d=Lm(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===$e.date&&r===$e.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ld extends Ct{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,l)=>{if(Ey(i)||Ey(l))return st;const c=Lm(i.value,l.value);return c.valid?((Sy(i)||Sy(l))&&n.dirty(),{status:n.value,value:c.data}):(Be(r,{code:Oe.invalid_intersection_types}),st)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,l])=>a(i,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ld.create=(t,e,n)=>new ld({left:t,right:e,typeName:at.ZodIntersection,...ht(n)});class Oi extends Ct{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.array)return Be(r,{code:Oe.invalid_type,expected:$e.array,received:r.parsedType}),st;if(r.data.length<this._def.items.length)return Be(r,{code:Oe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),st;!this._def.rest&&r.data.length>this._def.items.length&&(Be(r,{code:Oe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Da(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(i).then(l=>pr.mergeArray(n,l)):pr.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Oi({...this._def,rest:e})}}Oi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Oi({items:t,typeName:at.ZodTuple,rest:null,...ht(e)})};class cd extends Ct{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.object)return Be(r,{code:Oe.invalid_type,expected:$e.object,received:r.parsedType}),st;const a=[],i=this._def.keyType,l=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new Da(r,c,r.path,c)),value:l._parse(new Da(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?pr.mergeObjectAsync(n,a):pr.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Ct?new cd({keyType:e,valueType:n,typeName:at.ZodRecord,...ht(r)}):new cd({keyType:Aa.create(),valueType:e,typeName:at.ZodRecord,...ht(n)})}}class Dy extends Ct{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.map)return Be(r,{code:Oe.invalid_type,expected:$e.map,received:r.parsedType}),st;const a=this._def.keyType,i=this._def.valueType,l=[...r.data.entries()].map(([c,d],f)=>({key:a._parse(new Da(r,c,r.path,[f,"key"])),value:i._parse(new Da(r,d,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,g=await d.value;if(f.status==="aborted"||g.status==="aborted")return st;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,g=d.value;if(f.status==="aborted"||g.status==="aborted")return st;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}}}}Dy.create=(t,e,n)=>new Dy({valueType:e,keyType:t,typeName:at.ZodMap,...ht(n)});class Jc extends Ct{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.set)return Be(r,{code:Oe.invalid_type,expected:$e.set,received:r.parsedType}),st;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Be(r,{code:Oe.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Be(r,{code:Oe.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function l(d){const f=new Set;for(const g of d){if(g.status==="aborted")return st;g.status==="dirty"&&n.dirty(),f.add(g.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((d,f)=>i._parse(new Da(r,d,r.path,f)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,n){return new Jc({...this._def,minSize:{value:e,message:He.toString(n)}})}max(e,n){return new Jc({...this._def,maxSize:{value:e,message:He.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Jc.create=(t,e)=>new Jc({valueType:t,minSize:null,maxSize:null,typeName:at.ZodSet,...ht(e)});class Om extends Ct{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Om.create=(t,e)=>new Om({getter:t,typeName:at.ZodLazy,...ht(e)});class My extends Ct{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Be(n,{received:n.data,code:Oe.invalid_literal,expected:this._def.value}),st}return{status:"valid",value:e.data}}get value(){return this._def.value}}My.create=(t,e)=>new My({value:t,typeName:at.ZodLiteral,...ht(e)});function r2(t,e){return new ll({values:t,typeName:at.ZodEnum,...ht(e)})}class ll extends Ct{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Be(n,{expected:Ot.joinValues(r),received:n.parsedType,code:Oe.invalid_type}),st}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Be(n,{received:n.data,code:Oe.invalid_enum_value,options:r}),st}return Qr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return ll.create(e,{...this._def,...n})}exclude(e,n=this._def){return ll.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}ll.create=r2;class Iy extends Ct{_parse(e){const n=Ot.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==$e.string&&r.parsedType!==$e.number){const a=Ot.objectValues(n);return Be(r,{expected:Ot.joinValues(a),received:r.parsedType,code:Oe.invalid_type}),st}if(this._cache||(this._cache=new Set(Ot.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=Ot.objectValues(n);return Be(r,{received:r.data,code:Oe.invalid_enum_value,options:a}),st}return Qr(e.data)}get enum(){return this._def.values}}Iy.create=(t,e)=>new Iy({values:t,typeName:at.ZodNativeEnum,...ht(e)});class ud extends Ct{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==$e.promise&&n.common.async===!1)return Be(n,{code:Oe.invalid_type,expected:$e.promise,received:n.parsedType}),st;const r=n.parsedType===$e.promise?n.data:Promise.resolve(n.data);return Qr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}ud.create=(t,e)=>new ud({type:t,typeName:at.ZodPromise,...ht(e)});class cl extends Ct{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===at.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:l=>{Be(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const l=a.transform(r.data,i);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return st;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?st:d.status==="dirty"||n.value==="dirty"?Cc(d.value):d});{if(n.value==="aborted")return st;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?st:c.status==="dirty"||n.value==="dirty"?Cc(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?st:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?st:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!il(l))return st;const c=a.transform(l.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>il(l)?Promise.resolve(a.transform(l.value,i)).then(c=>({status:n.value,value:c})):st);Ot.assertNever(a)}}cl.create=(t,e,n)=>new cl({schema:t,typeName:at.ZodEffects,effect:e,...ht(n)});cl.createWithPreprocess=(t,e,n)=>new cl({schema:e,effect:{type:"preprocess",transform:t},typeName:at.ZodEffects,...ht(n)});class Ks extends Ct{_parse(e){return this._getType(e)===$e.undefined?Qr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ks.create=(t,e)=>new Ks({innerType:t,typeName:at.ZodOptional,...ht(e)});class ul extends Ct{_parse(e){return this._getType(e)===$e.null?Qr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ul.create=(t,e)=>new ul({innerType:t,typeName:at.ZodNullable,...ht(e)});class Pm extends Ct{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===$e.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pm.create=(t,e)=>new Pm({innerType:t,typeName:at.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ht(e)});class Um extends Ct{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return sd(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new us(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new us(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Um.create=(t,e)=>new Um({innerType:t,typeName:at.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ht(e)});class Fy extends Ct{_parse(e){if(this._getType(e)!==$e.nan){const r=this._getOrReturnCtx(e);return Be(r,{code:Oe.invalid_type,expected:$e.nan,received:r.parsedType}),st}return{status:"valid",value:e.data}}}Fy.create=t=>new Fy({typeName:at.ZodNaN,...ht(t)});class ZN extends Ct{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class wp extends Ct{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?st:i.status==="dirty"?(n.dirty(),Cc(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?st:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new wp({in:e,out:n,typeName:at.ZodPipeline})}}class Bm extends Ct{_parse(e){const n=this._def.innerType._parse(e),r=a=>(il(a)&&(a.value=Object.freeze(a.value)),a);return sd(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Bm.create=(t,e)=>new Bm({innerType:t,typeName:at.ZodReadonly,...ht(e)});var at;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(at||(at={}));const bi=Aa.create,Ly=Fi.create;Li.create;const QN=id.create;ol.create;const Oy=Fm.create;ei.create;const Ac=Na.create,eR=An.create,tR=od.create;ld.create;Oi.create;const nR=cd.create,rR=Om.create,aR=ll.create;ud.create;Ks.create;ul.create;const zo={string:t=>Aa.create({...t,coerce:!0}),number:t=>Fi.create({...t,coerce:!0}),boolean:t=>id.create({...t,coerce:!0}),bigint:t=>Li.create({...t,coerce:!0}),date:t=>ol.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sR,iR;function oR(){return{geminiUrl:sR,vertexUrl:iR}}function lR(t,e,n){var r,a,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=oR();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(i=l.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qi{}function ze(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];return i!=null?String(i):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let i=0;i<e.length-1;i++){const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const d=t[c];if(Array.isArray(n))for(let f=0;f<d.length;f++){const g=d[f];m(g,e.slice(i+1),n[f])}else for(const f of d)m(f,e.slice(i+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const d=t[c];m(d[0],e.slice(i+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const i=t[a];return Array.isArray(i)?i.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Py;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Py||(Py={}));var Uy;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Uy||(Uy={}));var ka;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(ka||(ka={}));var By;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(By||(By={}));var jy;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(jy||(jy={}));var Vy;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Vy||(Vy={}));var $y;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})($y||($y={}));var Hy;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Hy||(Hy={}));var Gy;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Gy||(Gy={}));var zy;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(zy||(zy={}));var qy;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(qy||(qy={}));var Yy;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Yy||(Yy={}));var Wy;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Wy||(Wy={}));var Jy;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Jy||(Jy={}));var Ky;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Ky||(Ky={}));var Xy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Xy||(Xy={}));var fd;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(fd||(fd={}));var Zy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Zy||(Zy={}));var jm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(jm||(jm={}));var Qy;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Qy||(Qy={}));var e_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(e_||(e_={}));var t_;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(t_||(t_={}));var n_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(n_||(n_={}));var r_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(r_||(r_={}));var a_;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(a_||(a_={}));var s_;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(s_||(s_={}));var i_;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(i_||(i_={}));var o_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(o_||(o_={}));var l_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(l_||(l_={}));var c_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(c_||(c_={}));var u_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(u_||(u_={}));var f_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(f_||(f_={}));var d_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(d_||(d_={}));var h_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(h_||(h_={}));var m_;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(m_||(m_={}));var p_;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(p_||(p_={}));var g_;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(g_||(g_={}));var x_;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(x_||(x_={}));var v_;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(v_||(v_={}));var y_;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(y_||(y_={}));var __;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(__||(__={}));var Zo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Zo||(Zo={}));class Vm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Sc{get text(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const v=[];for(const _ of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[T,E]of Object.entries(_))T!=="text"&&T!=="thought"&&(E!==null||E!==void 0)&&v.push(T);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,f+=_.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const v of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,T]of Object.entries(v))_!=="inlineData"&&(T!==null||T!==void 0)&&g.push(_);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class w_{}class T_{}class cR{}class uR{}class E_{}class S_{}class b_{}class fR{}class C_{}class A_{}class k_{}class dR{}class hR{}class mR{}class N_{}class pR{get text(){var e,n,r;let a="",i=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;i=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?a:void 0}get data(){var e,n,r;let a="";const i=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&i.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class gR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vt(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function a2(t,e){const n=Vt(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function s2(t){return Array.isArray(t)?t.map(e=>dd(e)):[dd(t)]}function dd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function i2(t){const e=dd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function o2(t){const e=dd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function R_(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function l2(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>R_(e)):[R_(t)]}function $m(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function D_(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function M_(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function rr(t){if(t==null)throw new Error("ContentUnion is required");return $m(t)?t:{role:"user",parts:l2(t)}}function c2(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=rr(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=rr(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>rr(n)):[rr(e)]}function Xr(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(D_(t)||M_(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[rr(t)]}const e=[],n=[],r=$m(t[0]);for(const a of t){const i=$m(a);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(a);else{if(D_(a)||M_(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:l2(n)}),e}const xR=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),I_=aR(["string","number","integer","object","array","boolean","null"]),vR=tR([I_,Ac(I_)]);function yR(t=!0){const e=rR(()=>{const n=eR({type:vR.optional(),format:bi().optional(),title:bi().optional(),description:bi().optional(),default:Oy().optional(),items:e.optional(),minItems:zo.string().optional(),maxItems:zo.string().optional(),enum:Ac(Oy()).optional(),properties:nR(bi(),e).optional(),required:Ac(bi()).optional(),minProperties:zo.string().optional(),maxProperties:zo.string().optional(),propertyOrdering:Ac(bi()).optional(),minimum:Ly().optional(),maximum:Ly().optional(),minLength:zo.string().optional(),maxLength:zo.string().optional(),pattern:bi().optional(),anyOf:Ac(e).optional(),additionalProperties:QN().optional()});return t?n.strict():n});return e}function _R(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(ka).includes(n[0].toUpperCase())?n[0].toUpperCase():ka.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(ka).includes(r.toUpperCase())?r.toUpperCase():ka.TYPE_UNSPECIFIED})}}function el(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&_R(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(ka).includes(c.toUpperCase())?c.toUpperCase():ka.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=el(c);else if(r.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push(el(f))}e[l]=d}else if(a.includes(l)){const d={};for(const[f,g]of Object.entries(c))d[f]=el(g);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Kc(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=yR().parse(t);return el(e)}else return el(t)}function Tp(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Ep(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function xl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Kc(e.parameters)),e.response&&(e.response=Kc(e.response));return t}function vl(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function wR(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function ds(t,e){if(typeof e!="string")throw new Error("name must be a string");return wR(t,e,"cachedContents")}function u2(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function hs(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function TR(t){return t!=null&&typeof t=="object"&&"name"in t}function ER(t){return t!=null&&typeof t=="object"&&"video"in t}function SR(t){return t!=null&&typeof t=="object"&&"uri"in t}function f2(t){var e;let n;if(TR(t)&&(n=t.name),!(SR(t)&&(n=t.uri,n===void 0))&&!(ER(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function d2(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function h2(t){for(const e of["models","tunedModels","publisherModels"])if(bR(t,e))return t[e];return[]}function bR(t,e){return t!==null&&typeof t=="object"&&e in t}function CR(t,e={}){const n=t,r={name:n.name,description:n.description,parameters:el(Rd(n.inputSchema))};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function AR(t,e={}){const n=[],r=new Set;for(const a of t){const i=a.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const l=CR(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function kR(t){const e=[];for(const n of t)e.push(Rd(n));return e}function NR(t){const e={};for(const[n,r]of Object.entries(t)){const a=r;e[n]=Rd(a)}return e}function Rd(t){const e=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[i,l]of Object.entries(t))if(e.has(i))a[i]=Rd(l);else if(n.has(i))a[i]=kR(l);else if(r.has(i))a[i]=NR(l);else if(i==="type"){const c=l.toUpperCase();a[i]=Object.values(ka).includes(c)?c:ka.TYPE_UNSPECIFIED}else xR.has(i)&&(a[i]=l);return a}function m2(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function RR(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function yl(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function p2(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DR(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function MR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function IR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function FR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],DR(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],MR(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],IR(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function g2(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>FR(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function LR(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const M=h(t,["propertyOrdering"]);M!=null&&m(e,["propertyOrdering"],M);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function OR(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function PR(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function UR(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function BR(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],UR(n)),e}function jR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function VR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],jR(n)),e}function $R(){return{}}function HR(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>PR(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],BR(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],VR(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],$R());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function GR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function zR(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function qR(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],zR(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function YR(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],GR(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],qR(r)),e}function WR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function x2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],WR(n)),e}function JR(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],x2(r)),e}function KR(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>JR(a))),m(e,["speakerVoiceConfigs"],r)}return e}function XR(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],x2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],KR(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function ZR(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function QR(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],g2(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],LR(Kc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let G=C;Array.isArray(G)&&(G=G.map(te=>OR(te))),m(n,["safetySettings"],G)}const M=h(e,["tools"]);if(n!==void 0&&M!=null){let G=vl(M);Array.isArray(G)&&(G=G.map(te=>HR(xl(te)))),m(n,["tools"],G)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],YR(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);n!==void 0&&H!=null&&m(n,["cachedContent"],ds(t,H));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],XR(Tp(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ae=h(e,["thinkingConfig"]);return ae!=null&&m(r,["thinkingConfig"],ZR(ae)),r}function e3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>g2(c))),m(n,["request","contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["request","generationConfig"],QR(t,i,n)),n}function t3(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>e3(t,l))),m(n,["requests","requests"],i)}return n}function n3(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function r3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],t3(t,m2(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],n3(i,n)),n}function a3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function s3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function i3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function o3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],i3(n,e)),e}function l3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function c3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function u3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function f3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],u3(RR(a))),n}function d3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],Vt(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],c3(m2(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],f3(i,n)),n}function h3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function m3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function p3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function g3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],p3(n,e)),e}function x3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],yl(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function v2(){return{}}function v3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function y3(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function _3(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function w3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],v3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],y3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],_3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function T3(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>w3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function E3(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function S3(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function b3(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>S3(a))),m(e,["urlMetadata"],r)}return e}function C3(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],T3(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],E3(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],b3(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function A3(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>C3(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function k3(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],A3(n)),h(t,["error"])!=null&&m(e,["error"],v2()),e}function N3(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>k3(i))),m(e,["inlinedResponses"],a)}return e}function Hm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],p2(a));const i=h(t,["metadata","createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["metadata","model"]);d!=null&&m(e,["model"],d);const f=h(t,["metadata","output"]);return f!=null&&m(e,["dest"],N3(f)),e}function R3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Hm(i))),m(e,["batchJobs"],a)}return e}function D3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],v2()),e}function y2(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function M3(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function I3(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function Gm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],p2(a));const i=h(t,["error"]);i!=null&&m(e,["error"],y2(i));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const d=h(t,["endTime"]);d!=null&&m(e,["endTime"],d);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const v=h(t,["inputConfig"]);v!=null&&m(e,["src"],M3(v));const _=h(t,["outputConfig"]);return _!=null&&m(e,["dest"],I3(_)),e}function F3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Gm(i))),m(e,["batchJobs"],a)}return e}function L3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],y2(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Pi;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Pi||(Pi={}));class mu{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(i=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O3 extends qi{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new mu(Pi.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=d3(this.apiClient,e);return c=ze("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Gm(g))}else{const f=r3(this.apiClient,e);return c=ze("{model}:batchGenerateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Hm(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=h3(this.apiClient,e);return c=ze("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Gm(g))}else{const f=a3(this.apiClient,e);return c=ze("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Hm(g))}}async cancel(e){var n,r,a,i;let l="",c={};if(this.apiClient.isVertexAI()){const d=m3(this.apiClient,e);l=ze("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=s3(this.apiClient,e);l=ze("batches/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=g3(e);return c=ze("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=F3(g),_=new N_;return Object.assign(_,v),_})}else{const f=o3(e);return c=ze("batches",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=R3(g),_=new N_;return Object.assign(_,v),_})}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=x3(this.apiClient,e);return c=ze("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>L3(g))}else{const f=l3(this.apiClient,e);return c=ze("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>D3(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function U3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function B3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function j3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],P3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],U3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],B3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function F_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>j3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function V3(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function $3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function H3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],$3(n)),e}function G3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function z3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],G3(n)),e}function q3(){return{}}function Y3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>V3(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],H3(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],z3(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],q3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function W3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function J3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function K3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],J3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function X3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],W3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],K3(r)),e}function Z3(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=Xr(l);Array.isArray(g)&&(g=g.map(v=>F_(v))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],F_(rr(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>Y3(v))),m(e,["tools"],g)}const f=h(t,["toolConfig"]);if(e!==void 0&&f!=null&&m(e,["toolConfig"],X3(f)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Q3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],a2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Z3(a,n)),n}function e5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function t5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function n5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function r5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],n5(a,n)),n}function a5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function s5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],a5(n,e)),e}function i5(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function o5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function l5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function c5(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],i5(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],o5(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],l5(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function L_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>c5(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function u5(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function f5(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function d5(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],f5(n)),e}function h5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function m5(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],h5(n)),e}function p5(){return{}}function g5(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function x5(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],g5(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function v5(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],x5(n)),e}function y5(){return{}}function _5(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>u5(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],d5(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],m5(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],p5());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],v5(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],y5());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function w5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function T5(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function E5(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],T5(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function S5(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],w5(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],E5(r)),e}function b5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let v=Xr(l);Array.isArray(v)&&(v=v.map(_=>L_(_))),m(e,["contents"],v)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],L_(rr(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>_5(_))),m(e,["tools"],v)}const f=h(t,["toolConfig"]);e!==void 0&&f!=null&&m(e,["toolConfig"],S5(f));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function C5(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],a2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],b5(a,n)),n}function A5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function k5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function N5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function R5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ds(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],N5(a,n)),n}function D5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function M5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],D5(n,e)),e}function Qf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function I5(){return{}}function F5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Qf(i))),m(e,["cachedContents"],a)}return e}function ed(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function L5(){return{}}function O5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>ed(i))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class P5 extends qi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mu(Pi.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=C5(this.apiClient,e);return c=ze("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}else{const f=Q3(this.apiClient,e);return c=ze("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Qf(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=A5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}else{const f=e5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Qf(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=k5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=L5(),v=new A_;return Object.assign(v,g),v})}else{const f=t5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=I5(),v=new A_;return Object.assign(v,g),v})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=R5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}else{const f=r5(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Qf(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=M5(e);return c=ze("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=O5(g),_=new k_;return Object.assign(_,v),_})}else{const f=s5(e);return c=ze("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=F5(g),_=new k_;return Object.assign(_,v),_})}}}function O_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qt(t){return this instanceof Qt?(this.v=t,this):new Qt(t)}function tl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(T){return function(E){return Promise.resolve(E).then(T,v)}}function c(T,E){r[T]&&(a[T]=function(S){return new Promise(function(b,k){i.push([T,S,b,k])>1||d(T,S)})},E&&(a[T]=E(a[T])))}function d(T,E){try{f(r[T](E))}catch(S){_(i[0][3],S)}}function f(T){T.value instanceof Qt?Promise.resolve(T.value.v).then(g,v):_(i[0][2],T)}function g(T){d("next",T)}function v(T){d("throw",T)}function _(T,E){T(E),i.shift(),i.length&&d(i[0][0],i[0][1])}}function Pc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof O_=="function"?O_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(l){return new Promise(function(c,d){l=t[i](l),a(c,d,l.done,l.value)})}}function a(i,l,c,d){Promise.resolve(d).then(function(f){i({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function U5(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:_2(n)}function _2(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function B5(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function P_(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let i=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),i&&!_2(t[r])&&(i=!1),r++;i?e.push(...a):e.pop()}return e}class j5{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new V5(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class V5{constructor(e,n,r,a={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=i,this.sendPromise=Promise.resolve(),B5(i)}async sendMessage(e){var n;await this.sendPromise;const r=rr(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,l,c;const d=await a,f=(l=(i=d.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content,g=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let _=[];g!=null&&(_=(c=g.slice(v))!==null&&c!==void 0?c:[]);const T=f?[f]:[];this.recordHistory(r,T,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=rr(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const i=await a;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?P_(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return tl(this,arguments,function*(){var l,c,d,f;const g=[];try{for(var v=!0,_=Pc(e),T;T=yield Qt(_.next()),l=T.done,!l;v=!0){f=T.value,v=!1;const E=f;if(U5(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield Qt(E)}}catch(E){c={error:E}}finally{try{!v&&!l&&(d=_.return)&&(yield Qt(d.call(_)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(i=>i.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...P_(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Dd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function H5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],$5(n,e)),e}function G5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function z5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],G5(S)),e}function q5(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],z5(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function Y5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],f2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function W5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],f2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function J5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function zm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],J5(S)),e}function K5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>zm(i))),m(e,["files"],a)}return e}function X5(){return{}}function Z5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Q5 extends qi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mu(Pi.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>zm(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=H5(e);return i=ze("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=K5(d),g=new dR;return Object.assign(g,f),g})}}async createInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=q5(e);return i=ze("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=X5(),f=new hR;return Object.assign(f,d),f})}}async get(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Y5(e);return i=ze("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>zm(d))}}async delete(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=W5(e);return i=ze("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=Z5(),f=new mR;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function tD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function w2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],eD(n)),e}function nD(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],tD(n)),e}function rD(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],w2(r)),e}function aD(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>rD(a))),m(e,["speakerVoiceConfigs"],r)}return e}function sD(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],w2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],aD(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function iD(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],nD(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function oD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function lD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function cD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function uD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function fD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function dD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function hD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],oD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],cD(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],fD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function mD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],lD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],uD(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],dD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function pD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>hD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function gD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>mD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function xD(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function vD(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function yD(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function _D(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function wD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],yD(n)),e}function TD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],_D(n)),e}function ED(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function SD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function bD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],ED(n)),e}function CD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],SD(n)),e}function AD(){return{}}function kD(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function ND(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],kD(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function RD(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],ND(n)),e}function DD(){return{}}function MD(){return{}}function ID(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>xD(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],wD(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],bD(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],DD());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function FD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>vD(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],TD(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],CD(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],AD());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],RD(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],MD());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function LD(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function OD(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function U_(){return{}}function B_(){return{}}function PD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function UD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function BD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],PD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function jD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],UD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function VD(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function $D(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function HD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],VD(r)),e}function GD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],$D(r)),e}function zD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function qD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function YD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],sD(Ep(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],pD(rr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=vl(E);Array.isArray(B)&&(B=B.map(H=>ID(xl(H)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],LD(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],U_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],U_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],BD(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],HD(C));const M=h(t,["proactivity"]);return e!==void 0&&M!=null&&m(e,["setup","proactivity"],zD(M)),n}function WD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],iD(Ep(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],gD(rr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=vl(E);Array.isArray(B)&&(B=B.map(H=>FD(xl(H)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],OD(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],B_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],B_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],jD(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],GD(C));const M=h(t,["proactivity"]);return e!==void 0&&M!=null&&m(e,["setup","proactivity"],qD(M)),n}function JD(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],YD(a,n)),n}function KD(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],WD(a,n)),n}function XD(){return{}}function ZD(){return{}}function QD(){return{}}function eM(){return{}}function tM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],s2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],o2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],i2(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],XD()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],QD()),e}function nM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],s2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],o2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],i2(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],ZD()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],eM()),e}function T2(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function rM(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>T2(a))),m(e,["weightedPrompts"],r)}return e}function E2(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function aM(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],E2(n)),e}function S2(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function b2(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>T2(a))),m(e,["weightedPrompts"],r)}return e}function qm(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],S2(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],b2(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],E2(a));const i=h(t,["playbackControl"]);return i!=null&&m(e,["playbackControl"],i),e}function sM(){return{}}function iM(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function oM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function lM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function cM(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function uM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function fM(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function dM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function hM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],oM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],cM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],fM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function mM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],lM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],uM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],dM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function pM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>hM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function gM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>mM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function j_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function V_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function xM(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function vM(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>xM(a))),m(e,["urlMetadata"],r)}return e}function yM(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],pM(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],j_(c));const d=h(t,["outputTranscription"]);d!=null&&m(e,["outputTranscription"],j_(d));const f=h(t,["urlContextMetadata"]);return f!=null&&m(e,["urlContextMetadata"],vM(f)),e}function _M(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],gM(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],V_(c));const d=h(t,["outputTranscription"]);return d!=null&&m(e,["outputTranscription"],V_(d)),e}function wM(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function TM(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function EM(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>wM(a))),m(e,["functionCalls"],r)}return e}function SM(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>TM(a))),m(e,["functionCalls"],r)}return e}function bM(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function CM(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function Bf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function jf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function AM(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(T=>Bf(T))),m(e,["promptTokensDetails"],_)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>Bf(T))),m(e,["cacheTokensDetails"],_)}const g=h(t,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(T=>Bf(T))),m(e,["responseTokensDetails"],_)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let _=v;Array.isArray(_)&&(_=_.map(T=>Bf(T))),m(e,["toolUsePromptTokensDetails"],_)}return e}function kM(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(E=>jf(E))),m(e,["promptTokensDetails"],T)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(E=>jf(E))),m(e,["cacheTokensDetails"],T)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>jf(E))),m(e,["responseTokensDetails"],T)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(E=>jf(E))),m(e,["toolUsePromptTokensDetails"],T)}const _=h(t,["trafficType"]);return _!=null&&m(e,["trafficType"],_),e}function NM(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function RM(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function DM(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function MM(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function IM(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],sM());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],yM(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],EM(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],bM(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],AM(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],NM(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],DM(d)),e}function FM(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],iM(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],_M(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],SM(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],CM(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],kM(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],RM(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],MM(d)),e}function LM(){return{}}function OM(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function PM(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>OM(a))),m(e,["weightedPrompts"],r)}return e}function UM(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function BM(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],PM(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],UM(r)),e}function jM(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],BM(a)),e}function VM(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jM(a))),m(e,["audioChunks"],r)}return e}function $M(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function HM(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],LM());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],VM(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],$M(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function zM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function qM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function YM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],GM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],zM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],qM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function Md(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>YM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function WM(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const M=h(t,["propertyOrdering"]);M!=null&&m(e,["propertyOrdering"],M);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function JM(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function KM(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function XM(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function ZM(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],XM(n)),e}function QM(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function eI(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],QM(n)),e}function tI(){return{}}function nI(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>KM(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],ZM(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],eI(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],tI());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function rI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function aI(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function sI(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],aI(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function iI(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],rI(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],sI(r)),e}function oI(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function C2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],oI(n)),e}function lI(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],C2(r)),e}function cI(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>lI(a))),m(e,["speakerVoiceConfigs"],r)}return e}function uI(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],C2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],cI(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function fI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function dI(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],Md(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],WM(Kc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let G=C;Array.isArray(G)&&(G=G.map(te=>JM(te))),m(n,["safetySettings"],G)}const M=h(e,["tools"]);if(n!==void 0&&M!=null){let G=vl(M);Array.isArray(G)&&(G=G.map(te=>nI(xl(te)))),m(n,["tools"],G)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],iI(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);n!==void 0&&H!=null&&m(n,["cachedContent"],ds(t,H));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],uI(Tp(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ae=h(e,["thinkingConfig"]);return ae!=null&&m(r,["thinkingConfig"],fI(ae)),r}function $_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>Md(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],dI(t,i,n)),n}function hI(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const i=h(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&m(e,["requests[]","outputDimensionality"],i),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function mI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],c2(t,a));const i=h(e,["config"]);i!=null&&m(n,["config"],hI(i,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],Vt(t,l)),n}function pI(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const i=h(t,["guidanceScale"]);if(e!==void 0&&i!=null&&m(e,["parameters","guidanceScale"],i),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const d=h(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&m(e,["parameters","includeSafetyAttributes"],d);const f=h(t,["includeRaiReason"]);e!==void 0&&f!=null&&m(e,["parameters","includeRaiReason"],f);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const v=h(t,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const _=h(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function gI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],pI(i,n)),n}function xI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function vI(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],d2(t,c)),r}function yI(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],vI(t,r,n)),n}function _I(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function wI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],_I(a,n)),n}function TI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function EI(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function SI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>Md(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],EI(i)),n}function bI(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],hs(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function CI(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=h(t,["aspectRatio"]);if(e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const d=h(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function AI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);if(i!=null&&m(n,["instances[0]","image"],bI(i)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],CI(l,n)),n}function kI(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function NI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function RI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function DI(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],kI(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],NI(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],RI(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function _l(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>DI(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function MI(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const M=h(t,["propertyOrdering"]);M!=null&&m(e,["propertyOrdering"],M);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function II(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function FI(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function LI(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function OI(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function PI(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],OI(n)),e}function UI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function BI(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],UI(n)),e}function jI(){return{}}function VI(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function $I(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],VI(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function HI(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],$I(n)),e}function GI(){return{}}function A2(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>LI(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],PI(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],BI(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],jI());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],HI(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],GI());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function zI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function qI(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function YI(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],qI(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function WI(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],zI(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],YI(r)),e}function JI(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function KI(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],JI(n)),e}function XI(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],KI(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function ZI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function QI(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],_l(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],MI(Kc(k)));const A=h(e,["responseJsonSchema"]);A!=null&&m(r,["responseJsonSchema"],A);const C=h(e,["routingConfig"]);C!=null&&m(r,["routingConfig"],C);const M=h(e,["modelSelectionConfig"]);M!=null&&m(r,["modelConfig"],II(M));const B=h(e,["safetySettings"]);if(n!==void 0&&B!=null){let ye=B;Array.isArray(ye)&&(ye=ye.map(se=>FI(se))),m(n,["safetySettings"],ye)}const H=h(e,["tools"]);if(n!==void 0&&H!=null){let ye=vl(H);Array.isArray(ye)&&(ye=ye.map(se=>A2(xl(se)))),m(n,["tools"],ye)}const F=h(e,["toolConfig"]);n!==void 0&&F!=null&&m(n,["toolConfig"],WI(F));const K=h(e,["labels"]);n!==void 0&&K!=null&&m(n,["labels"],K);const P=h(e,["cachedContent"]);n!==void 0&&P!=null&&m(n,["cachedContent"],ds(t,P));const ae=h(e,["responseModalities"]);ae!=null&&m(r,["responseModalities"],ae);const G=h(e,["mediaResolution"]);G!=null&&m(r,["mediaResolution"],G);const te=h(e,["speechConfig"]);te!=null&&m(r,["speechConfig"],XI(Tp(te)));const we=h(e,["audioTimestamp"]);we!=null&&m(r,["audioTimestamp"],we);const Re=h(e,["thinkingConfig"]);return Re!=null&&m(r,["thinkingConfig"],ZI(Re)),r}function H_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>_l(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],QI(t,i,n)),n}function e6(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const i=h(t,["outputDimensionality"]);e!==void 0&&i!=null&&m(e,["parameters","outputDimensionality"],i);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function t6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],c2(t,a));const i=h(e,["config"]);return i!=null&&m(n,["config"],e6(i,n)),n}function n6(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["addWatermark"]);e!==void 0&&b!=null&&m(e,["parameters","addWatermark"],b);const k=h(t,["enhancePrompt"]);return e!==void 0&&k!=null&&m(e,["parameters","enhancePrompt"],k),n}function r6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],n6(i,n)),n}function Id(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],hs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function a6(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function s6(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function i6(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function o6(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function l6(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],Id(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const i=h(t,["maskImageConfig"]);i!=null&&m(e,["maskImageConfig"],a6(i));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],s6(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],i6(c));const d=h(t,["subjectImageConfig"]);return d!=null&&m(e,["subjectImageConfig"],o6(d)),e}function c6(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["editMode"]);e!==void 0&&b!=null&&m(e,["parameters","editMode"],b);const k=h(t,["baseSteps"]);return e!==void 0&&k!=null&&m(e,["parameters","editConfig","baseSteps"],k),n}function u6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["referenceImages"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>l6(d))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],c6(l,n)),n}function f6(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const i=h(t,["outputCompressionQuality"]);e!==void 0&&i!=null&&m(e,["parameters","outputOptions","compressionQuality"],i);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=h(t,["numberOfImages"]);e!==void 0&&d!=null&&m(e,["parameters","sampleCount"],d);const f=h(t,["mode"]);return e!==void 0&&f!=null&&m(e,["parameters","mode"],f),n}function d6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],Id(a));const i=h(e,["upscaleFactor"]);i!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],i);const l=h(e,["config"]);return l!=null&&m(n,["config"],f6(l,n)),n}function h6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function m6(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],d2(t,c)),r}function p6(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],m6(t,r,n)),n}function g6(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function x6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],g6(a,n)),n}function v6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function y6(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],_l(rr(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>A2(c))),m(e,["tools"],l)}const i=h(t,["generationConfig"]);return e!==void 0&&i!=null&&m(e,["generationConfig"],i),n}function _6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>_l(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],y6(i,n)),n}function w6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["contents"]);if(a!=null){let l=Xr(a);Array.isArray(l)&&(l=l.map(c=>_l(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],i),n}function T6(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],hs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function E6(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const i=h(t,["fps"]);e!==void 0&&i!=null&&m(e,["parameters","fps"],i);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const d=h(t,["aspectRatio"]);e!==void 0&&d!=null&&m(e,["parameters","aspectRatio"],d);const f=h(t,["resolution"]);e!==void 0&&f!=null&&m(e,["parameters","resolution"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["pubsubTopic"]);e!==void 0&&v!=null&&m(e,["parameters","pubsubTopic"],v);const _=h(t,["negativePrompt"]);e!==void 0&&_!=null&&m(e,["parameters","negativePrompt"],_);const T=h(t,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],Id(S));const b=h(t,["compressionQuality"]);return e!==void 0&&b!=null&&m(e,["parameters","compressionQuality"],b),n}function S6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Vt(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);i!=null&&m(n,["instances[0]","image"],Id(i));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],T6(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],E6(c,n)),n}function b6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function C6(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function A6(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function k6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],b6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],C6(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],A6(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function N6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>k6(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function R6(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function D6(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function M6(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>D6(a))),m(e,["urlMetadata"],r)}return e}function I6(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],N6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],R6(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],M6(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function G_(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>I6(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function F6(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function L6(){return{}}function O6(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>F6(i))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],L6()),e}function P6(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],hs(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function k2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function U6(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],P6(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],k2(a)),e}function B6(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>U6(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],k2(r)),e}function j6(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function Ym(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["version"]);i!=null&&m(e,["version"],i);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],j6(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const d=h(t,["outputTokenLimit"]);d!=null&&m(e,["outputTokenLimit"],d);const f=h(t,["supportedGenerationMethods"]);return f!=null&&m(e,["supportedActions"],f),e}function V6(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=h2(r);Array.isArray(a)&&(a=a.map(i=>Ym(i))),m(e,["models"],a)}return e}function $6(){return{}}function H6(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function G6(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],hs(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function z6(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],G6(n)),e}function q6(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>z6(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function Y6(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],q6(l)),e}function W6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function J6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function K6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function X6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],W6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],J6(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],K6(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function Z6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>X6(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function Q6(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function eF(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function tF(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>eF(a))),m(e,["urlMetadata"],r)}return e}function nF(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],Z6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],Q6(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],tF(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function z_(t){const e={},n=h(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>nF(f))),m(e,["candidates"],d)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const i=h(t,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function rF(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function aF(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],rF(r)),e}function sF(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function iF(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>aF(i))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],sF(r)),e}function oF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],hs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function N2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function Sp(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],oF(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],N2(a));const i=h(t,["prompt"]);return i!=null&&m(e,["enhancedPrompt"],i),e}function lF(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>Sp(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],N2(r)),e}function cF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Sp(a))),m(e,["generatedImages"],r)}return e}function uF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Sp(a))),m(e,["generatedImages"],r)}return e}function fF(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function dF(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function hF(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function Wm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["versionId"]);i!=null&&m(e,["version"],i);const l=h(t,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>fF(_))),m(e,["endpoints"],v)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const d=h(t,["_self"]);d!=null&&m(e,["tunedModelInfo"],dF(d));const f=h(t,["defaultCheckpointId"]);f!=null&&m(e,["defaultCheckpointId"],f);const g=h(t,["checkpoints"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(_=>hF(_))),m(e,["checkpoints"],v)}return e}function mF(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=h2(r);Array.isArray(a)&&(a=a.map(i=>Wm(i))),m(e,["models"],a)}return e}function pF(){return{}}function gF(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function xF(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function vF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],hs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function yF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],vF(n)),e}function _F(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>yF(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function wF(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],_F(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TF="Content-Type",EF="X-Server-Timeout",SF="User-Agent",Jm="x-goog-api-client",bF="1.8.0",CF=`google-genai-sdk/${bF}`,AF="v1beta1",kF="v1beta",q_=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class NF{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:AF,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:kF,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(a,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,i]of Object.entries(n))typeof i=="object"?r[a]=Object.assign(Object.assign({},r[a]),i):i!==void 0&&(r[a]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(a,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,i=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=i}return n&&n.extraBody!==null&&RF(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Y_(a),new Vm(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Y_(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return tl(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield Qt(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=i.decode(d);try{const v=JSON.parse(f);if("error"in v){const _=JSON.parse(JSON.stringify(v.error)),T=_.status,E=_.code,S=`got status: ${T}. ${JSON.stringify(v)}`;if(E>=400&&E<600)throw new Dd({message:S,status:E})}}catch(v){if(v.name==="ApiError")throw v}l+=f;let g=l.match(q_);for(;g;){const v=g[1];try{const _=new Response(v,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Qt(new Vm(_)),l=l.slice(g[0].length),g=l.match(q_)}catch(_){throw new Error(`exception parsing stream chunk ${v}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=CF+" "+this.clientOptions.userAgentExtra;return e[SF]=n,e[Jm]=n,e[TF]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(EF,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const i=this.clientOptions.uploader,l=await i.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const d=await this.fetchUploadUrl(a,n);return i.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},l=await this.request({path:ze("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Y_(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new Dd({message:a,status:n}):new Error(a)}}function RF(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,l){const c=Object.assign({},i);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],g=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[d]=r(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DF="mcp_used/unknown";function R2(t){for(const e of t)if(bp(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function D2(t){var e;const n=(e=t[Jm])!==null&&e!==void 0?e:"";t[Jm]=(n+` ${DF}`).trimStart()}function MF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>bp(a)))!==null&&r!==void 0?r:!1}function IF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!bp(a)))!==null&&r!==void 0?r:!1}function bp(t){return t!==null&&typeof t=="object"&&t instanceof Cp}function FF(t,e=100){return tl(this,arguments,function*(){let r,a=0;for(;a<e;){const i=yield Qt(t.listTools({cursor:r}));for(const l of i.tools)yield yield Qt(l),a++;if(!i.nextCursor)break;r=i.nextCursor}})}class Cp{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Cp(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const i={},l=[];for(const g of this.mcpClients)try{for(var c=!0,d=(n=void 0,Pc(FF(g))),f;f=await d.next(),e=f.done,!e;c=!0){a=f.value,c=!1;const v=a;l.push(v);const _=v.name;if(i[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);i[_]=g}}catch(v){n={error:v}}finally{try{!c&&!e&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),AR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function LF(t,e,n){const r=new gR;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const i=HM(a);Object.assign(r,i),e(r)}class OF{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),l=BF(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(C=>{f=C}),v=e.callbacks,_=function(){f({})},T=this.apiClient,E={onopen:_,onmessage:C=>{LF(T,v.onmessage,C)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(C){}},S=this.webSocketFactory.create(d,UF(l),E);S.connect(),await g;const b=Vt(this.apiClient,e.model),k=S2({model:b}),A=qm({setup:k});return S.send(JSON.stringify(A)),new PF(S,this.apiClient)}}class PF{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=rM(e),r=b2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=aM(e),r=qm(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=qm({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Zo.PLAY)}pause(){this.sendPlaybackControl(Zo.PAUSE)}stop(){this.sendPlaybackControl(Zo.STOP)}resetContext(){this.sendPlaybackControl(Zo.RESET_CONTEXT)}close(){this.conn.close()}}function UF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function BF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function VF(t,e,n){const r=new pR;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const i=JSON.parse(a);if(t.isVertexAI()){const l=FM(i);Object.assign(r,l)}else{const l=IM(i);Object.assign(r,l)}e(r)}class $F{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new OF(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,i,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const v=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&R2(e.config.tools)&&D2(v);const _=qF(v);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const P=this.apiClient.getApiKey();let ae="BidiGenerateContent",G="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),ae="BidiGenerateContentConstrained",G="access_token"),g=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ae}?${G}=${P}`}let T=()=>{};const E=new Promise(P=>{T=P}),S=e.callbacks,b=function(){var P;(P=S==null?void 0:S.onopen)===null||P===void 0||P.call(S),T({})},k=this.apiClient,A={onopen:b,onmessage:P=>{VF(k,S.onmessage,P)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(P){}},C=this.webSocketFactory.create(g,zF(_),A);C.connect(),await E;let M=Vt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const P=this.apiClient.getProject(),ae=this.apiClient.getLocation();M=`projects/${P}/locations/${ae}/`+M}let B={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[fd.AUDIO]}:e.config.responseModalities=[fd.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const P of H)if(this.isCallableTool(P)){const ae=P;F.push(await ae.tool())}else F.push(P);F.length>0&&(e.config.tools=F);const K={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=KD(this.apiClient,K):B=JD(this.apiClient,K),delete B.config,C.send(JSON.stringify(B)),new GF(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const HF={turnComplete:!0};class GF{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Xr(n.turns),e.isVertexAI()?r=r.map(a=>_l(a)):r=r.map(a=>Md(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(jF)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},HF),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:nM(e)}:n={realtimeInput:tM(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function zF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function qF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const W_=10;function J_(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(td(l)){a=!0;break}if(!a)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function td(t){return"callTool"in t&&typeof t.callTool=="function"}function K_(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YF extends qi{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,i,l,c;const d=await this.processParamsForMcpUsage(n);if(!MF(n)||J_(n.config))return await this.generateContentInternal(d);if(IF(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,g;const v=Xr(d.contents),_=(i=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&i!==void 0?i:W_;let T=0;for(;T<_&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const b of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(td(b)){const A=await b.callTool(f.functionCalls);S.push(...A)}T++,g={role:"user",parts:S},d.contents=Xr(d.contents),d.contents.push(E),d.contents.push(g),K_(d.config)&&(v.push(E),v.push(g))}return K_(d.config)&&(f.automaticFunctionCallingHistory=v),f},this.generateContentStream=async n=>{if(J_(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let i;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?i=d==null?void 0:d.safetyAttributes:l.push(d);let c;return i?c={generatedImages:l,positivePromptSafetyAttributes:i}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new mu(Pi.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(e){var n,r,a;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const l=await Promise.all(i.map(async d=>td(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&R2(e.config.tools)){const d=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),D2(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var n,r,a;const i=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(td(l)){const c=l,d=await c.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(i.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);i.set(f.name,c)}}return i}async processAfcStream(e){var n,r,a;const i=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:W_;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,g,v){var _,T;return tl(this,arguments,function*(){for(var E,S,b,k;c<i;){l&&(c++,l=!1);const B=yield Qt(f.processParamsForMcpUsage(v)),H=yield Qt(f.generateContentStreamInternal(B)),F=[],K=[];try{for(var A=!0,C=(S=void 0,Pc(H)),M;M=yield Qt(C.next()),E=M.done,!E;A=!0){k=M.value,A=!1;const P=k;if(yield yield Qt(P),P.candidates&&(!((_=P.candidates[0])===null||_===void 0)&&_.content)){K.push(P.candidates[0].content);for(const ae of(T=P.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(c<i&&ae.functionCall){if(!ae.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(ae.functionCall.name)){const G=yield Qt(g.get(ae.functionCall.name).callTool([ae.functionCall]));F.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${ae.functionCall.name}`)}}}}catch(P){S={error:P}}finally{try{!A&&!E&&(b=C.return)&&(yield Qt(b.call(C)))}finally{if(S)throw S.error}}if(F.length>0){l=!0;const P=new Sc;P.candidates=[{content:{role:"user",parts:F}}],yield yield Qt(P);const ae=[];ae.push(...K),ae.push({role:"user",parts:F});const G=Xr(v.contents).concat(ae);v.contents=G}else break}})}(this,d,e)}async generateContentInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=H_(this.apiClient,e);return c=ze("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=z_(g),_=new Sc;return Object.assign(_,v),_})}else{const f=$_(this.apiClient,e);return c=ze("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=G_(g),_=new Sc;return Object.assign(_,v),_})}}async generateContentStreamInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=H_(this.apiClient,e);return c=ze("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return tl(this,arguments,function*(){var _,T,E,S;try{for(var b=!0,k=Pc(v),A;A=yield Qt(k.next()),_=A.done,!_;b=!0){S=A.value,b=!1;const M=z_(yield Qt(S.json())),B=new Sc;Object.assign(B,M),yield yield Qt(B)}}catch(C){T={error:C}}finally{try{!b&&!_&&(E=k.return)&&(yield Qt(E.call(k)))}finally{if(T)throw T.error}}})})}else{const f=$_(this.apiClient,e);return c=ze("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(v){return tl(this,arguments,function*(){var _,T,E,S;try{for(var b=!0,k=Pc(v),A;A=yield Qt(k.next()),_=A.done,!_;b=!0){S=A.value,b=!1;const M=G_(yield Qt(S.json())),B=new Sc;Object.assign(B,M),yield yield Qt(B)}}catch(C){T={error:C}}finally{try{!b&&!_&&(E=k.return)&&(yield Qt(E.call(k)))}finally{if(T)throw T.error}}})})}}async embedContent(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=t6(this.apiClient,e);return c=ze("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=iF(g),_=new w_;return Object.assign(_,v),_})}else{const f=mI(this.apiClient,e);return c=ze("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=O6(g),_=new w_;return Object.assign(_,v),_})}}async generateImagesInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=r6(this.apiClient,e);return c=ze("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=lF(g),_=new T_;return Object.assign(_,v),_})}else{const f=gI(this.apiClient,e);return c=ze("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=B6(g),_=new T_;return Object.assign(_,v),_})}}async editImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=u6(this.apiClient,e);return i=ze("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=cF(d),g=new cR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=d6(this.apiClient,e);return i=ze("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=uF(d),g=new uR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=h6(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Wm(g))}else{const f=xI(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ym(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=p6(this.apiClient,e);return c=ze("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=mF(g),_=new E_;return Object.assign(_,v),_})}else{const f=yI(this.apiClient,e);return c=ze("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=V6(g),_=new E_;return Object.assign(_,v),_})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=x6(this.apiClient,e);return c=ze("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Wm(g))}else{const f=wI(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ym(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=v6(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=pF(),v=new S_;return Object.assign(v,g),v})}else{const f=TI(this.apiClient,e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=$6(),v=new S_;return Object.assign(v,g),v})}}async countTokens(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=_6(this.apiClient,e);return c=ze("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=gF(g),_=new b_;return Object.assign(_,v),_})}else{const f=SI(this.apiClient,e);return c=ze("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=H6(g),_=new b_;return Object.assign(_,v),_})}}async computeTokens(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=w6(this.apiClient,e);return i=ze("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=xF(d),g=new fR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=S6(this.apiClient,e);return c=ze("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>wF(g))}else{const f=AI(this.apiClient,e);return c=ze("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Y6(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function JF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function KF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function XF(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],hs(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function ZF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],XF(n)),e}function QF(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>ZF(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function e8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],QF(l)),e}function t8(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],hs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function n8(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],t8(n)),e}function r8(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>n8(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function X_(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],r8(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a8 extends qi{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=JF(e);return c=ze("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>X_(g))}else{const f=WF(e);return c=ze("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>e8(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=KF(e);return i=ze("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>X_(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s8(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function M2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],s8(n)),e}function i8(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],M2(r)),e}function o8(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>i8(a))),m(e,["speakerVoiceConfigs"],r)}return e}function l8(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],M2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],o8(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function c8(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function u8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function f8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function d8(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],c8(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],u8(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],f8(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function h8(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>d8(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function m8(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function p8(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function g8(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],p8(n)),e}function x8(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function v8(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],x8(n)),e}function y8(){return{}}function _8(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>m8(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],g8(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],v8(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],y8());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function w8(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Z_(){return{}}function T8(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function E8(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],T8(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function S8(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function b8(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],S8(r)),e}function C8(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function A8(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],l8(Ep(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],h8(rr(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=vl(E);Array.isArray(B)&&(B=B.map(H=>_8(xl(H)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],w8(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],Z_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],Z_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],E8(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],b8(C));const M=h(t,["proactivity"]);return e!==void 0&&M!=null&&m(e,["setup","proactivity"],C8(M)),n}function k8(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Vt(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],A8(a,n)),n}function N8(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const i=h(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&m(n,["newSessionExpireTime"],i);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],k8(t,c));const d=h(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&m(n,["fieldMask"],d),r}function R8(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],N8(t,r,n)),n}function D8(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M8(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(i=>`${n}.${i}`);e.push(...a)}else e.push(n)}return e.join(",")}function I8(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const i=M8(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];i&&d.push(i),c.length>0&&d.push(...c),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class F8 extends qi{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=R8(this.apiClient,e);i=ze("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=I8(c,e.config);return a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>D8(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function O8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function P8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],O8(n,e)),e}function U8(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function B8(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>U8(a))),m(e,["examples","examples"],r)}return e}function j8(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const i=h(t,["learningRateMultiplier"]);if(i!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function V8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],B8(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],j8(a,e)),e}function $8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function H8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function G8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],H8(n,e)),e}function z8(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function q8(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function Y8(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],q8(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const i=h(t,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=h(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=h(t,["adapterSize"]);if(e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function W8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],z8(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],Y8(a,e)),e}function J8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function I2(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],u2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["tuningTask","startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const f=h(t,["baseModel"]);f!=null&&m(e,["baseModel"],f);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],J8(g));const v=h(t,["distillationSpec"]);v!=null&&m(e,["distillationSpec"],v);const _=h(t,["experiment"]);_!=null&&m(e,["experiment"],_);const T=h(t,["labels"]);T!=null&&m(e,["labels"],T);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const b=h(t,["satisfiesPzs"]);b!=null&&m(e,["satisfiesPzs"],b);const k=h(t,["serviceAccount"]);k!=null&&m(e,["serviceAccount"],k);const A=h(t,["tunedModelDisplayName"]);return A!=null&&m(e,["tunedModelDisplayName"],A),e}function K8(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>I2(i))),m(e,["tuningJobs"],a)}return e}function X8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);return i!=null&&m(e,["error"],i),e}function Z8(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const i=h(t,["endpoint"]);return i!=null&&m(e,["endpoint"],i),e}function Q8(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>Z8(l))),m(e,["checkpoints"],i)}return e}function Km(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],u2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["error"]);d!=null&&m(e,["error"],d);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const v=h(t,["tunedModel"]);v!=null&&m(e,["tunedModel"],Q8(v));const _=h(t,["supervisedTuningSpec"]);_!=null&&m(e,["supervisedTuningSpec"],_);const T=h(t,["tuningDataStats"]);T!=null&&m(e,["tuningDataStats"],T);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const b=h(t,["distillationSpec"]);b!=null&&m(e,["distillationSpec"],b);const k=h(t,["experiment"]);k!=null&&m(e,["experiment"],k);const A=h(t,["labels"]);A!=null&&m(e,["labels"],A);const C=h(t,["pipelineJob"]);C!=null&&m(e,["pipelineJob"],C);const M=h(t,["satisfiesPzi"]);M!=null&&m(e,["satisfiesPzi"],M);const B=h(t,["satisfiesPzs"]);B!=null&&m(e,["satisfiesPzs"],B);const H=h(t,["serviceAccount"]);H!=null&&m(e,["serviceAccount"],H);const F=h(t,["tunedModelDisplayName"]);return F!=null&&m(e,["tunedModelDisplayName"],F),e}function eL(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Km(i))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tL extends qi{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new mu(Pi.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:jm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=$8(e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Km(g))}else{const f=L8(e);return c=ze("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>I2(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=G8(e);return c=ze("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=eL(g),_=new C_;return Object.assign(_,v),_})}else{const f=P8(e);return c=ze("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=K8(g),_=new C_;return Object.assign(_,v),_})}}async tuneInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=W8(e);return i=ze("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Km(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=V8(e);return i=ze("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>X8(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nL{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const rL=1024*1024*8,aL=3,sL=1e3,iL=2,sm="x-goog-upload-status";async function oL(t,e,n){var r,a,i;let l=0,c=0,d=new Vm(new Response),f="upload";for(l=t.size;c<l;){const v=Math.min(rL,l-c),_=t.slice(c,c+v);c+v>=l&&(f+=", finalize");let T=0,E=sL;for(;T<aL&&(d=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(v)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[sm]));)T++,await cL(E),E=E*iL;if(c+=v,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[sm])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(d==null?void 0:d.json());if(((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[sm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function lL(t){return{size:t.size,type:t.type}}function cL(t){return new Promise(e=>setTimeout(e,t))}class uL{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await oL(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lL(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fL{create(e,n,r){return new dL(e,n,r)}}class dL{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q_="x-goog-api-key";class hL{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Q_)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Q_,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mL="gl-node/";class pL{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=lR(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new hL(this.apiKey);this.apiClient=new NF({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:mL+"web",uploader:new uL,downloader:new nL}),this.models=new YF(this.apiClient),this.live=new $F(this.apiClient,a,new fL),this.batches=new O3(this.apiClient),this.chats=new j5(this.models,this.apiClient),this.caches=new P5(this.apiClient),this.files=new Q5(this.apiClient),this.operations=new a8(this.apiClient),this.authTokens=new F8(this.apiClient),this.tunings=new tL(this.apiClient)}}const pa="gemini-2.5-flash-preview-04-17";let Xt=null;const im=t=>{if(!t){Xt=null;return}try{Xt=new pL({apiKey:t})}catch(e){console.error("Failed to initialize Gemini AI:",e),Xt=null}},Yi=t=>{const e=n=>{const{position:r,extendedDetails:a,...i}=n,l={...i};if(a){const{reportDeck:c,attachments:d,subSteps:f,decisions:g,...v}=a,_={...v};c&&c.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=c.slides.length),d&&d.length>0&&(_.attachments=d.map(T=>({id:T.id,name:T.name,type:T.type}))),f&&f.length>0&&(_.subSteps=f.map(T=>{const{position:E,attachments:S,actionItems:b,...k}=T,A={...k};return S&&S.length>0&&(A.attachments=S.map(C=>({id:C.id,name:C.name,type:C.type}))),b&&b.length>0&&(A.actionItems=b.map(C=>{const{report:M,...B}=C,H={...B};if(M){const{attachments:F,...K}=M,P={...K};F&&F.length>0&&(P.attachments=F.map(ae=>({id:ae.id,name:ae.name,type:ae.type}))),H.report=P}return H})),A})),l.extendedDetails=_}return l};return Array.isArray(t)?t.map(e):e(t)},Fd=t=>({...t,slides:t.slides.map(e=>{if(e.isLocked)return{id:e.id,isLocked:!0,summary:`Locked Slide: Contains ${e.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=e;return{...r,elements:n.map(a=>{var i;if(a.type==="flowchart"&&((i=a.data)!=null&&i.subSteps)){const l=a;return{...l,data:{subStepCount:l.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${l.data.subSteps.length}]`}}}return a})}})}),gL=t=>{const e=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return t.replace(e,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},La=t=>{let e=t.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=e.match(n);if(r&&r[1]&&(e=r[1].trim()),e=gL(e),e=e.replace(/"((?:\\.|[^"\\])*)"/g,(a,i)=>`"${i.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=e.indexOf("{"),i=e.indexOf("[");if(a===-1&&i===-1)throw console.error("No JSON object or array found in the response string.",t),new Error(`AI response did not contain a valid JSON structure. Raw response: ${t.substring(0,500)}...`);const l=a===-1?i:i===-1?a:Math.min(a,i),c=e.lastIndexOf("}"),d=e.lastIndexOf("]"),f=Math.max(c,d);l>-1&&f>l&&(e=e.substring(l,f+1))}try{return JSON.parse(e)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,t,`
Processed string:`,e),new Error(`Failed to parse AI response as JSON. Raw response: ${t.substring(0,500)}...`)}},ga=(t,e)=>{console.error(`Error in Gemini API call during ${e}:`,t);let n=`AI (${e})`;if(t instanceof Error){const r=t.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="API(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="APIGoogle AI Platform(You have exceeded your API quota.)":n=`AI (${e}): ${t.message}`}throw new Error(n)},xL=async(t,e)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${t}"
    - Target Completion Date: "${e}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Xt.models.generateContent({model:pa,contents:n,config:{responseMimeType:"application/json"}}),a=La(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.id||!i.title||!i.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){ga(r,"project plan generation")}},vL=async t=>{var n;if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${t.title}"
    - Task Description: "${t.description}"
    - Required Resources: "${((n=t.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Xt.models.generateContent({model:pa,contents:e,config:{responseMimeType:"application/json"}}),a=La(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.title||!i.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){ga(r,"step proposal generation")}},yL=async(t,e)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Yi(t))}
        - Existing Decisions List: ${JSON.stringify(e)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Xt.models.generateContent({model:pa,contents:n,config:{responseMimeType:"application/json"}}),a=La(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.question||!i.status||!i.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){ga(r,"decision generation")}},_L=async(t,e,n)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Yi(e))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Fd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Xt.models.generateContent({model:pa,contents:r,config:{responseMimeType:"application/json"}}),i=La(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return i}catch(a){ga(a,"slide deck regeneration")}},wL=async t=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(Fd(t))}
    `;try{const n=await Xt.models.generateContent({model:pa,contents:e,config:{responseMimeType:"application/json"}}),r=La(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){ga(n,"slide layout optimization")}},TL=async(t,e,n)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${e}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Yi(t),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Xt.models.generateContent({model:pa,contents:r,config:{responseMimeType:"application/json"}}),i=La(a.text);if(!i||!i.overallStatus||!i.summary)throw new Error("AI returned an invalid format for the project health report.");return i}catch(a){ga(a,"project health report generation")}},EL=async(t,e,n)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Yi(t),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Xt.models.generateContent({model:pa,contents:r,config:{responseMimeType:"application/json"}}),i=La(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the project slide deck.");return i}catch(a){ga(a,"project report deck generation")}},SL=async(t,e,n,r)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Yi(e),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Fd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const i=await Xt.models.generateContent({model:pa,contents:a,config:{responseMimeType:"application/json"}}),l=La(i.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return l}catch(i){ga(i,"project report deck regeneration")}},bL=t=>{const e=t.match(/^data:(.+);base64,(.*)$/);return e?{mimeType:e[1],data:e[2]}:null},F2=t=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const e=[];for(const n of t){if(e.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=bL(n.content);r?e.push({inlineData:{mimeType:r.mimeType,data:r.data}}):e.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?Fd(n.content):Yi(n.content);e.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else e.push({text:`Type: Text
Content: ${n.content}`});e.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return e},L2=async(t,e)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${e}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...F2(t)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Xt.models.generateContent({model:pa,contents:{parts:r},config:{responseMimeType:"application/json"}}),i=La(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return i}catch(a){ga(a,"custom slide deck generation")}},CL=async(t,e)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${e}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...F2(t)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Xt.models.generateContent({model:pa,contents:{parts:r}})).text}catch(a){ga(a,"custom text report generation")}},ew=async(t,e,n)=>{if(!Xt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${e}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Yi(t),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Xt.models.generateContent({model:pa,contents:r,config:{responseMimeType:"application/json"}}),i=La(a.text);if(!i||!Array.isArray(i))throw new Error("AI returned an invalid format for the Gantt chart data.");return i}catch(a){ga(a,"Gantt chart data generation")}};class er{static async getProjects(){const{data:{user:e}}=await Yt.auth.getUser();if(!e)throw new Error("");const{data:n,error:r}=await Yt.from("projects").select(`
        *,
        project_members!inner(role)
      `).order("updated_at",{ascending:!1});if(r)throw new Error(`: ${r.message}`);return n.map(a=>{var i;return{id:a.id,title:a.title,goal:a.goal,targetDate:a.target_date,tasks:a.tasks_data||[],ganttData:a.gantt_data,createdAt:a.created_at,updatedAt:a.updated_at,lastModifiedBy:a.last_modified_by,version:a.version||1,userRole:((i=a.project_members[0])==null?void 0:i.role)||"viewer"}})}static async getProjectWithMembers(e){var d;const{data:{user:n}}=await Yt.auth.getUser();if(!n)throw new Error("");const{data:r,error:a}=await Yt.from("projects").select(`
        *,
        project_members!inner(role)
      `).eq("id",e).single();if(a)throw new Error(`: ${a.message}`);const{data:i,error:l}=await Yt.from("project_members").select(`
        *,
        user:auth.users(email)
      `).eq("project_id",e).eq("status","accepted");if(l)throw new Error(`: ${l.message}`);const c=i.map(f=>{var g;return{id:f.id,projectId:f.project_id,userId:f.user_id,role:f.role,invitedBy:f.invited_by,invitedAt:f.invited_at,joinedAt:f.joined_at,status:f.status,userEmail:(g=f.user)==null?void 0:g.email}});return{id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at,lastModifiedBy:r.last_modified_by,version:r.version||1,userRole:((d=r.project_members[0])==null?void 0:d.role)||"viewer",members:c}}static async createProject(e,n,r,a=[],i){const{data:{user:l}}=await Yt.auth.getUser();if(!l)throw new Error("");const{data:c,error:d}=await Yt.from("projects").insert({user_id:l.id,title:e,goal:n,target_date:r,tasks_data:a,gantt_data:i,last_modified_by:l.id,version:1}).select().single();if(d)throw new Error(`: ${d.message}`);return{id:c.id,title:c.title,goal:c.goal,targetDate:c.target_date,tasks:c.tasks_data||[],ganttData:c.gantt_data,createdAt:c.created_at,updatedAt:c.updated_at,lastModifiedBy:c.last_modified_by,version:c.version,userRole:"owner"}}static async updateProject(e,n){var c;const{data:{user:r}}=await Yt.auth.getUser();if(!r)throw new Error("");if(n.expectedVersion!==void 0){const{data:d,error:f}=await Yt.from("projects").select("version").eq("id",e).single();if(f)throw new Error(`: ${f.message}`);if(d.version!==n.expectedVersion)throw new Error("")}const a={};n.title!==void 0&&(a.title=n.title),n.goal!==void 0&&(a.goal=n.goal),n.targetDate!==void 0&&(a.target_date=n.targetDate),n.tasks!==void 0&&(a.tasks_data=n.tasks),n.ganttData!==void 0&&(a.gantt_data=n.ganttData);const{data:i,error:l}=await Yt.from("projects").update(a).eq("id",e).select(`
        *,
        project_members!inner(role)
      `).single();if(l)throw new Error(`: ${l.message}`);return{id:i.id,title:i.title,goal:i.goal,targetDate:i.target_date,tasks:i.tasks_data||[],ganttData:i.gantt_data,createdAt:i.created_at,updatedAt:i.updated_at,lastModifiedBy:i.last_modified_by,version:i.version,userRole:((c=i.project_members[0])==null?void 0:c.role)||"viewer"}}static async deleteProject(e){const{error:n}=await Yt.from("projects").delete().eq("id",e);if(n)throw new Error(`: ${n.message}`)}static async getProject(e){var a;const{data:n,error:r}=await Yt.from("projects").select(`
        *,
        project_members!inner(role)
      `).eq("id",e).single();if(r)throw new Error(`: ${r.message}`);return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,version:n.version||1,userRole:((a=n.project_members[0])==null?void 0:a.role)||"viewer"}}static async inviteToProject(e,n,r){const{data:{user:a}}=await Yt.auth.getUser();if(!a)throw new Error("");const{data:i,error:l}=await Yt.from("project_invitations").insert({project_id:e,email:n,role:r,invited_by:a.id}).select().single();if(l)throw new Error(`: ${l.message}`);return{id:i.id,projectId:i.project_id,email:i.email,role:i.role,invitedBy:i.invited_by,token:i.token,expiresAt:i.expires_at,createdAt:i.created_at,usedAt:i.used_at}}static async joinProjectByInvitation(e){const{data:n,error:r}=await Yt.rpc("join_project_by_invitation",{invitation_token:e});if(r)throw new Error(`: ${r.message}`);return n}static async getProjectInvitations(e){const{data:n,error:r}=await Yt.from("project_invitations").select("*").eq("project_id",e).is("used_at",null).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(r)throw new Error(`: ${r.message}`);return n.map(a=>({id:a.id,projectId:a.project_id,email:a.email,role:a.role,invitedBy:a.invited_by,token:a.token,expiresAt:a.expires_at,createdAt:a.created_at,usedAt:a.used_at}))}static async updateMemberRole(e,n,r){const{error:a}=await Yt.from("project_members").update({role:r}).eq("project_id",e).eq("user_id",n);if(a)throw new Error(`: ${a.message}`)}static async removeMember(e,n){const{error:r}=await Yt.from("project_members").delete().eq("project_id",e).eq("user_id",n);if(r)throw new Error(`: ${r.message}`)}static subscribeToProjectChanges(e,n,r){const a=Yt.channel(`project-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${e}`},n).on("postgres_changes",{event:"*",schema:"public",table:"project_members",filter:`project_id=eq.${e}`},r).subscribe();return()=>{Yt.removeChannel(a)}}}const Mn=({size:t="md",color:e="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return x.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[x.jsx("div",{className:`animate-spin rounded-full border-4 ${e} border-t-transparent ${r[t]}`}),n&&x.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},Ap=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),kp=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),AL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),kL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),Pr=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),O2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),P2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),fl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Np=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ma=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),pu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Di=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Rp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Ui=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),NL=({title:t,...e})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[t&&x.jsx("title",{children:t}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),gu=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),Ld=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),RL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),Od=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),Pd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),DL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ML=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),IL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),FL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),LL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),U2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),B2=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),OL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),j2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),V2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Xs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),xu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),PL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),UL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),wl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),$2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),om=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),lm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),H2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Bi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Xc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),ji=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),Zc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),hd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),BL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),jL=({onSubmit:t,isLoading:e,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:i="",onOpenProjectList:l,onLogout:c,user:d})=>{const[f,g]=U.useState(a),[v,_]=U.useState(i),T=U.useRef(null);ls.useEffect(()=>{g(a)},[a]),ls.useEffect(()=>{_(i)},[i]);const E=new Date().toISOString().split("T")[0],S=M=>{if(M.preventDefault(),!f.trim()||!v){alert("");return}t(f,v)},b=()=>{var M;(M=T.current)==null||M.click()},k=M=>{var H;const B=(H=M.target.files)==null?void 0:H[0];B&&(n(B),M.target.value="")},A=M=>{if(!f.trim()||!v){alert("");return}r(M,f,v)},C=({template:M,title:B,description:H,disabled:F})=>x.jsxs("button",{type:"button",onClick:()=>A(M),disabled:F,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[x.jsx("div",{className:"font-semibold text-md",children:B}),x.jsx("div",{className:"text-xs text-purple-200 mt-1",children:H})]});return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[x.jsxs("div",{className:"text-white text-sm",children:[": ",d==null?void 0:d.email]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[x.jsx(Bi,{className:"w-5 h-5"}),""]}),x.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[x.jsx(Zc,{className:"w-5 h-5"}),""]})]})]}),x.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[x.jsxs("div",{className:"text-center mb-10",children:[x.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),x.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),x.jsxs("form",{onSubmit:S,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(kp,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),x.jsx("textarea",{id:"projectGoal",value:f,onChange:M=>g(M.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Ap,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),x.jsx("input",{type:"date",id:"targetDate",value:v,onChange:M=>_(M.target.value),min:E,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),x.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[x.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:e?x.jsx(Mn,{size:"sm",color:"border-white"}):"AI"}),x.jsxs("button",{type:"button",onClick:b,disabled:e,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[x.jsx(P2,{className:"w-5 h-5 mr-2"})," (.json)"]}),x.jsx("input",{type:"file",ref:T,onChange:k,accept:".json",className:"hidden","aria-hidden":"true"})]}),x.jsxs("div",{className:"sm:col-span-2 pt-4",children:[x.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[x.jsx(C,{template:"process-design",disabled:e,title:" (APQP)",description:"APQP"}),x.jsx(C,{template:"process-change",disabled:e,title:" (ISO/IATF)",description:""}),x.jsx(C,{template:"new-product-eval",disabled:e,title:"",description:""}),x.jsx(C,{template:"improvement-project",disabled:e,title:"",description:"DMAIC"}),x.jsx(C,{template:"equipment-modification",disabled:e,title:"",description:""})]})]})]})]}),x.jsx("footer",{className:"mt-12 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})},Vf=t=>{switch(t){case Ni.IN_PROGRESS:return{icon:x.jsx(ML,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case Ni.COMPLETED:return{icon:x.jsx(pu,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case Ni.BLOCKED:return{icon:x.jsx(IL,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case Ni.NOT_STARTED:default:return{icon:x.jsx(DL,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},VL=({task:t,onSelectTask:e,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:i,cardRef:l,onStartConnection:c,onEndConnection:d,canEdit:f=!0})=>{var F,K,P,ae;const[g,v]=U.useState(!1),_=U.useRef(null);U.useEffect(()=>{const G=te=>{_.current&&!_.current.contains(te.target)&&v(!1)};return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[_]);const T=G=>{f&&(r(t.id,G),v(!1))},E=(F=t.extendedDetails)==null?void 0:F.numericalTarget;let S="text-slate-500";E&&(E.status===Mm.ACHIEVED?S="text-green-600":E.status===Mm.MISSED?S="text-red-600":S="text-yellow-600");const b=Vf(t.status),k=(K=t.extendedDetails)==null?void 0:K.dueDate,A=k?new Date(k+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,C=t.status===Ni.IN_PROGRESS,M="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",B=C?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",H=G=>{G.stopPropagation(),c(t.id,G)};return x.jsxs("div",{ref:l,id:`taskcard-${t.id}`,draggable:"true",onDragStart:G=>a(G,t.id),onMouseUp:()=>d(t.id),className:`${M} ${B}`,style:{position:"absolute",left:((P=t.position)==null?void 0:P.x)||0,top:((ae=t.position)==null?void 0:ae.y)||0,touchAction:"none"},children:[x.jsxs("div",{className:"p-5 relative",children:[x.jsx("div",{onMouseDown:H,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[x.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:i+1}),x.jsx("div",{className:"flex-grow min-w-0",children:x.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${t.title}`,children:t.title})})]}),x.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&x.jsx(NL,{className:`w-5 h-5 ${S}`,title:`: ${E.description} (${E.status})`}),x.jsx("button",{onClick:G=>{G.stopPropagation(),e(t)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${t.title}`,children:x.jsx(kL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:G=>{G.stopPropagation(),f&&n(t.id)},disabled:!f,className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:f?"":"","aria-label":`: ${t.title}`,children:x.jsx(ma,{className:"w-5 h-5"})})]})]}),x.jsx("div",{className:"h-20 mb-3",children:x.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:t.description})}),x.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[x.jsxs("div",{className:"relative",ref:_,children:[x.jsxs("button",{onClick:()=>v(G=>!G),disabled:!f,className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${b.bgColor} ${b.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:f?"":"",children:[ls.cloneElement(b.icon,{className:`w-3 h-3 mr-1 ${b.color}`}),b.text]}),g&&f&&x.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(Ni).map(G=>x.jsxs("button",{onClick:()=>T(G),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[ls.cloneElement(Vf(G).icon,{className:`w-3.5 h-3.5 mr-2 ${Vf(G).color}`}),Vf(G).text]},G))})]}),A&&x.jsxs("div",{className:"flex items-center text-orange-600",children:[x.jsx(Pd,{className:"w-3.5 h-3.5 mr-1"}),": ",A]})]})]}),x.jsx("button",{onClick:G=>{G.stopPropagation(),e(t)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:f?" ":" "})]})},$L=U.memo(VL),Qc=({from:t,to:e,id:n,onDelete:r})=>{const l=t.x,c=e.x,d=(l+c)/2,f=(t.y+e.y)/2,g=`M${l},${t.y} C${l+50},${t.y} ${c-50},${e.y} ${c},${e.y}`;return x.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[x.jsx("defs",{children:x.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:x.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),x.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[x.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),x.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&x.jsxs("g",{transform:`translate(${d}, ${f})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[x.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),x.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},HL=({tasks:t,onClose:e})=>{const[n,r]=U.useState("all"),[a,i]=U.useState(""),[l,c]=U.useState(null),d=U.useMemo(()=>{const E=[];return t.forEach(S=>{var b,k;(k=(b=S.extendedDetails)==null?void 0:b.subSteps)==null||k.forEach(A=>{var C;(C=A.actionItems)==null||C.forEach(M=>{E.push({actionItem:M,subStep:A,task:S})})})}),E},[t]),f=U.useMemo(()=>d.filter(E=>n==="completed"?E.actionItem.completed:n==="pending"?!E.actionItem.completed:!0).filter(E=>{const S=a.toLowerCase();return E.actionItem.text.toLowerCase().includes(S)||E.subStep.text.toLowerCase().includes(S)||(E.subStep.responsible||"").toLowerCase().includes(S)||E.task.title.toLowerCase().includes(S)}),[d,n,a]),g=U.useMemo(()=>{let E=[...f];return l!==null&&E.sort((S,b)=>{let k="",A="";switch(l.key){case"status":k=S.actionItem.completed,A=b.actionItem.completed;break;case"actionItem":k=S.actionItem.text.toLowerCase(),A=b.actionItem.text.toLowerCase();break;case"responsible":k=(S.subStep.responsible||"").toLowerCase(),A=(b.subStep.responsible||"").toLowerCase();break;case"subStep":k=S.subStep.text.toLowerCase(),A=b.subStep.text.toLowerCase();break;case"task":k=S.task.title.toLowerCase(),A=b.task.title.toLowerCase();break;case"dueDate":k=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",A=b.actionItem.dueDate||b.subStep.dueDate||"9999-12-31";break}return k<A?l.direction==="ascending"?-1:1:k>A?l.direction==="ascending"?1:-1:0}),E},[f,l]),v=E=>{let S="ascending";l&&l.key===E&&l.direction==="ascending"&&(S="descending"),c({key:E,direction:S})},_=E=>!l||l.key!==E?x.jsx(Xc,{className:"w-3 h-3 ml-1 opacity-20"}):l.direction==="ascending"?x.jsx(Xc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(ji,{className:"w-3 h-3 ml-1 text-blue-600"}),T=({sortKey:E,label:S,className:b})=>x.jsx("th",{scope:"col",className:`px-6 py-3 ${b||""}`,children:x.jsxs("button",{onClick:()=>v(E),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,_(E)]})});return x.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:x.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[x.jsx(O2,{className:"w-5 h-5"}),""]})]})}),x.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[x.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:x.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[x.jsx("input",{type:"text",placeholder:"...",value:a,onChange:E=>i(E.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),x.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),x.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),x.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),x.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:x.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[x.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:x.jsxs("tr",{children:[x.jsx(T,{sortKey:"status",label:"",className:"w-24"}),x.jsx(T,{sortKey:"actionItem",label:""}),x.jsx(T,{sortKey:"responsible",label:""}),x.jsx(T,{sortKey:"subStep",label:""}),x.jsx(T,{sortKey:"task",label:""}),x.jsx(T,{sortKey:"dueDate",label:""})]})}),x.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:E,subStep:S,task:b},k)=>x.jsxs("tr",{className:"hover:bg-slate-50",children:[x.jsx("td",{className:"px-6 py-3",children:E.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(gu,{className:"w-4 h-4 mr-1"}),""]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(Ld,{className:"w-4 h-4 mr-1"}),""]})}),x.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:E.text}),x.jsx("td",{className:"px-6 py-3",children:S.responsible||""}),x.jsx("td",{className:"px-6 py-3",children:S.text}),x.jsx("td",{className:"px-6 py-3",children:b.title}),x.jsx("td",{className:"px-6 py-3",children:E.dueDate||S.dueDate?new Date((E.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},E.id+k)),g.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},tw={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:x.jsx(pu,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:x.jsx(Di,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:x.jsx(Di,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:x.jsx(Di,{className:"w-12 h-12 text-slate-500"})}},GL=({report:t,onClose:e})=>{if(!t)return null;const n=tw[t.overallStatus]||tw.Unknown;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),x.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[x.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[x.jsx("div",{className:"flex-shrink-0",children:n.icon}),x.jsxs("div",{children:[x.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:t.overallStatus}),x.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:t.summary})]})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(pu,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),x.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:t.positivePoints.map((r,a)=>x.jsx("li",{children:r},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Di,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),x.jsx("div",{className:"space-y-3",children:t.areasOfConcern.map((r,a)=>x.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[x.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&x.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Rp,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),x.jsx("div",{className:"space-y-3",children:t.suggestions.map((r,a)=>x.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:x.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),x.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},Wi=({message:t})=>t?x.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:t})]}):null,zL=({isOpen:t,onClose:e,projectId:n,projectTitle:r,members:a,userRole:i,onMembersUpdate:l})=>{const[c,d]=U.useState(""),[f,g]=U.useState("editor"),[v,_]=U.useState([]),[T,E]=U.useState(!1),[S,b]=U.useState(!1),[k,A]=U.useState(null),C=i==="owner"||i==="editor";U.useEffect(()=>{t&&C&&M()},[t,n,C]);const M=async()=>{b(!0);try{const G=await er.getProjectInvitations(n);_(G)}catch(G){A(G instanceof Error?G.message:"")}finally{b(!1)}},B=async G=>{if(G.preventDefault(),!c.trim()){A("");return}if(a.some(te=>te.userEmail===c.trim())){A("");return}if(v.some(te=>te.email===c.trim())){A("");return}E(!0),A(null);try{await er.inviteToProject(n,c.trim(),f),d(""),await M(),l()}catch(te){A(te instanceof Error?te.message:"")}finally{E(!1)}},H=async(G,te)=>{if(i==="owner")try{await er.updateMemberRole(n,G,te),l()}catch(we){A(we instanceof Error?we.message:"")}},F=async G=>{if(i==="owner"&&confirm(""))try{await er.removeMember(n,G),l()}catch(te){A(te instanceof Error?te.message:"")}},K=G=>{const te=`${window.location.origin}/invite/${G}`;navigator.clipboard.writeText(te).then(()=>{alert("")})},P=G=>{switch(G){case"owner":return"";case"editor":return"";case"viewer":return"";default:return G}},ae=G=>{switch(G){case"owner":return"bg-purple-100 text-purple-800";case"editor":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500 mt-1",children:r})]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[k&&x.jsx(Wi,{message:k}),C&&x.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(BL,{className:"w-5 h-5 mr-2"}),""]}),x.jsx("form",{onSubmit:B,className:"space-y-3",children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[x.jsx("input",{type:"email",value:c,onChange:G=>d(G.target.value),placeholder:"",className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T}),x.jsxs("select",{value:f,onChange:G=>g(G.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T,children:[x.jsx("option",{value:"editor",children:""}),x.jsx("option",{value:"viewer",children:""})]}),x.jsxs("button",{type:"submit",disabled:T,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[T?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(Ui,{className:"w-4 h-4"}),""]})]})})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(hd,{className:"w-5 h-5 mr-2"})," (",a.length,")"]}),x.jsx("div",{className:"space-y-2",children:a.map(G=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center",children:x.jsx(hd,{className:"w-4 h-4 text-slate-600"})}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:G.userEmail}),x.jsxs("p",{className:"text-xs text-slate-500",children:[": ",new Date(G.joinedAt||G.invitedAt).toLocaleDateString("ja-JP")]})]})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[i==="owner"&&G.role!=="owner"?x.jsxs("select",{value:G.role,onChange:te=>H(G.userId,te.target.value),className:"text-xs px-2 py-1 border border-slate-300 rounded",children:[x.jsx("option",{value:"editor",children:""}),x.jsx("option",{value:"viewer",children:""})]}):x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ae(G.role)}`,children:P(G.role)}),i==="owner"&&G.role!=="owner"&&x.jsx("button",{onClick:()=>F(G.userId),className:"p-1 text-red-500 hover:text-red-700 rounded",title:"",children:x.jsx(ma,{className:"w-4 h-4"})})]})]},G.id))})]}),C&&x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(Pd,{className:"w-5 h-5 mr-2"}),""]}),S?x.jsx("div",{className:"flex justify-center py-4",children:x.jsx(Mn,{size:"md"})}):v.length===0?x.jsx("p",{className:"text-slate-500 text-sm",children:""}):x.jsx("div",{className:"space-y-2",children:v.map(G=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:G.email}),x.jsxs("p",{className:"text-xs text-slate-500",children:[P(G.role),"   : ",new Date(G.expiresAt).toLocaleDateString("ja-JP")]})]}),x.jsx("button",{onClick:()=>K(G.token),className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:""})]},G.id))})]})]}),x.jsx("footer",{className:"p-6 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700",children:""})})]})}):null},nw=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},qL=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=nw(r);r+=d;const[v,_]=nw(r),T=d>.5?1:0;return{path:[`M ${f} ${g}`,`A 1 1 0 ${T} 1 ${v} ${_}`,"L 0 0"].join(" "),color:a[c%a.length],label:l.label}});return x.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[x.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:e}),x.jsxs("div",{className:"flex-grow flex items-center",children:[x.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:l.color}}),x.jsx("span",{className:"truncate",children:l.label})]},c))})]})]})},YL=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return`${v},${_}`}).join(" ");return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("line",{x1:"0",y1:c,x2:l,y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:d}),t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return x.jsx("circle",{cx:v,cy:_,r:"2",fill:"#4a90e2"},g)})]})]})},WL=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.length>0?l/t.length*.8:0;return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(f=>x.jsxs("g",{transform:`translate(0, ${c-f/n*c})`,children:[x.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),x.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:f.toFixed(0)})]},f)),t.map((f,g)=>x.jsxs("g",{transform:`translate(${g*l/t.length+l/t.length*.1}, 0)`,children:[x.jsx("rect",{x:"0",y:c-f.value/n*c,width:d,height:f.value/n*c,fill:"#4a90e2"}),x.jsx("text",{x:d/2,y:c+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${d/2}, ${c+8})`,children:f.label})]},f.label))]})]})},JL=({subStep:t,statusColor:e})=>{var n,r;return x.jsx("div",{style:{position:"absolute",left:((n=t.position)==null?void 0:n.x)||0,top:((r=t.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${e}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:x.jsx("p",{className:`font-bold break-words ${t.status===ur.COMPLETED?"line-through text-slate-500":""}`,children:t.text})})},KL=({subSteps:t})=>{if(!t||t.length===0)return x.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const e=l=>{switch(l){case ur.COMPLETED:return"#22c55e";case ur.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=U.useMemo(()=>{const l=[];return(t||[]).forEach(c=>{var d;if((d=c==null?void 0:c.nextSubStepIds)!=null&&d.length&&c.position){const f={x:c.position.x+n,y:c.position.y+r/2};c.nextSubStepIds.forEach(g=>{const v=t.find(_=>_.id===g);if(v&&v.position){const _={x:v.position.x,y:v.position.y+r/2};l.push({id:`fc-render-${c.id}-${g}`,from:f,to:_,sourceId:c.id,targetId:g})}})}}),l},[t,n,r]),i=U.useMemo(()=>{if(!t||t.length===0)return{minX:0,minY:0,width:400,height:300};let l=0,c=0;return t.forEach(d=>{d.position&&(l=Math.max(l,d.position.x+n),c=Math.max(c,d.position.y+r))}),{minX:0,minY:0,width:l+20,height:c+20}},[t,n,r]);return x.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:x.jsxs("svg",{width:"100%",height:"100%",viewBox:`${i.minX} ${i.minY} ${i.width} ${i.height}`,children:[x.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),x.jsx("foreignObject",{x:"0",y:"0",width:i.width,height:i.height,children:x.jsx("div",{className:"flowchart-card-container",children:(t||[]).map(l=>x.jsx(JL,{subStep:l,statusColor:e(l.status)},l.id))})}),a.map(l=>x.jsx(Qc,{from:l.from,to:l.to,id:l.id},l.id))]})})},XL=({el:t,onUpdate:e,children:n,isSelected:r,onClick:a})=>x.jsx("div",{onClick:i=>{i.stopPropagation(),a()},style:{position:"absolute",left:`${t.position.x}%`,top:`${t.position.y}%`,width:`${t.position.width}%`,height:`${t.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),G2=({tasks:t,initialDeck:e,onSave:n,onClose:r,generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:c})=>{const[d,f]=U.useState(e),[g,v]=U.useState(0),[_,T]=U.useState(null),[E,S]=U.useState(!1),[b,k]=U.useState(null),[A,C]=U.useState(!1),M=U.useRef(null),B=(re,J)=>{f(D=>({...D,slides:D.slides.map(ee=>ee.id===re?{...ee,...typeof J=="function"?J(ee):ee}:ee)}))},H=re=>{const J=d.slides[re];B(J.id,{isLocked:!J.isLocked})},F=(re,J,D)=>{B(re,ee=>({elements:ee.elements.map(I=>I.id===J?{...I,...D}:I)}))},K=async()=>{S(!0),k(null);try{const re={...d,slides:d.slides.map(ee=>ee.isLocked?ee:{...ee,isLocked:void 0})},J=await wL(re),D={...J,slides:J.slides.map((ee,I)=>({...ee,isLocked:d.slides[I].isLocked}))};f(D)}catch(re){k(re instanceof Error?re.message:"")}finally{S(!1)}},P=async()=>{S(!0),k(null);try{let re;c==="project"?re=await SL(d,t,i,l):re=await _L(d,t[0],i),f(re)}catch(re){k(re instanceof Error?re.message:"")}finally{S(!1)}},ae=(re,J)=>{var D,ee,I;for(const W of t){const X=(ee=(D=W.extendedDetails)==null?void 0:D.subSteps)==null?void 0:ee.find(q=>q.id===re);if(X){const q=(I=X==null?void 0:X.actionItems)==null?void 0:I.find(oe=>oe.id===J);if(q)return q}}},G=re=>{var J,D,ee,I,W;switch(re.type){case"textbox":const X=re;return x.jsx("textarea",{value:X.content,onChange:q=>F(d.slides[g].id,re.id,{content:q.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:X.fontSize,fontWeight:X.fontWeight,textAlign:X.textAlign,color:"#333"}});case"image":{const q=re,oe=ae(q.subStepId,q.actionItemId),_e=(D=(J=oe==null?void 0:oe.report)==null?void 0:J.attachments)==null?void 0:D.find(Se=>Se.id===q.attachmentId);return _e?x.jsx("img",{src:_e.dataUrl,className:"w-full h-full object-contain",alt:_e.name}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const q=re,oe=ae(q.subStepId,q.actionItemId),_e=(ee=oe==null?void 0:oe.report)==null?void 0:ee.matrixData;return _e?x.jsx("div",{className:"p-2 overflow-auto h-full",children:x.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[x.jsx("thead",{children:x.jsx("tr",{className:"bg-slate-200",children:_e.headers.map((Se,Ee)=>x.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:Se},Ee))})}),x.jsx("tbody",{children:_e.rows.map((Se,Ee)=>x.jsx("tr",{children:Se.map((Ce,Ke)=>x.jsx("td",{className:"border border-slate-300 p-1",children:Ce},`${Ee}-${Ke}`))},Ee))})]})}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const q=re,oe=ae(q.subStepId,q.actionItemId),_e=(((W=(I=oe==null?void 0:oe.report)==null?void 0:I.matrixData)==null?void 0:W.rows)||[]).map(Se=>({label:Se[0],value:parseFloat(Se[1])||0})).filter(Se=>Se.label&&!isNaN(Se.value));if(_e.length===0)return x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(q.chartType){case"line":return x.jsx(YL,{data:_e,title:q.title});case"pie":return x.jsx(qL,{data:_e,title:q.title});case"bar":default:return x.jsx(WL,{data:_e,title:q.title})}}case"flowchart":{const q=re;return q.data&&q.data.subSteps?x.jsx(KL,{subSteps:q.data.subSteps}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},te=()=>window.print(),we=(re,J)=>{const D=JSON.stringify(re,null,2),ee=new Blob([D],{type:"application/json"}),I=URL.createObjectURL(ee),W=document.createElement("a");W.href=I,W.download=J,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(I)},Re=re=>{re==="pdf"?te():we(d,"report-deck.json"),C(!1)},ye=()=>{n(d),r()},se=d.slides[g],me=c==="project"?`: ${i}`:`: ${t[0].title}`;return x.jsxs(x.Fragment,{children:[x.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),x.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>T(null),children:[x.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[x.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:me}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsxs("button",{onClick:P,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[x.jsx(Od,{className:"w-4 h-4"})," ",E?"...":""]}),x.jsxs("button",{onClick:K,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[x.jsx(Rp,{className:"w-4 h-4"})," ",E?"...":"AI"]}),x.jsxs("div",{className:"relative",ref:M,children:[x.jsx("button",{onClick:()=>C(re=>!re),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:x.jsx(fl,{className:"w-5 h-5"})}),A&&x.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[x.jsx("button",{onClick:()=>Re("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),x.jsx("button",{onClick:()=>Re("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),x.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",x.jsx(Pr,{className:"w-5 h-5"})]}),x.jsx("button",{onClick:ye,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),b&&x.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:b}),x.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[x.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:d.slides.map((re,J)=>x.jsxs("div",{onClick:()=>v(J),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===J?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[x.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:x.jsx("button",{onClick:D=>{D.stopPropagation(),H(J)},title:re.isLocked?"":"",className:`p-1 rounded-full ${re.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:re.isLocked?x.jsx(PL,{className:"w-3 h-3"}):x.jsx(UL,{className:"w-3 h-3"})})}),x.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:re.elements.map(D=>x.jsx("div",{style:{position:"absolute",left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.width}%`,height:`${D.position.height}%`,backgroundColor:"#ccc"}},D.id))}),x.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:J+1})]},re.id))}),x.jsx("main",{className:"flex-grow flex items-center justify-center",children:se&&x.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:se.elements.map(re=>x.jsx(XL,{el:re,onUpdate:()=>{},isSelected:_===re.id,onClick:()=>T(re.id),children:G(re)},re.id))})}),x.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[x.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),x.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),x.jsx("div",{className:"hidden print:block",children:d.slides.map((re,J)=>x.jsx("div",{className:"slide-print-page bg-white relative",children:x.jsx("div",{className:"w-full h-full relative",children:re.elements.map(D=>x.jsx("div",{style:{position:"absolute",left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.width}%`,height:`${D.position.height}%`},children:G(D)},D.id))})},re.id))})]})},ZL=({onClose:t,onDownloadAndStartNew:e,onStartNewWithoutSaving:n})=>x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[x.jsx(Di,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:x.jsx(Pr,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"p-6",children:[x.jsx("p",{className:"text-slate-700",children:""}),x.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),x.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),x.jsxs("button",{type:"submit",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[x.jsx(fl,{className:"w-4 h-4"}),""]})]})]})});function QL(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),e&&(r.href=e),a.href=t,a.href}const eO=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Zs(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let qo=null;function z2(t={}){return qo||(t.includeStyleProperties?(qo=t.includeStyleProperties,qo):(qo=Zs(window.getComputedStyle(document.documentElement)),qo))}function md(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function tO(t){const e=md(t,"border-left-width"),n=md(t,"border-right-width");return t.clientWidth+e+n}function nO(t){const e=md(t,"border-top-width"),n=md(t,"border-bottom-width");return t.clientHeight+e+n}function q2(t,e={}){const n=e.width||tO(t),r=e.height||nO(t);return{width:n,height:r}}function rO(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Ir=16384;function aO(t){(t.width>Ir||t.height>Ir)&&(t.width>Ir&&t.height>Ir?t.width>t.height?(t.height*=Ir/t.width,t.width=Ir):(t.width*=Ir/t.height,t.height=Ir):t.width>Ir?(t.height*=Ir/t.width,t.width=Ir):(t.width*=Ir/t.height,t.height=Ir))}function pd(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function sO(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function iO(t,e,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${e}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${e} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(t),sO(a)}const Sr=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||Sr(n,e)};function oO(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function lO(t,e){return z2(e).map(n=>{const r=t.getPropertyValue(n),a=t.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function cO(t,e,n,r){const a=`.${t}:${e}`,i=n.cssText?oO(n):lO(n,r);return document.createTextNode(`${a}{${i}}`)}function rw(t,e,n,r){const a=window.getComputedStyle(t,n),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=eO();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(cO(l,n,a,r)),e.appendChild(c)}function uO(t,e,n){rw(t,e,":before",n),rw(t,e,":after",n)}const aw="application/font-woff",sw="image/jpeg",fO={woff:aw,woff2:aw,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:sw,jpeg:sw,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function dO(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function Dp(t){const e=dO(t).toLowerCase();return fO[e]||""}function hO(t){return t.split(/,/)[1]}function Xm(t){return t.search(/^(data:)/)!==-1}function mO(t,e){return`data:${e};base64,${t}`}async function Y2(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const c=new FileReader;c.onerror=l,c.onloadend=()=>{try{i(n({res:r,result:c.result}))}catch(d){l(d)}},c.readAsDataURL(a)})}const cm={};function pO(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function Mp(t,e,n){const r=pO(t,e,n.includeQueryParams);if(cm[r]!=null)return cm[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let a;try{const i=await Y2(t,n.fetchRequestInit,({res:l,result:c})=>(e||(e=l.headers.get("Content-Type")||""),hO(c)));a=mO(i,e)}catch(i){a=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return cm[r]=a,a}async function gO(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):pd(e)}async function xO(t,e){if(t.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=t.clientWidth,i.height=t.clientHeight,l==null||l.drawImage(t,0,0,i.width,i.height);const c=i.toDataURL();return pd(c)}const n=t.poster,r=Dp(n),a=await Mp(n,r,e);return pd(a)}async function vO(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await Ud(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function yO(t,e){return Sr(t,HTMLCanvasElement)?gO(t):Sr(t,HTMLVideoElement)?xO(t,e):Sr(t,HTMLIFrameElement)?vO(t,e):t.cloneNode(W2(t))}const _O=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",W2=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function wO(t,e,n){var r,a;if(W2(e))return e;let i=[];return _O(t)&&t.assignedNodes?i=Zs(t.assignedNodes()):Sr(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?i=Zs(t.contentDocument.body.childNodes):i=Zs(((a=t.shadowRoot)!==null&&a!==void 0?a:t).childNodes),i.length===0||Sr(t,HTMLVideoElement)||await i.reduce((l,c)=>l.then(()=>Ud(c,n)).then(d=>{d&&e.appendChild(d)}),Promise.resolve()),e}function TO(t,e,n){const r=e.style;if(!r)return;const a=window.getComputedStyle(t);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):z2(n).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),Sr(t,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function EO(t,e){Sr(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),Sr(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function SO(t,e){if(Sr(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(a=>t.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function bO(t,e,n){return Sr(e,Element)&&(TO(t,e,n),uO(t,e,n),EO(t,e),SO(t,e)),e}async function CO(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let i=0;i<n.length;i++){const c=n[i].getAttribute("xlink:href");if(c){const d=t.querySelector(c),f=document.querySelector(c);!d&&f&&!r[c]&&(r[c]=await Ud(f,e,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const c=document.createElementNS(i,"defs");l.appendChild(c);for(let d=0;d<a.length;d++)c.appendChild(a[d]);t.appendChild(l)}return t}async function Ud(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>yO(r,e)).then(r=>wO(t,r,e)).then(r=>bO(t,r,e)).then(r=>CO(r,e))}const J2=/url\((['"]?)([^'"]+?)\1\)/g,AO=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,kO=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function NO(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function RO(t){const e=[];return t.replace(J2,(n,r,a)=>(e.push(a),n)),e.filter(n=>!Xm(n))}async function DO(t,e,n,r,a){try{const i=n?QL(e,n):e,l=Dp(e);let c;return a||(c=await Mp(i,l,r)),t.replace(NO(e),`$1${c}$3`)}catch{}return t}function MO(t,{preferredFontFormat:e}){return e?t.replace(kO,n=>{for(;;){const[r,,a]=AO.exec(n)||[];if(!a)return"";if(a===e)return`src: ${r};`}}):t}function K2(t){return t.search(J2)!==-1}async function X2(t,e,n){if(!K2(t))return t;const r=MO(t,n);return RO(r).reduce((i,l)=>i.then(c=>DO(c,l,e,n)),Promise.resolve(r))}async function Yo(t,e,n){var r;const a=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(a){const i=await X2(a,null,n);return e.style.setProperty(t,i,e.style.getPropertyPriority(t)),!0}return!1}async function IO(t,e){await Yo("background",t,e)||await Yo("background-image",t,e),await Yo("mask",t,e)||await Yo("-webkit-mask",t,e)||await Yo("mask-image",t,e)||await Yo("-webkit-mask-image",t,e)}async function FO(t,e){const n=Sr(t,HTMLImageElement);if(!(n&&!Xm(t.src))&&!(Sr(t,SVGImageElement)&&!Xm(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,a=await Mp(r,Dp(r),e);await new Promise((i,l)=>{t.onload=i,t.onerror=e.onImageErrorHandler?(...d)=>{try{i(e.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const c=t;c.decode&&(c.decode=i),c.loading==="lazy"&&(c.loading="eager"),n?(t.srcset="",t.src=a):t.href.baseVal=a})}async function LO(t,e){const r=Zs(t.childNodes).map(a=>Z2(a,e));await Promise.all(r).then(()=>t)}async function Z2(t,e){Sr(t,Element)&&(await IO(t,e),await FO(t,e),await LO(t,e))}function OO(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),t}const iw={};async function ow(t){let e=iw[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},iw[t]=e,e}async function lw(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),Y2(c,e.fetchRequestInit,({result:d})=>(n=n.replace(l,`url(${d})`),[l,d]))});return Promise.all(i).then(()=>n)}function cw(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;e.push(d[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(l,"gi");for(;;){let d=i.exec(r);if(d===null){if(d=c.exec(r),d===null)break;i.lastIndex=c.lastIndex}else c.lastIndex=i.lastIndex;e.push(d[0])}return e}async function PO(t,e){const n=[],r=[];return t.forEach(a=>{if("cssRules"in a)try{Zs(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let c=l+1;const d=i.href,f=ow(d).then(g=>lw(g,e)).then(g=>cw(g).forEach(v=>{try{a.insertRule(v,v.startsWith("@import")?c+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:v,error:_})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(f)}})}catch(i){const l=t.find(c=>c.href==null)||document.styleSheets[0];a.href!=null&&r.push(ow(a.href).then(c=>lw(c,e)).then(c=>cw(c).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(t.forEach(a=>{if("cssRules"in a)try{Zs(a.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),n))}function UO(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>K2(e.style.getPropertyValue("src")))}async function BO(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Zs(t.ownerDocument.styleSheets),r=await PO(n,e);return UO(r)}function Q2(t){return t.trim().replace(/["']/g,"")}function jO(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{e.add(Q2(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&n(i)})}return n(t),e}async function VO(t,e){const n=await BO(t,e),r=jO(t);return(await Promise.all(n.filter(i=>r.has(Q2(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return X2(i.cssText,l,e)}))).join(`
`)}async function $O(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await VO(t,e);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function HO(t,e={}){const{width:n,height:r}=q2(t,e),a=await Ud(t,e,!0);return await $O(a,e),await Z2(a,e),OO(a,e),await iO(a,n,r)}async function GO(t,e={}){const{width:n,height:r}=q2(t,e),a=await HO(t,e),i=await pd(a),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.pixelRatio||rO(),f=e.canvasWidth||n,g=e.canvasHeight||r;return l.width=f*d,l.height=g*d,e.skipAutoScale||aO(l),l.style.width=`${f}`,l.style.height=`${g}`,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,l.width,l.height)),c.drawImage(i,0,0,l.width,l.height),l}async function zO(t,e={}){return(await GO(t,e)).toDataURL()}const kc=40,uw=64,fw=320,dw=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],qO=({data:t,onClose:e,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[i,l]=U.useState(!0),[c,d]=U.useState(new Set),[f,g]=U.useState("all"),v=U.useRef(null),[_,T]=U.useState(!1),[E,S]=U.useState("day"),[b,k]=U.useState({start:"",end:""}),C={day:40,week:15,month:5}[E],M=U.useMemo(()=>{const re=new Map;return t.filter(J=>J.type==="task").forEach((J,D)=>{re.set(J.id,dw[D%dw.length])}),re},[t]),B=U.useCallback((re,J)=>{if(re.type==="task")return re.id;let D=re;for(;D.parentId;){const ee=J.get(D.parentId);if(!ee)return null;if(ee.type==="task")return ee.id;D=ee}return null},[]),H=U.useMemo(()=>new Map(t.map(re=>[re.id,re])),[t]),F=U.useCallback(re=>{const J=B(re,H);return J&&M.get(J)||"#9CA3AF"},[H,M,B]);U.useEffect(()=>{const re=new Set(t.filter(J=>J.type==="task").map(J=>J.id));d(re)},[t]);const K=re=>{d(J=>{const D=new Set(J);return D.has(re)?D.delete(re):D.add(re),D})},P=U.useMemo(()=>{const re=[];return t.filter(D=>D.type==="task").forEach(D=>{re.push(D),c.has(D.id)&&t.filter(I=>I.type==="substep"&&I.parentId===D.id).forEach(I=>{if(re.push(I),c.has(I.id)){const W=t.filter(X=>{if(X.type!=="actionitem"||X.parentId!==I.id)return!1;if(f==="all")return!0;const q=X.progress===100;return f==="completed"?q:f==="pending"?!q:!0});re.push(...W)}})}),re},[t,c,f]),{timelineStart:ae,totalDays:G}=U.useMemo(()=>{if(t.length===0)return{timelineStart:new Date,totalDays:30};const re=t.map(q=>new Date(q.start)).filter(q=>!isNaN(q.getTime())),J=t.map(q=>new Date(q.end)).filter(q=>!isNaN(q.getTime()));let D,ee;re.length===0||J.length===0?(D=new Date,ee=new Date,ee.setMonth(ee.getMonth()+1)):(D=new Date(Math.min(...re.map(q=>q.getTime()))),ee=new Date(Math.max(...J.map(q=>q.getTime()))));let I=b.start?new Date(b.start):D,W=b.end?new Date(b.end):ee;isNaN(I.getTime())&&(I=D),isNaN(W.getTime())&&(W=ee),W<I&&(W=I),I.setDate(I.getDate()-2),W.setDate(W.getDate()+5);const X=(W.getTime()-I.getTime())/(1e3*3600*24);return{timelineStart:I,totalDays:Math.ceil(X)}},[t,b]),te=U.useMemo(()=>{const re=ee=>{ee=new Date(Date.UTC(ee.getFullYear(),ee.getMonth(),ee.getDate())),ee.setUTCDate(ee.getUTCDate()+4-(ee.getUTCDay()||7));const I=new Date(Date.UTC(ee.getUTCFullYear(),0,1));return Math.ceil(((ee.getTime()-I.getTime())/864e5+1)/7)},J=[];let D=new Date(ae);if(E==="day")for(let ee=0;ee<G;ee++)J.push({secondaryLabel:D.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(D.getDate()),width:C}),D.setDate(D.getDate()+1);else if(E==="week")for(let ee=0;ee<G;ee++)(D.getDay()===1||J.length===0)&&J.push({label:`W${re(D)}`,secondaryLabel:D.toLocaleDateString("ja-JP",{month:"short"}),width:0}),J[J.length-1].width+=C,D.setDate(D.getDate()+1);else if(E==="month"){let ee=-1;for(let I=0;I<G;I++){const W=D.getMonth();W!==ee&&(ee=W,J.push({label:D.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),J[J.length-1].width+=C,D.setDate(D.getDate()+1)}}return J},[ae,G,E,C]),we=re=>{const J=new Date(re);return isNaN(J.getTime())?-1:(J.getTime()-ae.getTime())/(1e3*3600*24)},Re=re=>{switch(re){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},ye=re=>t.some(J=>J.parentId===re),se=U.useCallback(()=>{if(v.current===null){alert("");return}T(!0),zO(v.current,{cacheBust:!0,backgroundColor:"#ffffff",width:v.current.scrollWidth,height:v.current.scrollHeight}).then(re=>{const J=document.createElement("a");J.download="gantt-chart.png",J.href=re,J.click()}).catch(re=>{console.error("",re),alert("")}).finally(()=>{T(!1)})},[]),me=U.useMemo(()=>te.reduce((re,J)=>re+J.width,0),[te]);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[x.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),x.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(re=>x.jsx("button",{onClick:()=>S(re),className:`px-3 py-1 text-xs capitalize rounded-md ${E===re?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:re},re))})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),x.jsx("input",{type:"date",value:b.start,onChange:re=>k(J=>({...J,start:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("span",{children:"-"}),x.jsx("input",{type:"date",value:b.end,onChange:re=>k(J=>({...J,end:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("button",{onClick:()=>k({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),x.jsxs("button",{onClick:se,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(fl,{className:"w-4 h-4"}),"PNG"]}),x.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[x.jsx(Pr,{className:"w-5 h-5"}),""]})]})]}),x.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${f==="all"?"bg-white shadow-sm":""}`,children:""}),x.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${f==="pending"?"bg-white shadow-sm":""}`,children:""}),x.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${f==="completed"?"bg-white shadow-sm":""}`,children:""})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(Od,{className:"w-4 h-4"}),"AI"]}),x.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:i,onChange:()=>l(re=>!re),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),x.jsx("div",{className:"flex-grow overflow-auto relative",children:x.jsxs("div",{ref:v,className:"grid",style:{gridTemplateColumns:`${fw}px 1fr`,width:`${fw+me}px`},children:[x.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:uw},children:" / "}),x.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:uw},children:x.jsx("div",{className:"flex h-full",children:te.map((re,J)=>x.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:re.width},children:[re.secondaryLabel&&x.jsx("span",{className:"font-semibold text-slate-600",children:re.secondaryLabel}),x.jsx("div",{className:`font-bold text-slate-800 ${E==="day"?"text-lg":"text-sm"}`,children:re.label})]},J))})}),x.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${P.length}`},children:te.map((re,J)=>x.jsx("div",{className:"h-full border-r border-slate-200",style:{width:re.width}},J))}),P.map((re,J)=>{const D=F(re),ee=(()=>{const _e=P[J+1];return _e?B(re,H)!==B(_e,H):!0})(),I=we(re.start),W=Math.max(.2,we(re.end)-I+1),X=I*C,q=W*C,oe={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return x.jsxs(ls.Fragment,{children:[x.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:J+2,height:kc,borderBottom:ee?`2px solid ${D}`:"1px solid #e5e7eb"},children:[x.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:D}}),x.jsxs("div",{className:`flex items-center w-full ${Re(re.type)}`,children:[(re.type==="task"||re.type==="substep")&&(ye(re.id)?x.jsx(OL,{onClick:()=>K(re.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${c.has(re.id)?"rotate-0":"-rotate-90"}`}):x.jsx("div",{className:"w-4 h-4 mr-1"})),re.type==="actionitem"&&(re.progress===100?x.jsx(gu,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):x.jsx(Ld,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),x.jsx("span",{onClick:()=>n==null?void 0:n(re),className:`truncate text-xs ${re.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:re.name,children:re.name})]})]}),x.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:J+2,borderBottom:ee?`2px solid ${D}`:"1px solid #e5e7eb"},children:I>=0&&x.jsx("div",{title:`${re.name} (${re.progress}%)`,onClick:()=>n==null?void 0:n(re),className:"absolute h-full flex items-center group",style:{left:X,width:q,cursor:n?"pointer":"default"},children:x.jsx("div",{className:"w-full rounded",style:{...oe[re.type],backgroundColor:D},children:x.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${re.progress}%`}})})})})]},re.id)}),x.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${P.length}`,position:"relative",pointerEvents:"none"},children:i&&x.jsx(YO,{items:P,getDaysFromStart:we,dayWidth:C})})]})})]})})},YO=({items:t,getDaysFromStart:e,dayWidth:n})=>{const r=U.useMemo(()=>{const a=[],i=new Map(t.map((l,c)=>[l.id,c]));return t.forEach((l,c)=>{(l.dependencies||[]).forEach(d=>{const f=i.get(d),g=f!==void 0?t[f]:void 0;if(g&&f!==void 0){const v=e(g.end),_=e(l.start);if(v<0||_<0)return;const T=(v+1)*n,E=f*kc+kc/2,S=_*n,b=c*kc+kc/2,k=T+20,A=S-20,C=`M ${T} ${E} C ${k} ${E}, ${A} ${b}, ${S} ${b}`;a.push({key:`${d}-${l.id}`,d:C})}})}),a},[t,e,n]);return x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[x.jsx("defs",{children:x.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:x.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>x.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},WO=({tasks:t,projectGoal:e,targetDate:n,ganttData:r,projectReportDeck:a,onClose:i,onReportGenerated:l,generateUniqueId:c})=>{const[d,f]=U.useState("list"),[g,v]=U.useState(new Set),[_,T]=U.useState(""),[E,S]=U.useState(!1),[b,k]=U.useState(null),[A,C]=U.useState({key:"taskName",direction:"ascending"}),[M,B]=U.useState("slides"),[H,F]=U.useState(null),K=U.useMemo(()=>{const D=[];return r&&D.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:r}}),a&&D.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:a}}),t.forEach(ee=>{var I,W,X,q,oe;(I=ee.extendedDetails)!=null&&I.reportDeck&&D.push({id:`task-report-${ee.id}`,name:`: ${ee.title}`,type:"Task Report",taskName:ee.title,subStepName:"",actionItemName:"",source:{name:`: ${ee.title}`,type:"json",content:ee.extendedDetails.reportDeck}}),(X=(W=ee.extendedDetails)==null?void 0:W.attachments)==null||X.forEach(_e=>{D.push({id:_e.id,name:_e.name,type:"Attachment",taskName:ee.title,subStepName:"",actionItemName:"",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl,dataUrl:_e.dataUrl}})}),(oe=(q=ee.extendedDetails)==null?void 0:q.subSteps)==null||oe.forEach(_e=>{var Se,Ee;(Se=_e.attachments)==null||Se.forEach(Ce=>{D.push({id:Ce.id,name:Ce.name,type:"Attachment",taskName:ee.title,subStepName:_e.text,actionItemName:"",source:{name:Ce.name,type:Ce.type.startsWith("image/")?"image":"text",content:Ce.dataUrl,dataUrl:Ce.dataUrl}})}),(Ee=_e.actionItems)==null||Ee.forEach(Ce=>{var Ke,Z,ft;(Z=(Ke=Ce.report)==null?void 0:Ke.attachments)==null||Z.forEach(Xe=>{D.push({id:Xe.id,name:Xe.name,type:"Attachment",taskName:ee.title,subStepName:_e.text,actionItemName:Ce.text,source:{name:Xe.name,type:Xe.type.startsWith("image/")?"image":"text",content:Xe.dataUrl,dataUrl:Xe.dataUrl}})}),(ft=Ce.report)!=null&&ft.matrixData&&D.push({id:`matrix-${Ce.id}`,name:`: ${Ce.text}`,type:"Data Matrix",taskName:ee.title,subStepName:_e.text,actionItemName:Ce.text,source:{name:`: ${Ce.text}`,type:"json",content:Ce.report.matrixData}})})})}),D},[t,r,a]),P=U.useMemo(()=>{let D=[...K];return A!==null&&D.sort((ee,I)=>{const W=(ee[A.key]||"").toLowerCase(),X=(I[A.key]||"").toLowerCase();return W<X?A.direction==="ascending"?-1:1:W>X?A.direction==="ascending"?1:-1:0}),D},[K,A]),ae=D=>{let ee="ascending";A&&A.key===D&&A.direction==="ascending"&&(ee="descending"),C({key:D,direction:ee})},G=D=>!A||A.key!==D?x.jsx(ji,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):A.direction==="ascending"?x.jsx(Xc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(ji,{className:"w-3 h-3 ml-1 text-blue-600"}),te=D=>{v(ee=>{const I=new Set(ee);return I.has(D)?I.delete(D):I.add(D),I})},we=()=>{g.size===K.length?v(new Set):v(new Set(K.map(D=>D.id)))},Re=async()=>{if(g.size===0){k("1");return}if(!_.trim()){k("");return}S(!0),k(null),F(null);const D=K.filter(ee=>g.has(ee.id)).map(ee=>ee.source);try{if(M==="slides"){const ee=await L2(D,_);l(ee)}else{const ee=await CL(D,_);F(ee)}}catch(ee){k(ee instanceof Error?ee.message:"")}finally{S(!1)}},ye=D=>{switch(D){case"Gantt Chart":return x.jsx(H2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return x.jsx(B2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return x.jsx(Xs,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(xu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Bi,{className:"w-5 h-5 text-slate-500"})}},se=D=>{if(D.dataUrl)return D.dataUrl;if(D.type==="json")try{const ee=JSON.stringify(D.content,null,2),I=new Blob([ee],{type:"application/json"});return URL.createObjectURL(I)}catch{return}},me=U.useMemo(()=>K.filter(D=>g.has(D.id)),[g,K]),re=()=>x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:x.jsx("input",{type:"checkbox",checked:g.size===K.length&&K.length>0,onChange:we,className:"w-4 h-4 accent-blue-600"})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),G("name")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-40",children:x.jsxs("button",{onClick:()=>ae("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),G("type")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),G("taskName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),G("subStepName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ae("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:""}),G("actionItemName")]})})]})}),x.jsx("tbody",{children:P.map(D=>{const ee=se(D.source);return x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:x.jsx("input",{type:"checkbox",checked:g.has(D.id),onChange:()=>te(D.id),className:"w-4 h-4 accent-blue-600"})}),x.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:ee?x.jsx("a",{href:ee,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:D.name}):x.jsx("span",{children:D.name})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:x.jsxs("div",{className:"flex items-center gap-2",children:[ye(D.type),x.jsx("span",{children:D.type})]})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.taskName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.subStepName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.actionItemName})]},D.id)})})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",K.length," "]}),x.jsx("button",{onClick:()=>f("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),J=()=>x.jsxs(x.Fragment,{children:[x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",me.length,")"]}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:me.map(D=>x.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[ye(D.type),x.jsx("span",{className:"truncate",title:D.name,children:D.name})]},D.id))}),x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:M==="slides",onChange:()=>B("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:M==="text",onChange:()=>B("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),x.jsx("textarea",{value:_,onChange:D=>T(D.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),b&&x.jsx("div",{className:"mt-2",children:x.jsx(Wi,{message:b})}),H&&x.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[x.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),x.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:H}),x.jsx("button",{onClick:()=>navigator.clipboard.writeText(H),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("button",{onClick:()=>{f("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[x.jsx(O2,{className:"w-4 h-4"}),""]}),x.jsxs("button",{onClick:Re,disabled:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[E?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(wl,{className:"w-5 h-5"}),x.jsx("span",{children:E?"...":""})]})]})]});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[x.jsx(Bi,{className:"w-7 h-7 text-blue-600"}),x.jsx("span",{children:""})]}),x.jsx("button",{onClick:i,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),d==="list"?re():J()]})})},JO=({tasks:t,projectGoal:e,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:i,onUpdateTaskStatus:l,onStartNewProject:c,onExportProject:d,onAddTask:f,onRemoveTask:g,onImportSingleTask:v,onAutoLayout:_,onUndo:T,canUndo:E,onRedo:S,canRedo:b,generateUniqueId:k,onUpdateTaskConnections:A,ganttData:C,setGanttData:M,onCustomReportGenerated:B,onClearApiKey:H,onOpenProjectList:F,onLogout:K,currentProjectId:P,onSaveProject:ae,projectMembers:G=[],userRole:te="viewer",onMembersUpdate:we=()=>{}})=>{U.useRef(null);const Re=U.useRef(null),[ye,se]=U.useState(new Map),[me,re]=U.useState([]),J=U.useRef(null),D=U.useRef({x:0,y:0}),[ee,I]=U.useState(!1),[W,X]=U.useState(!1),[q,oe]=U.useState(null),[_e,Se]=U.useState(!1),[Ee,Ce]=U.useState(null),[Ke,Z]=U.useState(!1),[ft,Xe]=U.useState(null),[wt,rt]=U.useState(!1),[Fe,Ut]=U.useState(null),[cn,rn]=U.useState(!1),[an,Ln]=U.useState(!1),[Tt,en]=U.useState(null),[Hn,vn]=U.useState(!1),[Zt,Dt]=U.useState(!1),[it,tt]=U.useState(!1),[Et,sn]=U.useState(null),[Me,Ye]=U.useState({x:0,y:0}),[Ge,We]=U.useState(!1);U.useEffect(()=>{const R=new Map;t.forEach(j=>{R.set(j.id,ye.get(j.id)||U.createRef())}),se(R)},[t]);const nt=U.useCallback(()=>{if(!Re.current||ye.size===0){re([]);return}const R=[];t.forEach(j=>{var O,V;if(j.nextTaskIds&&j.nextTaskIds.length>0){const z=ye.get(j.id),Y=z==null?void 0:z.current;if(!Y)return;const ue=((O=j.position)==null?void 0:O.x)||0,ve=((V=j.position)==null?void 0:V.y)||0,le=Y.getBoundingClientRect(),de={x:ue+le.width,y:ve+le.height/2};j.nextTaskIds.forEach(pe=>{var Pe,je;const De=t.find(lt=>lt.id===pe);if(!De)return;const Le=ye.get(pe),Ue=Le==null?void 0:Le.current;if(!Ue)return;const Ie=((Pe=De.position)==null?void 0:Pe.x)||0,Q=((je=De.position)==null?void 0:je.y)||0,Te=Ue.getBoundingClientRect(),ke={x:Ie,y:Q+Te.height/2};R.push({id:`conn-${j.id}-${pe}`,from:de,to:ke,sourceId:j.id,targetId:pe})})}}),re(R)},[t,ye]);U.useEffect(()=>{const R=setTimeout(nt,50);return()=>clearTimeout(R)},[nt,t]),U.useEffect(()=>{window.addEventListener("resize",nt);const R=new MutationObserver(nt);return Re.current&&R.observe(Re.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",nt),R.disconnect()}},[nt]);const lr=(R,j)=>{var V,z;J.current=j;const O=t.find(Y=>Y.id===j);if(Re.current){const Y=Re.current.getBoundingClientRect();D.current.x=R.clientX-Y.left-(((V=O==null?void 0:O.position)==null?void 0:V.x)||0),D.current.y=R.clientY-Y.top-(((z=O==null?void 0:O.position)==null?void 0:z.y)||0)}R.dataTransfer.effectAllowed="move"},Ur=R=>{R.preventDefault(),R.dataTransfer.dropEffect="move"},Ua=R=>{var de;if(R.preventDefault(),!J.current||!Re.current)return;const j=Re.current.getBoundingClientRect(),O=(de=ye.get(J.current))==null?void 0:de.current,V=(O==null?void 0:O.offsetWidth)||380,z=(O==null?void 0:O.offsetHeight)||280;let Y=R.clientX-j.left-D.current.x,ue=R.clientY-j.top-D.current.y;const ve=Re.current.scrollWidth,le=Re.current.scrollHeight;Y=Math.max(0,Math.min(Y,ve-V)),ue=Math.max(0,Math.min(ue,le-z)),i(J.current,{x:Y,y:ue}),J.current=null,setTimeout(nt,0)},Ba=async()=>{Se(!0),Ce(null);try{const R=await TL(t,e,n);oe(R),X(!0)}catch(R){Ce(R instanceof Error?R.message:"")}finally{Se(!1)}},ta=async()=>{if(ft){Z(!0);return}rt(!0),Ut(null);try{const R=await EL(t,e,n);Xe(R),Z(!0)}catch(R){Ut(R instanceof Error?R.message:"")}finally{rt(!1)}},xa=async()=>{if(C){rn(!0);return}Ln(!0),en(null);try{const R=await ew(t,e,n);M(R),rn(!0)}catch(R){en(R instanceof Error?R.message:"")}finally{Ln(!1)}},ps=async()=>{Ln(!0),en(null);try{const R=await ew(t,e,n);M(R)}catch(R){en(R instanceof Error?R.message:"")}finally{Ln(!1)}},gs=async()=>{if(P){We(!0);try{await ae(),alert("")}catch(R){alert(": "+(R instanceof Error?R.message:""))}finally{We(!1)}}else{const R=prompt(":",`${e.substring(0,50)}...`);if(!R)return;We(!0);try{const j=await er.createProject(R,e,n,t,C);alert(""),we()}catch(j){alert(": "+(j instanceof Error?j.message:""))}finally{We(!1)}}},ja=(R,j)=>{if(!Re.current)return;const O=Re.current.getBoundingClientRect(),V={x:j.clientX-O.left+Re.current.scrollLeft,y:j.clientY-O.top+Re.current.scrollTop};sn({fromId:R,fromPos:V})},Va=R=>{if(!Et||Et.fromId===R){sn(null);return}const j=t.find(O=>O.id===Et.fromId);if(j){const O=Array.from(new Set([...j.nextTaskIds||[],R]));A(j.id,O)}sn(null)},xs=(R,j)=>{const O=t.find(V=>V.id===R);if(O){const V=(O.nextTaskIds||[]).filter(z=>z!==j);A(O.id,V)}},si=R=>{if(!Et||!Re.current)return;const j=Re.current.getBoundingClientRect();Ye({x:R.clientX-j.left+Re.current.scrollLeft,y:R.clientY-j.top+Re.current.scrollTop})},xr=()=>{Et&&sn(null)},un=R=>{const j=R.type==="task"?R.id:R.parentId;if(!j)return;const O=t.find(V=>V.id===j);O&&(rn(!1),r(O))},fn=R=>{B(R),Dt(!1)},Br=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"",gt=te==="owner"||te==="editor",vs=te==="owner"||te==="editor";return Ke&&ft?x.jsx(G2,{tasks:t,initialDeck:ft,onSave:R=>Xe(R),onClose:()=>Z(!1),projectGoal:e,targetDate:n,reportScope:"project",generateUniqueId:k}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[x.jsxs("div",{className:"max-w-full mx-auto w-full",children:[x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[x.jsxs("button",{onClick:()=>vn(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[x.jsx(Ui,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx("button",{onClick:F,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"",children:x.jsx(Bi,{className:"w-5 h-5"})}),x.jsx("button",{onClick:gs,disabled:Ge,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"",children:Ge?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(fl,{className:"w-5 h-5"})}),x.jsx("button",{onClick:T,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:x.jsx(j2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:S,disabled:!b,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:x.jsx(V2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:H,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:x.jsx(Zc,{className:"w-5 h-5 text-yellow-600"})}),x.jsx("button",{onClick:K,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"",children:x.jsx(Zc,{className:"w-5 h-5"})}),x.jsxs("button",{onClick:f,disabled:!gt,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",title:gt?"":"",children:[x.jsx(Np,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(fl,{className:"w-5 h-5 mr-2"}),"JSON"]}),x.jsxs("button",{onClick:_,disabled:!gt,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",title:gt?"":"",children:[x.jsx(Od,{className:"w-5 h-5 mr-2"}),""]})]})]}),x.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),x.jsxs("div",{className:"space-y-2 text-slate-700",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(kp,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),x.jsx("strong",{children:":"}),"",x.jsx("span",{className:"break-all",children:e})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Ap,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),x.jsx("strong",{children:":"}),"",Br]}),P&&x.jsx("p",{className:"text-sm text-green-600",children:" Supabase"}),G.length>1&&x.jsxs("div",{className:"flex items-center text-sm text-slate-600 mt-2",children:[x.jsx(hd,{className:"w-4 h-4 mr-1"}),x.jsxs("span",{children:[G.length,""]}),x.jsx("span",{className:"mx-2",children:""}),x.jsxs("span",{children:[": ",te==="owner"?"":te==="editor"?"":""]})]})]})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[vs&&P&&x.jsxs("button",{onClick:()=>tt(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(hd,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:()=>I(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx($2,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:()=>Dt(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(Bi,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:xa,disabled:an,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[an?x.jsx(Mn,{size:"sm"}):x.jsx(H2,{className:"w-5 h-5 mr-2"}),""]}),x.jsxs("button",{onClick:Ba,disabled:_e,title:gt?"":"",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[_e?x.jsx(Mn,{size:"sm"}):x.jsx(wl,{className:"w-5 h-5 mr-2"}),"AI"]}),x.jsxs("button",{onClick:ta,disabled:wt,title:gt?"":"",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[wt?x.jsx(Mn,{size:"sm"}):x.jsx(B2,{className:"w-5 h-5 mr-2"}),""]})]})]}),Ee&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Ee})}),Fe&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Fe})}),Tt&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Tt})})]})]}),x.jsxs("div",{ref:Re,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:Ur,onDrop:Ua,onMouseMove:si,onMouseUp:xr,children:[x.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[t.map((R,j)=>x.jsx($L,{cardRef:ye.get(R.id),task:R,onSelectTask:r,onRemoveTask:g,onUpdateStatus:l,onDragCardStart:lr,onStartConnection:ja,onEndConnection:Va,index:j,canEdit:gt},R.id)),me.map(R=>x.jsx(Qc,{from:R.from,to:R.to,id:R.id,onDelete:()=>xs(R.sourceId,R.targetId)},R.id)),Et&&x.jsx(Qc,{from:Et.fromPos,to:Me,id:"preview-connector"})]}),t.length===0&&x.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:x.jsx("p",{className:"text-slate-500 text-lg",children:""})})]})]}),cn&&C&&x.jsx(qO,{data:C,onClose:()=>rn(!1),onItemClick:un,onRegenerate:ps,isRegenerating:an}),Zt&&x.jsx(WO,{tasks:t,projectGoal:e,targetDate:n,ganttData:C,projectReportDeck:ft,onClose:()=>Dt(!1),onReportGenerated:fn,generateUniqueId:k}),ee&&x.jsx(HL,{tasks:t,onClose:()=>I(!1)}),W&&x.jsx(GL,{report:q,onClose:()=>X(!1)}),Hn&&x.jsx(ZL,{onClose:()=>vn(!1),onDownloadAndStartNew:()=>{d(),c()},onStartNewWithoutSaving:c}),it&&P&&x.jsx(zL,{isOpen:it,onClose:()=>tt(!1),projectId:P,projectTitle:e,members:G,userRole:te,onMembersUpdate:we})]})},KO=({proposals:t,existingSubSteps:e,onConfirm:n,onClose:r})=>{const[a,i]=U.useState(()=>{const d={};return t.forEach((f,g)=>{d[g]={decision:"NEW",targetSubStepId:void 0}}),d}),l=(d,f,g)=>{i(v=>({...v,[d]:{...v[d],[f]:g}}))},c=()=>{const d=[],f=[];Object.entries(a).forEach(([g,v])=>{const _=parseInt(g,10),T=t[_];v.decision==="NEW"?d.push(T):v.decision==="ADD"&&v.targetSubStepId&&f.push({targetSubStepId:v.targetSubStepId,title:T.title})}),n({newSubSteps:d,newActionItems:f})};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),x.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[x.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),x.jsx("div",{className:"space-y-3",children:t.map((d,f)=>x.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[x.jsx("p",{className:"font-semibold text-slate-800",children:d.title}),x.jsx("p",{className:"text-sm text-slate-600 mb-3",children:d.description}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("select",{value:a[f].decision,onChange:g=>l(f,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"NEW",children:""}),e.length>0&&x.jsx("option",{value:"ADD",children:""}),x.jsx("option",{value:"IGNORE",children:""})]}),a[f].decision==="ADD"&&x.jsxs("select",{value:a[f].targetSubStepId||"",onChange:g=>l(f,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"",disabled:!0,children:"..."}),e.map(g=>x.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},f))})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var eE=1252,XO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ip={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fp=function(t){XO.indexOf(t)!=-1&&(eE=Ip[0]=t)};function ZO(){Fp(1252)}var fa=function(t){Fp(t)};function tE(){fa(1200),ZO()}function hw(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function QO(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function nE(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var Nc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?QO(t.slice(2)):e==254&&n==255?nE(t.slice(2)):e==65279?t.slice(1):t},$f=function(e){return String.fromCharCode(e)},mw=function(e){return String.fromCharCode(e)},eu,Ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pw(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0,f=0;f<t.length;)n=t.charCodeAt(f++),i=n>>2,r=t.charCodeAt(f++),l=(n&3)<<4|r>>4,a=t.charCodeAt(f++),c=(r&15)<<2|a>>6,d=a&63,isNaN(r)?c=d=64:isNaN(a)&&(d=64),e+=Ws.charAt(i)+Ws.charAt(l)+Ws.charAt(c)+Ws.charAt(d);return e}function Or(t){var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)i=Ws.indexOf(t.charAt(f++)),l=Ws.indexOf(t.charAt(f++)),n=i<<2|l>>4,e+=String.fromCharCode(n),c=Ws.indexOf(t.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),d=Ws.indexOf(t.charAt(f++)),a=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ji=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ti(t){return bt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function gw(t){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ua=function(e){return bt?Ji(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function Ki(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function Lp(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Lp(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var Ys=bt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ji(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function eP(t){for(var e=[],n=0,r=t.length+250,a=ti(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=ti(65535),r=65530)}return e.push(a.slice(0,n)),Ys(e)}var mr=/\u0000/g,Rc=/[\u0001-\u0006]/g;function nl(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function da(t,e){var n=""+t;return n.length>=e?n:gn("0",e-n.length)+n}function Op(t,e){var n=""+t;return n.length>=e?n:gn(" ",e-n.length)+n}function gd(t,e){var n=""+t;return n.length>=e?n:n+gn(" ",e-n.length)}function tP(t,e){var n=""+Math.round(t);return n.length>=e?n:gn("0",e-n.length)+n}function nP(t,e){var n=""+t;return n.length>=e?n:gn("0",e-n.length)+n}var xw=Math.pow(2,32);function Wo(t,e){if(t>xw||t<-xw)return tP(t,e);var n=Math.round(t);return nP(n,e)}function xd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var vw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],um=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function rP(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},aP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vd(t,e,n){for(var r=t<0?-1:1,a=t*r,i=0,l=1,c=0,d=1,f=0,g=0,v=Math.floor(a);f<e&&(v=Math.floor(a),c=v*l+i,g=v*f+d,!(a-v<5e-8));)a=1/(a-v),i=l,l=c,d=f,f=g;if(g>e&&(f>e?(g=d,c=i):(g=f,c=l)),!n)return[0,r*c,g];var _=Math.floor(r*c/g);return[_,r*c-_*g,g]}function Ri(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),i=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),r<60&&(i=(i+6)%7),n&&(i=uP(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var rE=new Date(1899,11,31,0,0,0),sP=rE.getTime(),iP=new Date(1900,2,1,0,0,0);function aE(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=iP&&(n+=24*60*60*1e3),(n-(sP+(t.getTimezoneOffset()-rE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function oP(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function lP(t){var e=t<0?12:11,n=Pp(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function cP(t){var e=Pp(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function tu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=lP(t):e===10?n=t.toFixed(10).substr(0,12):n=cP(t),Pp(oP(n.toUpperCase()))}function Vi(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):tu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Zr(14,aE(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function uP(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function fP(t,e,n,r){var a="",i=0,l=0,c=n.y,d,f=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,f=e.length;break;case 3:return um[n.m-1][1];case 5:return um[n.m-1][0];default:return um[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,f=e.length;break;case 3:return vw[n.q][0];default:return vw[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?da(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(n.S+n.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=da(i,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var g=f>0?da(d,f):"";return g}function Js(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var sE=/%/g;function dP(t,e,n){var r=e.replace(sE,""),a=e.length-r.length;return is(t,r,n*Math.pow(10,2*a))+gn("%",a)}function hP(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return is(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function iE(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+iE(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var oE=/# (\?+)( ?)\/( ?)(\d+)/;function mP(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),i=Math.floor(a/r),l=a-i*r,c=r;return n+(i===0?"":""+i)+" "+(l===0?gn(" ",t[1].length+1+t[4].length):Op(l,t[1].length)+t[2]+"/"+t[3]+da(c,t[4].length))}function pP(t,e,n){return n+(e===0?"":""+e)+gn(" ",t[1].length+2+t[4].length)}var lE=/^#*0*\.([0#]+)/,cE=/\).*[0#]/,uE=/\(###\) ###\\?-####/;function fr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function _w(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function ww(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function gP(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function xP(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Jr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(cE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Jr("n",r,n):"("+Jr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return hP(t,e,n);if(e.indexOf("%")!==-1)return dP(t,e,n);if(e.indexOf("E")!==-1)return iE(e,n);if(e.charCodeAt(0)===36)return"$"+Jr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+Wo(d,e.length);if(e.match(/^[#?]+$/))return a=Wo(n,0),a==="0"&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(i=e.match(oE))return mP(i,d,f);if(e.match(/^#+0+$/))return f+Wo(d,e.length-e.indexOf("0"));if(i=e.match(lE))return a=_w(n,i[1].length).replace(/^([^\.]+)$/,"$1."+fr(i[1])).replace(/\.$/,"."+fr(i[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+gn("0",fr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+_w(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Js(Wo(d,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Jr(t,e,-n):Js(""+(Math.floor(n)+gP(n,i[1].length)))+"."+da(ww(n,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Jr(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nl(Jr(t,e.replace(/[\\-]/g,""),n)),l=0,nl(nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(uE))return a=Jr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=vd(d,Math.pow(10,l)-1,!1),a=""+f,g=is("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=gd(c[2],l),g.length<i[4].length&&(g=fr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=vd(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Op(c[1],l)+i[2]+"/"+i[3]+gd(c[2],l):gn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Wo(n,0),e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return fr(e.substr(0,v)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=ww(n,i[1].length),n<0?"-"+Jr(t,e,-n):Js(xP(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?da(0,3-E.length):"")+E})+"."+da(l,i[1].length);switch(e){case"###,##0.00":return Jr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var T=Js(Wo(d,0));return T!=="0"?f+T:"";case"###,###.00":return Jr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Jr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function vP(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return is(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function yP(t,e,n){var r=e.replace(sE,""),a=e.length-r.length;return is(t,r,n*Math.pow(10,2*a))+gn("%",a)}function fE(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fE(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Ca(t,e,n){if(t.charCodeAt(0)===40&&!e.match(cE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Ca("n",r,n):"("+Ca("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return vP(t,e,n);if(e.indexOf("%")!==-1)return yP(t,e,n);if(e.indexOf("E")!==-1)return fE(e,n);if(e.charCodeAt(0)===36)return"$"+Ca(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+da(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(i=e.match(oE))return pP(i,d,f);if(e.match(/^#+0+$/))return f+da(d,e.length-e.indexOf("0"));if(i=e.match(lE))return a=(""+n).replace(/^([^\.]+)$/,"$1."+fr(i[1])).replace(/\.$/,"."+fr(i[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+gn("0",fr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Js(""+d);if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Ca(t,e,-n):Js(""+n)+"."+gn("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ca(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=nl(Ca(t,e.replace(/[\\-]/g,""),n)),l=0,nl(nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(uE))return a=Ca(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=vd(d,Math.pow(10,l)-1,!1),a=""+f,g=is("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=gd(c[2],l),g.length<i[4].length&&(g=fr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=vd(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Op(c[1],l)+i[2]+"/"+i[3]+gd(c[2],l):gn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return fr(e.substr(0,v)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Ca(t,e,-n):Js(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?da(0,3-E.length):"")+E})+"."+da(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Js(""+d);return T!=="0"?f+T:"";default:if(e.match(/\.[0#?]*$/))return Ca(t,e.slice(0,e.lastIndexOf(".")),n)+fr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function is(t,e,n){return(n|0)===n?Ca(t,e,n):Jr(t,e,n)}function _P(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var dE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tl(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":xd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(dE))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function wP(t,e,n,r){for(var a=[],i="",l=0,c="",d="t",f,g,v,_="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!xd(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(v=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(v);a[a.length]={t:"t",v:i},++l;break;case"\\":var T=t.charAt(++l),E=T==="("||T===")"?T:"t";a[a.length]={t:E,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=Ri(e,n,t.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=Ri(e,n),f==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=_),a[a.length]={t:c,v:i},d=c;break;case"A":case"a":case"":var S={t:c,v:c};if(f==null&&(f=Ri(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(f!=null&&(S.v=f.H>=12?"":""),S.t="T",l+=5,_="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(dE)){if(f==null&&(f=Ri(e,n),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tl(t)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var b=0,k=0,A;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,d="h",b<1&&(b=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(k=Math.max(k,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var C="",M;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=fP(a[l].t.charCodeAt(0),a[l].v,f,k),a[l].t="t";break;case"n":case"?":for(M=l+1;a[M]!=null&&((c=a[M].t)==="?"||c==="D"||(c===" "||c==="t")&&a[M+1]!=null&&(a[M+1].t==="?"||a[M+1].t==="t"&&a[M+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[M].v==="/"||a[M].v===" "&&a[M+1]!=null&&a[M+1].t=="?"));)a[l].v+=a[M].v,a[M]={v:"",t:";"},++M;C+=a[l].v,l=M-1;break;case"G":a[l].t="t",a[l].v=Vi(e,n);break}var B="",H,F;if(C.length>0){C.charCodeAt(0)==40?(H=e<0&&C.charCodeAt(0)===45?-e:e,F=is("n",C,H)):(H=e<0&&r>1?-e:e,F=is("n",C,H),H<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),M=F.length-1;var K=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){K=l;break}var P=a.length;if(K===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(M>=a[l].v.length-1?(M-=a[l].v.length,a[l].v=F.substr(M+1,a[l].v.length)):M<0?a[l].v="":(a[l].v=F.substr(0,M+1),M=-1),a[l].t="t",P=l);M>=0&&P<a.length&&(a[P].v=F.substr(0,M+1)+a[P].v)}else if(K!==a.length&&F.indexOf("E")===-1){for(M=F.indexOf(".")-1,l=K;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")-1:a[l].v.length-1,B=a[l].v.substr(g+1);g>=0;--g)M>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(B=F.charAt(M--)+B);a[l].v=B,a[l].t="t",P=l}for(M>=0&&P<a.length&&(a[P].v=F.substr(0,M+1)+a[P].v),M=F.indexOf(".")+1,l=K;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==K)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")+1:0,B=a[l].v.substr(0,g);g<a[l].v.length;++g)M<F.length&&(B+=F.charAt(M++));a[l].v=B,a[l].t="t",P=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(H=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=is(a[l].t,a[l].v,H),a[l].t="t");var ae="";for(l=0;l!==a.length;++l)a[l]!=null&&(ae+=a[l].v);return ae}var Tw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ew(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function TP(t,e){var n=_P(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(Tw),c=n[1].match(Tw);return Ew(e,l)?[r,n[0]]:Ew(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,i]}function Zr(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ut)[t],r==null&&(r=n.table&&n.table[yw[t]]||ut[yw[t]]),r==null&&(r=aP[t]||"General");break}if(xd(r,0))return Vi(e,n);e instanceof Date&&(e=aE(e,n.date1904));var a=TP(r,e);if(xd(a[1]))return Vi(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return wP(a[1],e,n,a[0])}function Mi(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(ut[n]==null){e<0&&(e=n);continue}if(ut[n]==t){e=n;break}}e<0&&(e=391)}return ut[e]=t,e}function hE(){ut=rP()}var EP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SP(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(mE,"(\\d+)"),new RegExp("^"+e+"$")}function bP(t,e,n){var r=-1,a=-1,i=-1,l=-1,c=-1,d=-1;(e.match(mE)||[]).forEach(function(v,_){var T=parseInt(n[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":r=T;break;case"d":i=T;break;case"h":l=T;break;case"s":d=T;break;case"m":l>=0?c=T:a=T;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:r==-1&&a==-1&&i==-1?g:f+"T"+g}var CP=function(){var t={};t.version="1.2.0";function e(){for(var F=0,K=new Array(256),P=0;P!=256;++P)F=P,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,K[P]=F;return typeof Int32Array<"u"?new Int32Array(K):K}var n=e();function r(F){var K=0,P=0,ae=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)G[ae]=F[ae];for(ae=0;ae!=256;++ae)for(P=F[ae],K=256+ae;K<4096;K+=256)P=G[K]=P>>>8^F[P&255];var te=[];for(ae=1;ae!=16;++ae)te[ae-1]=typeof Int32Array<"u"?G.subarray(ae*256,ae*256+256):G.slice(ae*256,ae*256+256);return te}var a=r(n),i=a[0],l=a[1],c=a[2],d=a[3],f=a[4],g=a[5],v=a[6],_=a[7],T=a[8],E=a[9],S=a[10],b=a[11],k=a[12],A=a[13],C=a[14];function M(F,K){for(var P=K^-1,ae=0,G=F.length;ae<G;)P=P>>>8^n[(P^F.charCodeAt(ae++))&255];return~P}function B(F,K){for(var P=K^-1,ae=F.length-15,G=0;G<ae;)P=C[F[G++]^P&255]^A[F[G++]^P>>8&255]^k[F[G++]^P>>16&255]^b[F[G++]^P>>>24]^S[F[G++]]^E[F[G++]]^T[F[G++]]^_[F[G++]]^v[F[G++]]^g[F[G++]]^f[F[G++]]^d[F[G++]]^c[F[G++]]^l[F[G++]]^i[F[G++]]^n[F[G++]];for(ae+=15;G<ae;)P=P>>>8^n[(P^F[G++])&255];return~P}function H(F,K){for(var P=K^-1,ae=0,G=F.length,te=0,we=0;ae<G;)te=F.charCodeAt(ae++),te<128?P=P>>>8^n[(P^te)&255]:te<2048?(P=P>>>8^n[(P^(192|te>>6&31))&255],P=P>>>8^n[(P^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,we=F.charCodeAt(ae++)&1023,P=P>>>8^n[(P^(240|te>>8&7))&255],P=P>>>8^n[(P^(128|te>>2&63))&255],P=P>>>8^n[(P^(128|we>>6&15|(te&3)<<4))&255],P=P>>>8^n[(P^(128|we&63))&255]):(P=P>>>8^n[(P^(224|te>>12&15))&255],P=P>>>8^n[(P^(128|te>>6&63))&255],P=P>>>8^n[(P^(128|te&63))&255]);return~P}return t.table=n,t.bstr=M,t.buf=B,t.str=H,t}(),kt=function(){var e={};e.version="1.2.1";function n(R,j){for(var O=R.split("/"),V=j.split("/"),z=0,Y=0,ue=Math.min(O.length,V.length);z<ue;++z){if(Y=O[z].length-V[z].length)return Y;if(O[z]!=V[z])return O[z]<V[z]?-1:1}return O.length-V.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(0,j+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(j+1)}function i(R,j){typeof j=="string"&&(j=new Date(j));var O=j.getHours();O=O<<6|j.getMinutes(),O=O<<5|j.getSeconds()>>>1,R.write_shift(2,O);var V=j.getFullYear()-1980;V=V<<4|j.getMonth()+1,V=V<<5|j.getDate(),R.write_shift(2,V)}function l(R){var j=R.read_shift(2)&65535,O=R.read_shift(2)&65535,V=new Date,z=O&31;O>>>=5;var Y=O&15;O>>>=4,V.setMilliseconds(0),V.setFullYear(O+1980),V.setMonth(Y-1),V.setDate(z);var ue=j&31;j>>>=5;var ve=j&63;return j>>>=6,V.setHours(j),V.setMinutes(ve),V.setSeconds(ue<<1),V}function c(R){Yn(R,0);for(var j={},O=0;R.l<=R.length-4;){var V=R.read_shift(2),z=R.read_shift(2),Y=R.l+z,ue={};switch(V){case 21589:O=R.read_shift(1),O&1&&(ue.mtime=R.read_shift(4)),z>5&&(O&2&&(ue.atime=R.read_shift(4)),O&4&&(ue.ctime=R.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}R.l=Y,j[V]=ue}return j}var d;function f(){return d||(d={})}function g(R,j){if(R[0]==80&&R[1]==75)return Ua(R,j);if((R[0]|32)==109&&(R[1]|32)==105)return si(R,j);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,V=512,z=0,Y=0,ue=0,ve=0,le=0,de=[],pe=R.slice(0,512);Yn(pe,0);var De=v(pe);switch(O=De[0],O){case 3:V=512;break;case 4:V=4096;break;case 0:if(De[1]==0)return Ua(R,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}V!==512&&(pe=R.slice(0,V),Yn(pe,28));var Le=R.slice(0,V);_(pe,O);var Ue=pe.read_shift(4,"i");if(O===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),ve=pe.read_shift(4,"i"),z=pe.read_shift(4,"i"),le=pe.read_shift(4,"i"),Y=pe.read_shift(4,"i");for(var Ie=-1,Q=0;Q<109&&(Ie=pe.read_shift(4,"i"),!(Ie<0));++Q)de[Q]=Ie;var Te=T(R,V);b(le,Y,Te,V,de);var ke=A(Te,ue,de,V);ke[ue].name="!Directory",z>0&&ve!==we&&(ke[ve].name="!MiniFAT"),ke[de[0]].name="!FAT",ke.fat_addrs=de,ke.ssz=V;var Pe={},je=[],lt=[],Mt=[];C(ue,ke,Te,je,z,Pe,lt,ve),E(lt,Mt,je),je.shift();var St={FileIndex:lt,FullPaths:Mt};return j&&j.raw&&(St.raw={header:Le,sectors:Te}),St}function v(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Re,"Header Signature: "),R.l+=16;var j=R.read_shift(2,"u");return[R.read_shift(2,"u"),j]}function _(R,j){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function T(R,j){for(var O=Math.ceil(R.length/j)-1,V=[],z=1;z<O;++z)V[z-1]=R.slice(z*j,(z+1)*j);return V[O-1]=R.slice(O*j),V}function E(R,j,O){for(var V=0,z=0,Y=0,ue=0,ve=0,le=O.length,de=[],pe=[];V<le;++V)de[V]=pe[V]=V,j[V]=O[V];for(;ve<pe.length;++ve)V=pe[ve],z=R[V].L,Y=R[V].R,ue=R[V].C,de[V]===V&&(z!==-1&&de[z]!==z&&(de[V]=de[z]),Y!==-1&&de[Y]!==Y&&(de[V]=de[Y])),ue!==-1&&(de[ue]=V),z!==-1&&V!=de[V]&&(de[z]=de[V],pe.lastIndexOf(z)<ve&&pe.push(z)),Y!==-1&&V!=de[V]&&(de[Y]=de[V],pe.lastIndexOf(Y)<ve&&pe.push(Y));for(V=1;V<le;++V)de[V]===V&&(Y!==-1&&de[Y]!==Y?de[V]=de[Y]:z!==-1&&de[z]!==z&&(de[V]=de[z]));for(V=1;V<le;++V)if(R[V].type!==0){if(ve=V,ve!=de[ve])do ve=de[ve],j[V]=j[ve]+"/"+j[V];while(ve!==0&&de[ve]!==-1&&ve!=de[ve]);de[V]=-1}for(j[0]+="/",V=1;V<le;++V)R[V].type!==2&&(j[V]+="/")}function S(R,j,O){for(var V=R.start,z=R.size,Y=[],ue=V;O&&z>0&&ue>=0;)Y.push(j.slice(ue*te,ue*te+te)),z-=te,ue=ki(O,ue*4);return Y.length===0?Dn(0):Ys(Y).slice(0,R.size)}function b(R,j,O,V,z){var Y=we;if(R===we){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ue=O[R],ve=(V>>>2)-1;if(!ue)return;for(var le=0;le<ve&&(Y=ki(ue,le*4))!==we;++le)z.push(Y);b(ki(ue,V-4),j-1,O,V,z)}}function k(R,j,O,V,z){var Y=[],ue=[];z||(z=[]);var ve=V-1,le=0,de=0;for(le=j;le>=0;){z[le]=!0,Y[Y.length]=le,ue.push(R[le]);var pe=O[Math.floor(le*4/V)];if(de=le*4&ve,V<4+de)throw new Error("FAT boundary crossed: "+le+" 4 "+V);if(!R[pe])break;le=ki(R[pe],de)}return{nodes:Y,data:Iw([ue])}}function A(R,j,O,V){var z=R.length,Y=[],ue=[],ve=[],le=[],de=V-1,pe=0,De=0,Le=0,Ue=0;for(pe=0;pe<z;++pe)if(ve=[],Le=pe+j,Le>=z&&(Le-=z),!ue[Le]){le=[];var Ie=[];for(De=Le;De>=0;){Ie[De]=!0,ue[De]=!0,ve[ve.length]=De,le.push(R[De]);var Q=O[Math.floor(De*4/V)];if(Ue=De*4&de,V<4+Ue)throw new Error("FAT boundary crossed: "+De+" 4 "+V);if(!R[Q]||(De=ki(R[Q],Ue),Ie[De]))break}Y[Le]={nodes:ve,data:Iw([le])}}return Y}function C(R,j,O,V,z,Y,ue,ve){for(var le=0,de=V.length?2:0,pe=j[R].data,De=0,Le=0,Ue;De<pe.length;De+=128){var Ie=pe.slice(De,De+128);Yn(Ie,64),Le=Ie.read_shift(2),Ue=$p(Ie,0,Le-de),V.push(Ue);var Q={name:Ue,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},Te=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Te!==0&&(Q.ct=M(Ie,Ie.l-8));var ke=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);ke!==0&&(Q.mt=M(Ie,Ie.l-8)),Q.start=Ie.read_shift(4,"i"),Q.size=Ie.read_shift(4,"i"),Q.size<0&&Q.start<0&&(Q.size=Q.type=0,Q.start=we,Q.name=""),Q.type===5?(le=Q.start,z>0&&le!==we&&(j[le].name="!StreamData")):Q.size>=4096?(Q.storage="fat",j[Q.start]===void 0&&(j[Q.start]=k(O,Q.start,j.fat_addrs,j.ssz)),j[Q.start].name=Q.name,Q.content=j[Q.start].data.slice(0,Q.size)):(Q.storage="minifat",Q.size<0?Q.size=0:le!==we&&Q.start!==we&&j[le]&&(Q.content=S(Q,j[le].data,(j[ve]||{}).data))),Q.content&&Yn(Q.content,0),Y[Ue]=Q,ue.push(Q)}}function M(R,j){return new Date((Fr(R,j+4)/1e7*Math.pow(2,32)+Fr(R,j)/1e7-11644473600)*1e3)}function B(R,j){return f(),g(d.readFileSync(R),j)}function H(R,j){var O=j&&j.type;switch(O||bt&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return B(R,j);case"base64":return g(ua(Or(R)),j);case"binary":return g(ua(R),j)}return g(R,j)}function F(R,j){var O=j||{},V=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=V+"/",R.FileIndex[0]={name:V,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),K(R)}function K(R){var j="Sh33tJ5";if(!kt.find(R,"/"+j)){var O=Dn(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:j,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+j),P(R)}}function P(R,j){F(R);for(var O=!1,V=!1,z=R.FullPaths.length-1;z>=0;--z){var Y=R.FileIndex[z];switch(Y.type){case 0:V?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(Y.R*Y.L*Y.C)&&(O=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!j)){var ue=new Date(1987,1,19),ve=0,le=Object.create?Object.create(null):{},de=[];for(z=0;z<R.FullPaths.length;++z)le[R.FullPaths[z]]=!0,R.FileIndex[z].type!==0&&de.push([R.FullPaths[z],R.FileIndex[z]]);for(z=0;z<de.length;++z){var pe=r(de[z][0]);V=le[pe],V||(de.push([pe,{name:a(pe).replace("/",""),type:1,clsid:se,ct:ue,mt:ue,content:null}]),le[pe]=!0)}for(de.sort(function(Ue,Ie){return n(Ue[0],Ie[0])}),R.FullPaths=[],R.FileIndex=[],z=0;z<de.length;++z)R.FullPaths[z]=de[z][0],R.FileIndex[z]=de[z][1];for(z=0;z<de.length;++z){var De=R.FileIndex[z],Le=R.FullPaths[z];if(De.name=a(Le).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||se,z===0)De.C=de.length>1?1:-1,De.size=0,De.type=5;else if(Le.slice(-1)=="/"){for(ve=z+1;ve<de.length&&r(R.FullPaths[ve])!=Le;++ve);for(De.C=ve>=de.length?-1:ve,ve=z+1;ve<de.length&&r(R.FullPaths[ve])!=r(Le);++ve);De.R=ve>=de.length?-1:ve,De.type=1}else r(R.FullPaths[z+1]||"")==r(Le)&&(De.R=z+1),De.type=2}}}function ae(R,j){var O=j||{};if(O.fileType=="mad")return xr(R,O);switch(P(R),O.fileType){case"zip":return ta(R,O)}var V=function(Ue){for(var Ie=0,Q=0,Te=0;Te<Ue.FileIndex.length;++Te){var ke=Ue.FileIndex[Te];if(ke.content){var Pe=ke.content.length;Pe>0&&(Pe<4096?Ie+=Pe+63>>6:Q+=Pe+511>>9)}}for(var je=Ue.FullPaths.length+3>>2,lt=Ie+7>>3,Mt=Ie+127>>7,St=lt+Q+je+Mt,It=St+127>>7,dn=It<=109?0:Math.ceil((It-109)/127);St+It+dn+127>>7>It;)dn=++It<=109?0:Math.ceil((It-109)/127);var Ft=[1,dn,It,Mt,je,Q,Ie,0];return Ue.FileIndex[0].size=Ie<<6,Ft[7]=(Ue.FileIndex[0].start=Ft[0]+Ft[1]+Ft[2]+Ft[3]+Ft[4]+Ft[5])+(Ft[6]+7>>3),Ft}(R),z=Dn(V[7]<<9),Y=0,ue=0;{for(Y=0;Y<8;++Y)z.write_shift(1,ye[Y]);for(Y=0;Y<8;++Y)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),Y=0;Y<3;++Y)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,V[2]),z.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:we),z.write_shift(4,V[3]),z.write_shift(-4,V[1]?V[0]-1:we),z.write_shift(4,V[1]),Y=0;Y<109;++Y)z.write_shift(-4,Y<V[2]?V[1]+Y:-1)}if(V[1])for(ue=0;ue<V[1];++ue){for(;Y<236+ue*127;++Y)z.write_shift(-4,Y<V[2]?V[1]+Y:-1);z.write_shift(-4,ue===V[1]-1?we:ue+1)}var ve=function(Ue){for(ue+=Ue;Y<ue-1;++Y)z.write_shift(-4,Y+1);Ue&&(++Y,z.write_shift(-4,we))};for(ue=Y=0,ue+=V[1];Y<ue;++Y)z.write_shift(-4,me.DIFSECT);for(ue+=V[2];Y<ue;++Y)z.write_shift(-4,me.FATSECT);ve(V[3]),ve(V[4]);for(var le=0,de=0,pe=R.FileIndex[0];le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(de=pe.content.length,!(de<4096)&&(pe.start=ue,ve(de+511>>9)));for(ve(V[6]+7>>3);z.l&511;)z.write_shift(-4,me.ENDOFCHAIN);for(ue=Y=0,le=0;le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(de=pe.content.length,!(!de||de>=4096)&&(pe.start=ue,ve(de+63>>6)));for(;z.l&511;)z.write_shift(-4,me.ENDOFCHAIN);for(Y=0;Y<V[4]<<2;++Y){var De=R.FullPaths[Y];if(!De||De.length===0){for(le=0;le<17;++le)z.write_shift(4,0);for(le=0;le<3;++le)z.write_shift(4,-1);for(le=0;le<12;++le)z.write_shift(4,0);continue}pe=R.FileIndex[Y],Y===0&&(pe.start=pe.size?pe.start-1:we);var Le=Y===0&&O.root||pe.name;if(de=2*(Le.length+1),z.write_shift(64,Le,"utf16le"),z.write_shift(2,de),z.write_shift(1,pe.type),z.write_shift(1,pe.color),z.write_shift(-4,pe.L),z.write_shift(-4,pe.R),z.write_shift(-4,pe.C),pe.clsid)z.write_shift(16,pe.clsid,"hex");else for(le=0;le<4;++le)z.write_shift(4,0);z.write_shift(4,pe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,pe.start),z.write_shift(4,pe.size),z.write_shift(4,0)}for(Y=1;Y<R.FileIndex.length;++Y)if(pe=R.FileIndex[Y],pe.size>=4096)if(z.l=pe.start+1<<9,bt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+511&-512;else{for(le=0;le<pe.size;++le)z.write_shift(1,pe.content[le]);for(;le&511;++le)z.write_shift(1,0)}for(Y=1;Y<R.FileIndex.length;++Y)if(pe=R.FileIndex[Y],pe.size>0&&pe.size<4096)if(bt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+63&-64;else{for(le=0;le<pe.size;++le)z.write_shift(1,pe.content[le]);for(;le&63;++le)z.write_shift(1,0)}if(bt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function G(R,j){var O=R.FullPaths.map(function(le){return le.toUpperCase()}),V=O.map(function(le){var de=le.split("/");return de[de.length-(le.slice(-1)=="/"?2:1)]}),z=!1;j.charCodeAt(0)===47?(z=!0,j=O[0].slice(0,-1)+j):z=j.indexOf("/")!==-1;var Y=j.toUpperCase(),ue=z===!0?O.indexOf(Y):V.indexOf(Y);if(ue!==-1)return R.FileIndex[ue];var ve=!Y.match(Rc);for(Y=Y.replace(mr,""),ve&&(Y=Y.replace(Rc,"!")),ue=0;ue<O.length;++ue)if((ve?O[ue].replace(Rc,"!"):O[ue]).replace(mr,"")==Y||(ve?V[ue].replace(Rc,"!"):V[ue]).replace(mr,"")==Y)return R.FileIndex[ue];return null}var te=64,we=-2,Re="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:we,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(R,j,O){f();var V=ae(R,O);d.writeFileSync(j,V)}function J(R){for(var j=new Array(R.length),O=0;O<R.length;++O)j[O]=String.fromCharCode(R[O]);return j.join("")}function D(R,j){var O=ae(R,j);switch(j&&j.type||"buffer"){case"file":return f(),d.writeFileSync(j.filename,O),O;case"binary":return typeof O=="string"?O:J(O);case"base64":return pw(typeof O=="string"?O:J(O));case"buffer":if(bt)return Buffer.isBuffer(O)?O:Ji(O);case"array":return typeof O=="string"?ua(O):O}return O}var ee;function I(R){try{var j=R.InflateRaw,O=new j;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ee=R;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function W(R,j){if(!ee)return lr(R,j);var O=ee.InflateRaw,V=new O,z=V._processChunk(R.slice(R.l),V._finishFlushFlag);return R.l+=V.bytesRead,z}function X(R){return ee?ee.deflateRawSync(R):tt(R)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Se(R){var j=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(j>>16|j>>8|j)&255}for(var Ee=typeof Uint8Array<"u",Ce=Ee?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)Ce[Ke]=Se(Ke);function Z(R,j){var O=Ce[R&255];return j<=8?O>>>8-j:(O=O<<8|Ce[R>>8&255],j<=16?O>>>16-j:(O=O<<8|Ce[R>>16&255],O>>>24-j))}function ft(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=6?0:R[V+1]<<8))>>>O&3}function Xe(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=5?0:R[V+1]<<8))>>>O&7}function wt(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=4?0:R[V+1]<<8))>>>O&15}function rt(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=3?0:R[V+1]<<8))>>>O&31}function Fe(R,j){var O=j&7,V=j>>>3;return(R[V]|(O<=1?0:R[V+1]<<8))>>>O&127}function Ut(R,j,O){var V=j&7,z=j>>>3,Y=(1<<O)-1,ue=R[z]>>>V;return O<8-V||(ue|=R[z+1]<<8-V,O<16-V)||(ue|=R[z+2]<<16-V,O<24-V)||(ue|=R[z+3]<<24-V),ue&Y}function cn(R,j,O){var V=j&7,z=j>>>3;return V<=5?R[z]|=(O&7)<<V:(R[z]|=O<<V&255,R[z+1]=(O&7)>>8-V),j+3}function rn(R,j,O){var V=j&7,z=j>>>3;return O=(O&1)<<V,R[z]|=O,j+1}function an(R,j,O){var V=j&7,z=j>>>3;return O<<=V,R[z]|=O&255,O>>>=8,R[z+1]=O,j+8}function Ln(R,j,O){var V=j&7,z=j>>>3;return O<<=V,R[z]|=O&255,O>>>=8,R[z+1]=O&255,R[z+2]=O>>>8,j+16}function Tt(R,j){var O=R.length,V=2*O>j?2*O:j+5,z=0;if(O>=j)return R;if(bt){var Y=gw(V);if(R.copy)R.copy(Y);else for(;z<R.length;++z)Y[z]=R[z];return Y}else if(Ee){var ue=new Uint8Array(V);if(ue.set)ue.set(R);else for(;z<O;++z)ue[z]=R[z];return ue}return R.length=V,R}function en(R){for(var j=new Array(R),O=0;O<R;++O)j[O]=0;return j}function Hn(R,j,O){var V=1,z=0,Y=0,ue=0,ve=0,le=R.length,de=Ee?new Uint16Array(32):en(32);for(Y=0;Y<32;++Y)de[Y]=0;for(Y=le;Y<O;++Y)R[Y]=0;le=R.length;var pe=Ee?new Uint16Array(le):en(le);for(Y=0;Y<le;++Y)de[z=R[Y]]++,V<z&&(V=z),pe[Y]=0;for(de[0]=0,Y=1;Y<=V;++Y)de[Y+16]=ve=ve+de[Y-1]<<1;for(Y=0;Y<le;++Y)ve=R[Y],ve!=0&&(pe[Y]=de[ve+16]++);var De=0;for(Y=0;Y<le;++Y)if(De=R[Y],De!=0)for(ve=Z(pe[Y],V)>>V-De,ue=(1<<V+4-De)-1;ue>=0;--ue)j[ve|ue<<De]=De&15|Y<<4;return V}var vn=Ee?new Uint16Array(512):en(512),Zt=Ee?new Uint16Array(32):en(32);if(!Ee){for(var Dt=0;Dt<512;++Dt)vn[Dt]=0;for(Dt=0;Dt<32;++Dt)Zt[Dt]=0}(function(){for(var R=[],j=0;j<32;j++)R.push(5);Hn(R,Zt,32);var O=[];for(j=0;j<=143;j++)O.push(8);for(;j<=255;j++)O.push(9);for(;j<=279;j++)O.push(7);for(;j<=287;j++)O.push(8);Hn(O,vn,288)})();var it=function(){for(var j=Ee?new Uint8Array(32768):[],O=0,V=0;O<_e.length-1;++O)for(;V<_e[O+1];++V)j[V]=O;for(;V<32768;++V)j[V]=29;var z=Ee?new Uint8Array(259):[];for(O=0,V=0;O<oe.length-1;++O)for(;V<oe[O+1];++V)z[V]=O;function Y(ve,le){for(var de=0;de<ve.length;){var pe=Math.min(65535,ve.length-de),De=de+pe==ve.length;for(le.write_shift(1,+De),le.write_shift(2,pe),le.write_shift(2,~pe&65535);pe-- >0;)le[le.l++]=ve[de++]}return le.l}function ue(ve,le){for(var de=0,pe=0,De=Ee?new Uint16Array(32768):[];pe<ve.length;){var Le=Math.min(65535,ve.length-pe);if(Le<10){for(de=cn(le,de,+(pe+Le==ve.length)),de&7&&(de+=8-(de&7)),le.l=de/8|0,le.write_shift(2,Le),le.write_shift(2,~Le&65535);Le-- >0;)le[le.l++]=ve[pe++];de=le.l*8;continue}de=cn(le,de,+(pe+Le==ve.length)+2);for(var Ue=0;Le-- >0;){var Ie=ve[pe];Ue=(Ue<<5^Ie)&32767;var Q=-1,Te=0;if((Q=De[Ue])&&(Q|=pe&-32768,Q>pe&&(Q-=32768),Q<pe))for(;ve[Q+Te]==ve[pe+Te]&&Te<250;)++Te;if(Te>2){Ie=z[Te],Ie<=22?de=an(le,de,Ce[Ie+1]>>1)-1:(an(le,de,3),de+=5,an(le,de,Ce[Ie-23]>>5),de+=3);var ke=Ie<8?0:Ie-4>>2;ke>0&&(Ln(le,de,Te-oe[Ie]),de+=ke),Ie=j[pe-Q],de=an(le,de,Ce[Ie]>>3),de-=3;var Pe=Ie<4?0:Ie-2>>1;Pe>0&&(Ln(le,de,pe-Q-_e[Ie]),de+=Pe);for(var je=0;je<Te;++je)De[Ue]=pe&32767,Ue=(Ue<<5^ve[pe])&32767,++pe;Le-=Te-1}else Ie<=143?Ie=Ie+48:de=rn(le,de,1),de=an(le,de,Ce[Ie]),De[Ue]=pe&32767,++pe}de=an(le,de,0)-1}return le.l=(de+7)/8|0,le.l}return function(le,de){return le.length<8?Y(le,de):ue(le,de)}}();function tt(R){var j=Dn(50+Math.floor(R.length*1.1)),O=it(R,j);return j.slice(0,O)}var Et=Ee?new Uint16Array(32768):en(32768),sn=Ee?new Uint16Array(32768):en(32768),Me=Ee?new Uint16Array(128):en(128),Ye=1,Ge=1;function We(R,j){var O=rt(R,j)+257;j+=5;var V=rt(R,j)+1;j+=5;var z=wt(R,j)+4;j+=4;for(var Y=0,ue=Ee?new Uint8Array(19):en(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,de=Ee?new Uint8Array(8):en(8),pe=Ee?new Uint8Array(8):en(8),De=ue.length,Le=0;Le<z;++Le)ue[q[Le]]=Y=Xe(R,j),le<Y&&(le=Y),de[Y]++,j+=3;var Ue=0;for(de[0]=0,Le=1;Le<=le;++Le)pe[Le]=Ue=Ue+de[Le-1]<<1;for(Le=0;Le<De;++Le)(Ue=ue[Le])!=0&&(ve[Le]=pe[Ue]++);var Ie=0;for(Le=0;Le<De;++Le)if(Ie=ue[Le],Ie!=0){Ue=Ce[ve[Le]]>>8-Ie;for(var Q=(1<<7-Ie)-1;Q>=0;--Q)Me[Ue|Q<<Ie]=Ie&7|Le<<3}var Te=[];for(le=1;Te.length<O+V;)switch(Ue=Me[Fe(R,j)],j+=Ue&7,Ue>>>=3){case 16:for(Y=3+ft(R,j),j+=2,Ue=Te[Te.length-1];Y-- >0;)Te.push(Ue);break;case 17:for(Y=3+Xe(R,j),j+=3;Y-- >0;)Te.push(0);break;case 18:for(Y=11+Fe(R,j),j+=7;Y-- >0;)Te.push(0);break;default:Te.push(Ue),le<Ue&&(le=Ue);break}var ke=Te.slice(0,O),Pe=Te.slice(O);for(Le=O;Le<286;++Le)ke[Le]=0;for(Le=V;Le<30;++Le)Pe[Le]=0;return Ye=Hn(ke,Et,286),Ge=Hn(Pe,sn,30),j}function nt(R,j){if(R[0]==3&&!(R[1]&3))return[ti(j),2];for(var O=0,V=0,z=gw(j||1<<18),Y=0,ue=z.length>>>0,ve=0,le=0;(V&1)==0;){if(V=Xe(R,O),O+=3,V>>>1)V>>1==1?(ve=9,le=5):(O=We(R,O),ve=Ye,le=Ge);else{O&7&&(O+=8-(O&7));var de=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,de>0)for(!j&&ue<Y+de&&(z=Tt(z,Y+de),ue=z.length);de-- >0;)z[Y++]=R[O>>>3],O+=8;continue}for(;;){!j&&ue<Y+32767&&(z=Tt(z,Y+32767),ue=z.length);var pe=Ut(R,O,ve),De=V>>>1==1?vn[pe]:Et[pe];if(O+=De&15,De>>>=4,(De>>>8&255)===0)z[Y++]=De;else{if(De==256)break;De-=257;var Le=De<8?0:De-4>>2;Le>5&&(Le=0);var Ue=Y+oe[De];Le>0&&(Ue+=Ut(R,O,Le),O+=Le),pe=Ut(R,O,le),De=V>>>1==1?Zt[pe]:sn[pe],O+=De&15,De>>>=4;var Ie=De<4?0:De-2>>1,Q=_e[De];for(Ie>0&&(Q+=Ut(R,O,Ie),O+=Ie),!j&&ue<Ue&&(z=Tt(z,Ue+100),ue=z.length);Y<Ue;)z[Y]=z[Y-Q],++Y}}}return j?[z,O+7>>>3]:[z.slice(0,Y),O+7>>>3]}function lr(R,j){var O=R.slice(R.l||0),V=nt(O,j);return R.l+=V[1],V[0]}function Ur(R,j){if(R)typeof console<"u"&&console.error(j);else throw new Error(j)}function Ua(R,j){var O=R;Yn(O,0);var V=[],z=[],Y={FileIndex:V,FullPaths:z};F(Y,{root:j.root});for(var ue=O.length-4;(O[ue]!=80||O[ue+1]!=75||O[ue+2]!=5||O[ue+3]!=6)&&ue>=0;)--ue;O.l=ue+4,O.l+=4;var ve=O.read_shift(2);O.l+=6;var le=O.read_shift(4);for(O.l=le,ue=0;ue<ve;++ue){O.l+=20;var de=O.read_shift(4),pe=O.read_shift(4),De=O.read_shift(2),Le=O.read_shift(2),Ue=O.read_shift(2);O.l+=8;var Ie=O.read_shift(4),Q=c(O.slice(O.l+De,O.l+De+Le));O.l+=De+Le+Ue;var Te=O.l;O.l=Ie+4,Ba(O,de,pe,Y,Q),O.l=Te}return Y}function Ba(R,j,O,V,z){R.l+=2;var Y=R.read_shift(2),ue=R.read_shift(2),ve=l(R);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var le=R.read_shift(4),de=R.read_shift(4),pe=R.read_shift(4),De=R.read_shift(2),Le=R.read_shift(2),Ue="",Ie=0;Ie<De;++Ie)Ue+=String.fromCharCode(R[R.l++]);if(Le){var Q=c(R.slice(R.l,R.l+Le));(Q[21589]||{}).mt&&(ve=Q[21589].mt),((z||{})[21589]||{}).mt&&(ve=z[21589].mt)}R.l+=Le;var Te=R.slice(R.l,R.l+de);switch(ue){case 8:Te=W(R,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var ke=!1;Y&8&&(le=R.read_shift(4),le==134695760&&(le=R.read_shift(4),ke=!0),de=R.read_shift(4),pe=R.read_shift(4)),de!=j&&Ur(ke,"Bad compressed size: "+j+" != "+de),pe!=O&&Ur(ke,"Bad uncompressed size: "+O+" != "+pe),fn(V,Ue,Te,{unsafe:!0,mt:ve})}function ta(R,j){var O=j||{},V=[],z=[],Y=Dn(1),ue=O.compression?8:0,ve=0,le=0,de=0,pe=0,De=0,Le=R.FullPaths[0],Ue=Le,Ie=R.FileIndex[0],Q=[],Te=0;for(le=1;le<R.FullPaths.length;++le)if(Ue=R.FullPaths[le].slice(Le.length),Ie=R.FileIndex[le],!(!Ie.size||!Ie.content||Ue=="Sh33tJ5")){var ke=pe,Pe=Dn(Ue.length);for(de=0;de<Ue.length;++de)Pe.write_shift(1,Ue.charCodeAt(de)&127);Pe=Pe.slice(0,Pe.l),Q[De]=CP.buf(Ie.content,0);var je=Ie.content;ue==8&&(je=X(je)),Y=Dn(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,ve),Y.write_shift(2,ue),Ie.mt?i(Y,Ie.mt):Y.write_shift(4,0),Y.write_shift(-4,Q[De]),Y.write_shift(4,je.length),Y.write_shift(4,Ie.content.length),Y.write_shift(2,Pe.length),Y.write_shift(2,0),pe+=Y.length,V.push(Y),pe+=Pe.length,V.push(Pe),pe+=je.length,V.push(je),Y=Dn(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,ve),Y.write_shift(2,ue),Y.write_shift(4,0),Y.write_shift(-4,Q[De]),Y.write_shift(4,je.length),Y.write_shift(4,Ie.content.length),Y.write_shift(2,Pe.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,ke),Te+=Y.l,z.push(Y),Te+=Pe.length,z.push(Pe),++De}return Y=Dn(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,De),Y.write_shift(2,De),Y.write_shift(4,Te),Y.write_shift(4,pe),Y.write_shift(2,0),Ys([Ys(V),Ys(z),Y])}var xa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ps(R,j){if(R.ctype)return R.ctype;var O=R.name||"",V=O.match(/\.([^\.]+)$/);return V&&xa[V[1]]||j&&(V=(O=j).match(/[\.\\]([^\.\\])+$/),V&&xa[V[1]])?xa[V[1]]:"application/octet-stream"}function gs(R){for(var j=pw(R),O=[],V=0;V<j.length;V+=76)O.push(j.slice(V,V+76));return O.join(`\r
`)+`\r
`}function ja(R){var j=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var pe=de.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],V=j.split(`\r
`),z=0;z<V.length;++z){var Y=V[z];if(Y.length==0){O.push("");continue}for(var ue=0;ue<Y.length;){var ve=76,le=Y.slice(ue,ue+ve);le.charAt(ve-1)=="="?ve--:le.charAt(ve-2)=="="?ve-=2:le.charAt(ve-3)=="="&&(ve-=3),le=Y.slice(ue,ue+ve),ue+=ve,ue<Y.length&&(le+="="),O.push(le)}}return O.join(`\r
`)}function Va(R){for(var j=[],O=0;O<R.length;++O){for(var V=R[O];O<=R.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+R[++O];j.push(V)}for(var z=0;z<j.length;++z)j[z]=j[z].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return ua(j.join(`\r
`))}function xs(R,j,O){for(var V="",z="",Y="",ue,ve=0;ve<10;++ve){var le=j[ve];if(!le||le.match(/^\s*$/))break;var de=le.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":V=de[2].trim();break;case"content-type":Y=de[2].trim();break;case"content-transfer-encoding":z=de[2].trim();break}}switch(++ve,z.toLowerCase()){case"base64":ue=ua(Or(j.slice(ve).join("")));break;case"quoted-printable":ue=Va(j.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var pe=fn(R,V.slice(O.length),ue,{unsafe:!0});Y&&(pe.ctype=Y)}function si(R,j){if(J(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=j&&j.root||"",V=(bt&&Buffer.isBuffer(R)?R.toString("binary"):J(R)).split(`\r
`),z=0,Y="";for(z=0;z<V.length;++z)if(Y=V[z],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),O||(O=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),Y.slice(0,O.length)!=O););var ue=(V[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var ve="--"+(ue[1]||""),le=[],de=[],pe={FileIndex:le,FullPaths:de};F(pe);var De,Le=0;for(z=0;z<V.length;++z){var Ue=V[z];Ue!==ve&&Ue!==ve+"--"||(Le++&&xs(pe,V.slice(De,z),O),De=z)}return pe}function xr(R,j){var O=j||{},V=O.boundary||"SheetJS";V="------="+V;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],Y=R.FullPaths[0],ue=Y,ve=R.FileIndex[0],le=1;le<R.FullPaths.length;++le)if(ue=R.FullPaths[le].slice(Y.length),ve=R.FileIndex[le],!(!ve.size||!ve.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var de=ve.content,pe=bt&&Buffer.isBuffer(de)?de.toString("binary"):J(de),De=0,Le=Math.min(1024,pe.length),Ue=0,Ie=0;Ie<=Le;++Ie)(Ue=pe.charCodeAt(Ie))>=32&&Ue<128&&++De;var Q=De>=Le*4/5;z.push(V),z.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+ue),z.push("Content-Transfer-Encoding: "+(Q?"quoted-printable":"base64")),z.push("Content-Type: "+ps(ve,ue)),z.push(""),z.push(Q?ja(pe):gs(pe))}return z.push(V+`--\r
`),z.join(`\r
`)}function un(R){var j={};return F(j,R),j}function fn(R,j,O,V){var z=V&&V.unsafe;z||F(R);var Y=!z&&kt.find(R,j);if(!Y){var ue=R.FullPaths[0];j.slice(0,ue.length)==ue?ue=j:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+j).replace("//","/")),Y={name:a(j),type:2},R.FileIndex.push(Y),R.FullPaths.push(ue),z||kt.utils.cfb_gc(R)}return Y.content=O,Y.size=O?O.length:0,V&&(V.CLSID&&(Y.clsid=V.CLSID),V.mt&&(Y.mt=V.mt),V.ct&&(Y.ct=V.ct)),Y}function Br(R,j){F(R);var O=kt.find(R,j);if(O){for(var V=0;V<R.FileIndex.length;++V)if(R.FileIndex[V]==O)return R.FileIndex.splice(V,1),R.FullPaths.splice(V,1),!0}return!1}function gt(R,j,O){F(R);var V=kt.find(R,j);if(V){for(var z=0;z<R.FileIndex.length;++z)if(R.FileIndex[z]==V)return R.FileIndex[z].name=a(O),R.FullPaths[z]=O,!0}return!1}function vs(R){P(R,!0)}return e.find=G,e.read=H,e.parse=g,e.write=D,e.writeFile=re,e.utils={cfb_new:un,cfb_add:fn,cfb_del:Br,cfb_mov:gt,cfb_gc:vs,ReadShift:Uc,CheckField:OE,prep_blob:Yn,bconcat:Ys,use_zlib:I,_deflateRaw:tt,_inflateRaw:lr,consts:me},e}();function AP(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function Ma(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function Up(t){for(var e=[],n=Ma(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}var yd=new Date(1899,11,30,0,0,0);function gr(t,e){var n=t.getTime(),r=yd.getTime()+(t.getTimezoneOffset()-yd.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var pE=new Date,kP=yd.getTime()+(pE.getTimezoneOffset()-yd.getTimezoneOffset())*6e4,Sw=pE.getTimezoneOffset();function Bd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+kP),e.getTimezoneOffset()!==Sw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Sw)*6e4),e}function NP(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[i],10)}return e}var bw=new Date("2017-02-19T19:06:09.000Z"),gE=isNaN(bw.getFullYear())?new Date("2/19/17"):bw,RP=gE.getFullYear()==2017;function $n(t,e){var n=new Date(t);if(RP)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(gE.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $i(t,e){if(bt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Mc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Mc(nE(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Mc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Mc(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return n[i]||i})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Wn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Wn(t[n]));return e}function gn(t,e){for(var n="";n.length<e;)n+=t;return n}function ha(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,i){return n=-n,i}),!isNaN(e=Number(r)))?e/n:e}var DP=["january","february","march","april","may","june","july","august","september","october","november","december"];function dl(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&DP.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var MP=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var i=n.split(r),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}}();function xE(t){return t?t.content&&t.type?$i(t.content,!0):t.data?Nc(t.data):t.asNodeBuffer&&bt?Nc(t.asNodeBuffer().toString("binary")):t.asBinary?Nc(t.asBinary()):t._data&&t._data.getContent?Nc($i(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function vE(t){if(!t)return null;if(t.data)return hw(t.data);if(t.asNodeBuffer&&bt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?hw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function IP(t){return t&&t.name.slice(-4)===".bin"?vE(t):xE(t)}function Kr(t,e){for(var n=t.FullPaths||Ma(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var l=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[i]]:t.FileIndex[i]}return null}function Bp(t,e){var n=Kr(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function bn(t,e,n){if(!n)return IP(Bp(t,e));if(!e)return null;try{return bn(t,e)}catch{return null}}function Lr(t,e,n){if(!n)return xE(Bp(t,e));if(!e)return null;try{return Lr(t,e)}catch{return null}}function FP(t,e,n){return vE(Bp(t,e))}function Cw(t){for(var e=t.FullPaths||Ma(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function LP(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return bt?r=Ji(n):r=eP(n),kt.utils.cfb_add(t,e,r)}kt.utils.cfb_add(t,e,n)}else t.file(e,n)}function yE(t,e){switch(e.type){case"base64":return kt.read(t,{type:"base64"});case"binary":return kt.read(t,{type:"binary"});case"buffer":case"array":return kt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Dc(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var _E=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,OP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Aw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,PP=/<[^>]*>/g,or=_E.match(Aw)?Aw:PP,UP=/<\w*:/,BP=/<(\/?)\w+:/;function et(t,e,n){for(var r={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(OP),c=0,d="",f=0,g="",v="",_=1;if(l)for(f=0;f!=l.length;++f){for(v=l[f],i=0;i!=v.length&&v.charCodeAt(i)!==61;++i);for(g=v.slice(0,i).trim();v.charCodeAt(i+1)==32;)++i;for(_=(a=v.charCodeAt(i+1))==34||a==39?1:0,d=v.slice(i+1+_,v.length-_),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=d,r[g.toLowerCase()]=d;else{var T=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[T]&&g.slice(c-3,c)=="ext")continue;r[T]=d,r[T.toLowerCase()]=d}}return r}function Oa(t){return t.replace(BP,"<$1")}var wE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jP=Up(wE),Rt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,d){return wE[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,l)+n(a.slice(l+3))}}(),VP=/[&<>'"]/g,$P=/[\u0000-\u001f]/g;function jp(t){var e=t+"";return e.replace(VP,function(n){return jP[n]}).replace(/\n/g,"<br/>").replace($P,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var kw=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function nn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function fm(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Nw(t){var e=ti(2*t.length),n,r,a=1,i=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=n%256,e[i++]=n>>>8;return e.slice(0,i).toString("ucs2")}function Rw(t){return Ji(t,"binary").toString("utf8")}var Hf="foo bar baz",Kt=bt&&(Rw(Hf)==fm(Hf)&&Rw||Nw(Hf)==fm(Hf)&&Nw)||fm,Mc=bt?function(t){return Ji(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},nu=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),TE=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),HP=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),GP=/<\/?(?:vt:)?variant>/g,zP=/<(?:vt:)([^>]*)>([\s\S]*)</;function Dw(t,e){var n=et(t),r=t.match(HP(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(i){var l=i.replace(GP,"").match(zP);l&&a.push({v:Kt(l[2]),t:l[1]})}),a}var qP=/(^\s|\s$|\n)/;function YP(t){return Ma(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function WP(t,e,n){return"<"+t+(n!=null?YP(n):"")+(e!=null?(e.match(qP)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Vp(t){if(bt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Kt(Ki(Lp(t)));throw new Error("Bad input format: expected Buffer or string")}var ru=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,JP={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},KP=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function XP(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function ZP(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=r?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[n+c]=i&255;t[n+6]=(a&15)<<4|i&15,t[n+7]=a>>4|r}var Mw=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,i=t[0][r].length;a<i;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},Iw=bt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ji(e)})):Mw(t)}:Mw,Fw=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(as(t,a)));return r.join("").replace(mr,"")},$p=bt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(mr,""):Fw(t,e,n)}:Fw,Lw=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},EE=bt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):Lw(t,e,n)}:Lw,Ow=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Xo(t,a)));return r.join("")},vu=bt?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):Ow(e,n,r)}:Ow,SE=function(t,e){var n=Fr(t,e);return n>0?vu(t,e+4,e+4+n-1):""},bE=SE,CE=function(t,e){var n=Fr(t,e);return n>0?vu(t,e+4,e+4+n-1):""},AE=CE,kE=function(t,e){var n=2*Fr(t,e);return n>0?vu(t,e+4,e+4+n-1):""},NE=kE,RE=function(e,n){var r=Fr(e,n);return r>0?$p(e,n+4,n+4+r):""},DE=RE,ME=function(t,e){var n=Fr(t,e);return n>0?vu(t,e+4,e+4+n):""},IE=ME,FE=function(t,e){return XP(t,e)},_d=FE,LE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};bt&&(bE=function(e,n){if(!Buffer.isBuffer(e))return SE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},AE=function(e,n){if(!Buffer.isBuffer(e))return CE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},NE=function(e,n){if(!Buffer.isBuffer(e))return kE(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},DE=function(e,n){if(!Buffer.isBuffer(e))return RE(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},IE=function(e,n){if(!Buffer.isBuffer(e))return ME(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},_d=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):FE(e,n)},LE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xo=function(t,e){return t[e]},as=function(t,e){return t[e+1]*256+t[e]},QP=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Fr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ki=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},eU=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Uc(t,e){var n="",r,a,i=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,bt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(as(this,f)),f+=2;t*=2;break;case"utf8":n=vu(this,this.l,this.l+t);break;case"utf16le":t*=2,n=$p(this,this.l,this.l+t);break;case"wstr":return Uc.call(this,t,"dbcs");case"lpstr-ansi":n=bE(this,this.l),t=4+Fr(this,this.l);break;case"lpstr-cp":n=AE(this,this.l),t=4+Fr(this,this.l);break;case"lpwstr":n=NE(this,this.l),t=4+2*Fr(this,this.l);break;case"lpp4":t=4+Fr(this,this.l),n=DE(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fr(this,this.l),n=IE(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=Xo(this,this.l+t++))!==0;)i.push($f(l));n=i.join("");break;case"_wstr":for(t=0,n="";(l=as(this,this.l+t))!==0;)i.push($f(l)),t+=2;t+=2,n=i.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Xo(this,f),this.l=f+1,c=Uc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push($f(as(this,f))),f+=2}n=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Xo(this,f),this.l=f+1,c=Uc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push($f(Xo(this,f))),f+=1}n=i.join("");break;default:switch(t){case 1:return r=Xo(this,this.l),this.l++,r;case 2:return r=(e==="i"?QP:as)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?ki:eU)(this,this.l),this.l+=4,r):(a=Fr(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=_d(this,this.l):a=_d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=EE(this,this.l,t);break}}return this.l+=t,n}var tU=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},nU=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},rU=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function aU(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)rU(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,tU(this,e,this.l);break;case 8:if(r=8,n==="f"){ZP(this,e,this.l);break}case 16:break;case-4:r=4,nU(this,e,this.l);break}return this.l+=r,this}function OE(t,e){var n=EE(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Yn(t,e){t.l=e,t.read_shift=Uc,t.chk=OE,t.write_shift=aU}function ir(t,e){t.l+=e}function Dn(t){var e=ti(t);return Yn(e,0),e}function ms(t,e,n){if(t){var r,a,i;Yn(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=Cd[c]||Cd[65535];for(r=t.read_shift(1),i=r&127,a=1;a<4&&r&128;++a)i+=((r=t.read_shift(1))&127)<<7*a;d=t.l+i;var g=f.f&&f.f(t,i,n);if(t.l=d,e(g,f,c))return}}}function Zm(){var t=[],e=bt?256:2048,n=function(f){var g=Dn(f);return Yn(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},i=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,e)))},l=function(){return a(),Ys(t)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:c,end:l,_bufs:t}}function Bc(t,e,n){var r=Wn(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Pw(t,e,n){var r=Wn(t);return r.s=Bc(r.s,e.s,n),r.e=Bc(r.e,e.s,n),r}function jc(t,e){if(t.cRel&&t.c<0)for(t=Wn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Wn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=ot(t);return!t.cRel&&t.cRel!=null&&(n=oU(n)),!t.rRel&&t.rRel!=null&&(n=sU(n)),n}function dm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+In(t.s.c)+":"+(t.e.cRel?"":"$")+In(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Jn(t.s.r)+":"+(t.e.rRel?"":"$")+Jn(t.e.r):jc(t.s,e.biff)+":"+jc(t.e,e.biff)}function Hp(t){return parseInt(iU(t),10)-1}function Jn(t){return""+(t+1)}function sU(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iU(t){return t.replace(/\$(\d+)$/,"$1")}function Gp(t){for(var e=lU(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function In(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function oU(t){return t.replace(/^([A-Z])/,"$$$1")}function lU(t){return t.replace(/^\$([A-Z])/,"$1")}function cU(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function hr(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function ot(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function El(t){var e=t.indexOf(":");return e==-1?{s:hr(t),e:hr(t)}:{s:hr(t.slice(0,e)),e:hr(t.slice(e+1))}}function Nt(t,e){return typeof e>"u"||typeof e=="number"?Nt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function xn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=t.length;for(n=0;r<i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function Uw(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Zr(t.z,n?gr(e):e)}catch{}try{return t.w=Zr((t.XF||{}).numFmtId||(n?14:0),n?gr(e):e)}catch{return""+e}}function fs(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?Qi[t.v]||t.v:e==null?Uw(t,t.v):Uw(t,e))}function ai(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function PE(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,i=t||(a?[]:{}),l=0,c=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?hr(r.origin):r.origin;l=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var g=xn(i["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var T={v:e[v][_]},E=l+v,S=c+_;if(f.s.r>E&&(f.s.r=E),f.s.c>S&&(f.s.c=S),f.e.r<E&&(f.e.r=E),f.e.c<S&&(f.e.c=S),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))T=e[v][_];else if(Array.isArray(T.v)&&(T.f=e[v][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(r.nullError)T.t="e",T.v=0;else if(r.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=r.dateNF||ut[14],r.cellDates?(T.t="d",T.w=Zr(T.z,gr(T.v))):(T.t="n",T.v=gr(T.v),T.w=Zr(T.z,T.v))):T.t="s";if(a)i[E]||(i[E]=[]),i[E][S]&&i[E][S].z&&(T.z=i[E][S].z),i[E][S]=T;else{var b=ot({c:S,r:E});i[b]&&i[b].z&&(T.z=i[b].z),i[b]=T}}}return f.s.c<1e7&&(i["!ref"]=Nt(f)),i}function Sl(t,e){return PE(null,t,e)}function uU(t){return t.read_shift(4,"i")}function sr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function fU(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zp(t,e){var n=t.l,r=t.read_shift(1),a=sr(t),i=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)i.push(fU(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}var dU=zp;function ea(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Xi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var hU=sr;function qp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var mU=sr,Qm=qp;function Yp(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?_d([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ki(e,0)>>2;return n?a/100:a}function UE(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Zi=UE;function nr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function pU(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var f=Ii[a];f&&(e.rgb=su(f));break;case 2:e.rgb=su([l,c,d]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function gU(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function BE(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function xU(t){return BE(t,1)}function vU(t){return BE(t,2)}var Wp=2,Er=3,Gf=11,Bw=12,wd=19,zf=64,yU=65,_U=71,wU=4108,TU=4126,Vn=80,jE=81,EU=[Vn,jE],SU={1:{n:"CodePage",t:Wp},2:{n:"Category",t:Vn},3:{n:"PresentationFormat",t:Vn},4:{n:"ByteCount",t:Er},5:{n:"LineCount",t:Er},6:{n:"ParagraphCount",t:Er},7:{n:"SlideCount",t:Er},8:{n:"NoteCount",t:Er},9:{n:"HiddenCount",t:Er},10:{n:"MultimediaClipCount",t:Er},11:{n:"ScaleCrop",t:Gf},12:{n:"HeadingPairs",t:wU},13:{n:"TitlesOfParts",t:TU},14:{n:"Manager",t:Vn},15:{n:"Company",t:Vn},16:{n:"LinksUpToDate",t:Gf},17:{n:"CharacterCount",t:Er},19:{n:"SharedDoc",t:Gf},22:{n:"HyperlinksChanged",t:Gf},23:{n:"AppVersion",t:Er,p:"version"},24:{n:"DigSig",t:yU},26:{n:"ContentType",t:Vn},27:{n:"ContentStatus",t:Vn},28:{n:"Language",t:Vn},29:{n:"Version",t:Vn},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}},bU={1:{n:"CodePage",t:Wp},2:{n:"Title",t:Vn},3:{n:"Subject",t:Vn},4:{n:"Author",t:Vn},5:{n:"Keywords",t:Vn},6:{n:"Comments",t:Vn},7:{n:"Template",t:Vn},8:{n:"LastAuthor",t:Vn},9:{n:"RevNumber",t:Vn},10:{n:"EditTime",t:zf},11:{n:"LastPrinted",t:zf},12:{n:"CreatedDate",t:zf},13:{n:"ModifiedDate",t:zf},14:{n:"PageCount",t:Er},15:{n:"WordCount",t:Er},16:{n:"CharCount",t:Er},17:{n:"Thumbnail",t:_U},18:{n:"Application",t:Vn},19:{n:"DocSecurity",t:Er},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}},jw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function AU(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var kU=AU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ii=Wn(kU),Qi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},VE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Vw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function NU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RU(t){var e=NU();if(!t||!t.match)return e;var n={};if((t.match(or)||[]).forEach(function(r){var a=et(r);switch(a[0].replace(UP,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[Vw[a.ContentType]]!==void 0&&e[Vw[a.ContentType]].push(a.PartName);break}}),e.xmlns!==JP.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ep(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Vc(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(or)||[]).forEach(function(a){var i=et(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Dc(i.Target,e);n[c]=l,r[i.Id]=l}}),n["!id"]=r,n}var DU="application/vnd.oasis.opendocument.spreadsheet";function MU(t,e){for(var n=Vp(t),r,a;r=ru.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=et(r[0],!1),a.path=="/"&&a.type!==DU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var $c=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],IU=function(){for(var t=new Array($c.length),e=0;e<$c.length;++e){var n=$c[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function $E(t){var e={};t=Kt(t);for(var n=0;n<$c.length;++n){var r=$c[n],a=t.match(IU[n]);a!=null&&a.length>0&&(e[r[1]]=Rt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=$n(e[r[1]]))}return e}var FU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function HE(t,e,n,r){var a=[];if(typeof t=="string")a=Dw(t,r);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(g){return{v:g}}));var l=typeof e=="string"?Dw(e,r).map(function(g){return g.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=d,n.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(c,c+d);break}c+=d}}function LU(t,e,n){var r={};return e||(e={}),t=Kt(t),FU.forEach(function(a){var i=(t.match(nu(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Rt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&HE(r.HeadingPairs,r.TitlesOfParts,e,n),e}var OU=/<[^>]+>[^<]*/g;function PU(t,e){var n={},r="",a=t.match(OU);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=et(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Rt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),g=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Rt(g);break;case"bool":n[r]=nn(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=$n(g);break;case"cy":case"error":n[r]=Rt(g);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}var UU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},hm;function BU(t,e,n){hm||(hm=Up(UU)),e=hm[e]||e,t[e]=n}function Jp(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function GE(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function zE(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function qE(t,e,n){return e===31?zE(t):GE(t,e,n)}function tp(t,e,n){return qE(t,e,n===!1?0:4)}function jU(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return qE(t,e,0)}function VU(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(mr,""),t.l-a&2&&(t.l+=2)}return n}function $U(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(mr,"");return n}function HU(t){var e=t.l,n=Td(t,jE);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=Td(t,Er);return[n,r]}function GU(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(HU(t));return n}function $w(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var i=t.read_shift(4),l=t.read_shift(4);r[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(mr,"").replace(Rc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function YE(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function zU(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Td(t,e,n){var r=t.read_shift(2),a,i=n||{};if(t.l+=2,e!==Bw&&r!==e&&EU.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===Bw?r:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return GE(t,r,4).replace(mr,"");case 31:return zE(t);case 64:return Jp(t);case 65:return YE(t);case 71:return zU(t);case 80:return tp(t,r,!i.raw).replace(mr,"");case 81:return jU(t,r).replace(mr,"");case 4108:return GU(t);case 4126:case 4127:return r==4127?VU(t):$U(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function Hw(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0,c=0,d=-1,f={};for(l=0;l!=a;++l){var g=t.read_shift(4),v=t.read_shift(4);i[l]=[g,v+n]}i.sort(function(A,C){return A[1]-C[1]});var _={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var T=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,T=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],T=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],T=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(T=!1,t.l=i[l][1]),T)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[i[l][0]];if(_[E.n]=Td(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fa(c=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(i[l][0]===1){if(c=_.CodePage=Td(t,Wp),fa(c),d!==-1){var S=t.l;t.l=i[d][1],f=$w(t,c),t.l=S}}else if(i[l][0]===0){if(c===0){d=l,t.l=i[l+1][1];continue}f=$w(t,c)}else{var b=f[i[l][0]],k;switch(t[t.l]){case 65:t.l+=4,k=YE(t);break;case 30:t.l+=4,k=tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=wn(t,4);break;case 64:t.l+=4,k=$n(Jp(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[b]=k}}return t.l=n+r,_}function Gw(t,e,n){var r=t.content;if(!r)return{};Yn(r,0);var a,i,l,c,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),g=r.read_shift(16);if(g!==kt.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var v=Hw(r,e),_={SystemIdentifier:f};for(var T in v)_[T]=v[T];if(_.FMTID=i,a===1)return _;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var E;try{E=Hw(r,null)}catch{}for(T in E)_[T]=E[T];return _.FMTID=[i,l],_}function $s(t,e){return t.read_shift(e),null}function qU(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function wn(t,e){return t.read_shift(e)===1}function Cn(t){return t.read_shift(2,"u")}function WE(t,e){return qU(t,e,Cn)}function YU(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function yu(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function WU(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,i=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*l),r&&(t.l+=c),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Hi(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function _u(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Hi(t,r,n)}function eo(t,e,n){if(n.biff>5)return _u(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function JU(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function KU(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(mr,"");return r&&(t.l+=24),a}function XU(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(mr,"");return n+l}function ZU(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return KU(t);case"0303000000000000c000000000000046":return XU(t);default:throw new Error("Unsupported Moniker "+n)}}function qf(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(mr,""):"";return n}function QU(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var i,l,c,d,f="",g,v;a&16&&(i=qf(t,n-t.l)),a&128&&(l=qf(t,n-t.l)),(a&257)===257&&(c=qf(t,n-t.l)),(a&257)===1&&(d=ZU(t,n-t.l)),a&8&&(f=qf(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(v=Jp(t)),t.l=n;var _=l||c||d||"";_&&f&&(_+="#"+f),_||(_="#"+f),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),v&&(T.time=v),i&&(T.Tooltip=i),T}function JE(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function KE(t,e){var n=JE(t);return n[3]=0,n}function Pa(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function e7(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function t7(t,e,n){return e===0?"":eo(t,e,n)}function n7(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),i=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,i,l]}function XE(t){var e=t.read_shift(2),n=Yp(t);return[e,n]}function r7(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=yu(t,e,n),i=t.read_shift(2);if(r-=t.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return t.l+=i,a}function jd(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function ZE(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var a7=ZE;function QE(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function s7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function i7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Zn(t){t.l+=2,t.l+=t.read_shift(2)}var o7={0:Zn,4:Zn,5:Zn,6:Zn,7:i7,8:Zn,9:Zn,10:Zn,11:Zn,12:Zn,13:s7,14:Zn,15:Zn,16:Zn,17:Zn,18:Zn,19:Zn,20:Zn,21:QE};function l7(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(o7[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function Yf(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function c7(t,e){return e===0||t.read_shift(2),1200}function u7(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=eo(t,0,n);return t.read_shift(e+r-t.l),a}function f7(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function d7(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=yu(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:i,name:l}}function h7(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<n;++l)i.push(WU(t));return i.Count=r,i.Unique=a,i}function m7(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function p7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function g7(t){var e=e7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function x7(t){return t.read_shift(2),t.read_shift(4)}function zw(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,a]}function v7(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:i,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function y7(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function _7(){}function w7(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=yu(t,0,n),r}function T7(t){var e=Pa(t);return e.isst=t.read_shift(4),e}function E7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=Pa(t);n.biff==2&&t.l++;var i=_u(t,r-t.l,n);return a.val=i,a}function S7(t,e,n){var r=t.read_shift(2),a=eo(t,0,n);return[r,a]}var b7=eo;function qw(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),d=t.read_shift(2);return t.l=r,{s:{r:i,c},e:{r:l,c:d}}}function C7(t){var e=t.read_shift(2),n=t.read_shift(2),r=XE(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function A7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(XE(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:i}}function k7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:i}}function N7(t,e,n,r){var a={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return a.patternType=CU[c>>26],r.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function R7(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=N7(t,e,r.fStyle,n),r}function D7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Yw(t,e,n){var r=Pa(t);(n.biff==2||e==9)&&++t.l;var a=YU(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function M7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Pa(t),a=nr(t);return r.val=a,r}var Ww=t7;function I7(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Hi(t,i),c=[];r>t.l;)c.push(_u(t));return[i,a,l,c]}function Jw(t,e,n){var r=t.read_shift(2),a,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=r7(t,e-2,n)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var F7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Kw(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),d=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var f=Hi(t,l,n);a&32&&(f=F7[f.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var v=r==t.l||c===0||!(g>0)?[]:pV(t,g,n,c);return{chKey:i,Name:f,itab:d,rgce:v}}function eS(t,e,n){if(n.biff<8)return L7(t,e,n);for(var r=[],a=t.l+e,i=t.read_shift(n.biff>8?4:2);i--!==0;)r.push(n7(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function L7(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=yu(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function O7(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),i=Hi(t,r,n),l=Hi(t,a,n);return[i,l]}function P7(t,e,n){var r=ZE(t);t.l++;var a=t.read_shift(1);return e-=8,[gV(t,e,n),a,r]}function Xw(t,e,n){var r=a7(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,hV(t,e,n)]}function U7(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function B7(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=eo(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,i]}}function j7(t,e,n){return B7(t,e,n)}function V7(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(jd(t));return n}function $7(t,e,n){if(n&&n.biff<8)return G7(t,e,n);var r=QE(t),a=l7(t,e-22,r[1]);return{cmo:r,ft:a}}var H7={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function G7(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((H7[r]||ir)(t,e,n)),{cmo:[a,r,i],ft:l}}function z7(t,e,n){var r=t.l,a="";try{t.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=JU(t,6,n);var c=t.read_shift(2);t.read_shift(2),Cn(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-r!=t.lens[f])throw new Error("TxO: bad continue record");var g=t[t.l],v=Hi(t,t.lens[f+1]-t.lens[f]-1);if(a+=v,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function q7(t,e){var n=jd(t);t.l+=16;var r=QU(t,e-24);return[n,r]}function Y7(t,e){t.read_shift(2);var n=jd(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(mr,""),[n,r]}function W7(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=jw[n]||n,n=t.read_shift(2),e[1]=jw[n]||n,e}function J7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(KE(t));return n}function K7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(KE(t));return n}function X7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function tS(t,e,n){if(!n.cellStyles)return ir(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var f={s:a,e:i,w:l,ixfe:c,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function Z7(t,e){var n={};return e<32||(t.l+=16,n.header=nr(t),n.footer=nr(t),t.l+=2),n}function Q7(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}var e9=Pa,t9=WE,n9=_u;function r9(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function a9(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Pa(t);++t.l;var a=eo(t,e-7,n);return r.t="str",r.val=a,r}function s9(t){var e=Pa(t);++t.l;var n=nr(t);return e.t="n",e.val=n,e}function i9(t){var e=Pa(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function o9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function l9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function c9(t,e,n){var r=t.l+e,a=Pa(t),i=t.read_shift(2),l=Hi(t,i,n);return t.l=r,a.t="str",a.val=l,a}var u9=[2,3,48,49,131,139,140,245],Zw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Up({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,d){var f=[],g=ti(1);switch(d.type){case"base64":g=ua(Or(c));break;case"binary":g=ua(c);break;case"buffer":case"array":g=c;break}Yn(g,0);var v=g.read_shift(1),_=!!(v&136),T=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var S=0,b=521;v==2&&(S=g.read_shift(2)),g.l+=3,v!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),v!=2&&(b=g.read_shift(2));var k=g.read_shift(2),A=d.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(A=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var C=[],M={},B=Math.min(g.length,v==2?521:b-10-(T?264:0)),H=E?32:11;g.l<B&&g[g.l]!=13;)switch(M={},M.name=eu.utils.decode(A,g.slice(g.l,g.l+H)).replace(/[\u0000\r\n].*$/g,""),g.l+=H,M.type=String.fromCharCode(g.read_shift(1)),v!=2&&!E&&(M.offset=g.read_shift(4)),M.len=g.read_shift(1),v==2&&(M.offset=g.read_shift(2)),M.dec=g.read_shift(1),M.name.length&&C.push(M),v!=2&&(g.l+=E?13:14),M.type){case"B":(!T||M.len!=8)&&d.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var F=0,K=0;for(f[0]=[],K=0;K!=C.length;++K)f[0][K]=C[K].name;for(;S-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,f[++F]=[],K=0,K=0;K!=C.length;++K){var P=g.slice(g.l,g.l+C[K].len);g.l+=C[K].len,Yn(P,0);var ae=eu.utils.decode(A,P);switch(C[K].type){case"C":ae.trim().length&&(f[F][K]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?f[F][K]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):f[F][K]=ae;break;case"F":f[F][K]=parseFloat(ae.trim());break;case"+":case"I":f[F][K]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":f[F][K]=!0;break;case"N":case"F":f[F][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[F][K]="##MEMO##"+(E?parseInt(ae.trim(),10):P.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(f[F][K]=+ae||0);break;case"@":f[F][K]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":f[F][K]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":f[F][K]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][K]=-P.read_shift(-8,"f");break;case"B":if(T&&C[K].len==8){f[F][K]=P.read_shift(8,"f");break}case"G":case"P":P.l+=C[K].len;break;case"0":if(C[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[K].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=C,f}function r(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var g=Sl(n(c,f),f);return g["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,g}function a(c,d){try{return ai(r(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&fa(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=Zm(),v=lp(c,{header:1,raw:!0,cellDates:!0}),_=v[0],T=v.slice(1),E=c["!cols"]||[],S=0,b=0,k=0,A=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++k;continue}if(_[S]!=null){if(++k,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(b=0;b<1024;++b)if(_.indexOf(_[S]+"_"+b)==-1){_[S]+="_"+b;break}}}}var C=xn(c["!ref"]),M=[],B=[],H=[];for(S=0;S<=C.e.c-C.s.c;++S){var F="",K="",P=0,ae=[];for(b=0;b<T.length;++b)T[b][S]!=null&&ae.push(T[b][S]);if(ae.length==0||_[S]==null){M[S]="?";continue}for(b=0;b<ae.length;++b){switch(typeof ae[b]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=ae[b]instanceof Date?"D":"C";break;default:K="C"}P=Math.max(P,String(ae[b]).length),F=F&&F!=K?"C":K}P>250&&(P=250),K=((E[S]||{}).DBF||{}).type,K=="C"&&E[S].DBF.len>P&&(P=E[S].DBF.len),F=="B"&&K=="N"&&(F="N",H[S]=E[S].DBF.dec,P=E[S].DBF.len),B[S]=F=="C"||K=="N"?P:i[F]||0,A+=B[S],M[S]=F}var G=g.next(32);for(G.write_shift(4,318902576),G.write_shift(4,T.length),G.write_shift(2,296+32*k),G.write_shift(2,A),S=0;S<4;++S)G.write_shift(4,0);for(G.write_shift(4,0|(+e[eE]||3)<<8),S=0,b=0;S<_.length;++S)if(_[S]!=null){var te=g.next(32),we=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,we,"sbcs"),te.write_shift(1,M[S]=="?"?"C":M[S],"sbcs"),te.write_shift(4,b),te.write_shift(1,B[S]||i[M[S]]||0),te.write_shift(1,H[S]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),b+=B[S]||i[M[S]]||0}var Re=g.next(264);for(Re.write_shift(4,13),S=0;S<65;++S)Re.write_shift(4,0);for(S=0;S<T.length;++S){var ye=g.next(A);for(ye.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(M[b]){case"L":ye.write_shift(1,T[S][b]==null?63:T[S][b]?84:70);break;case"B":ye.write_shift(8,T[S][b]||0,"f");break;case"N":var se="0";for(typeof T[S][b]=="number"&&(se=T[S][b].toFixed(H[b]||0)),k=0;k<B[b]-se.length;++k)ye.write_shift(1,32);ye.write_shift(1,se,"sbcs");break;case"D":T[S][b]?(ye.write_shift(4,("0000"+T[S][b].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(T[S][b].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+T[S][b].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var me=String(T[S][b]!=null?T[S][b]:"").slice(0,B[b]);for(ye.write_shift(1,me,"sbcs"),k=0;k<B[b]-me.length;++k)ye.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),f9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ma(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,T){var E=t[T];return typeof E=="number"?mw(E):E},r=function(_,T,E){var S=T.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:mw(S)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return i(Or(_),T);case"binary":return i(_,T);case"buffer":return i(bt&&Buffer.isBuffer(_)?_.toString("binary"):Ki(_),T);case"array":return i($i(_),T)}throw new Error("Unrecognized type "+T.type)}function i(_,T){var E=_.split(/[\n\r]+/),S=-1,b=-1,k=0,A=0,C=[],M=[],B=null,H={},F=[],K=[],P=[],ae=0,G;for(+T.codepage>=0&&fa(+T.codepage);k!==E.length;++k){ae=0;var te=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),we=te.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),Re=we[0],ye;if(te.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":we[1].charAt(0)=="P"&&M.push(te.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,me=!1,re=!1,J=!1,D=-1,ee=-1;for(A=1;A<we.length;++A)switch(we[A].charAt(0)){case"A":break;case"X":b=parseInt(we[A].slice(1))-1,me=!0;break;case"Y":for(S=parseInt(we[A].slice(1))-1,me||(b=0),G=C.length;G<=S;++G)C[G]=[];break;case"K":ye=we[A].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(ha(ye))?isNaN(dl(ye).getDate())||(ye=$n(ye)):(ye=ha(ye),B!==null&&Tl(B)&&(ye=Bd(ye))),se=!0;break;case"E":J=!0;var I=rl(we[A].slice(1),{r:S,c:b});C[S][b]=[C[S][b],I];break;case"S":re=!0,C[S][b]=[C[S][b],"S5S"];break;case"G":break;case"R":D=parseInt(we[A].slice(1))-1;break;case"C":ee=parseInt(we[A].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}if(se&&(C[S][b]&&C[S][b].length==2?C[S][b][0]=ye:C[S][b]=ye,B=null),re){if(J)throw new Error("SYLK shared formula cannot have own formula");var W=D>-1&&C[D][ee];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");C[S][b][1]=fS(W[1],{r:S-D,c:b-ee})}break;case"F":var X=0;for(A=1;A<we.length;++A)switch(we[A].charAt(0)){case"X":b=parseInt(we[A].slice(1))-1,++X;break;case"Y":for(S=parseInt(we[A].slice(1))-1,G=C.length;G<=S;++G)C[G]=[];break;case"M":ae=parseInt(we[A].slice(1))/20;break;case"F":break;case"G":break;case"P":B=M[parseInt(we[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=we[A].slice(1).split(" "),G=parseInt(P[0],10);G<=parseInt(P[1],10);++G)ae=parseInt(P[2],10),K[G-1]=ae===0?{hidden:!0}:{wch:ae},hl(K[G-1]);break;case"C":b=parseInt(we[A].slice(1))-1,K[b]||(K[b]={});break;case"R":S=parseInt(we[A].slice(1))-1,F[S]||(F[S]={}),ae>0?(F[S].hpt=ae,F[S].hpx=iu(ae)):ae===0&&(F[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}X<1&&(B=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}}return F.length>0&&(H["!rows"]=F),K.length>0&&(H["!cols"]=K),T&&T.sheetRows&&(C=C.slice(0,T.sheetRows)),[C,H]}function l(_,T){var E=a(_,T),S=E[0],b=E[1],k=Sl(S,T);return Ma(b).forEach(function(A){k[A]=b[A]}),k}function c(_,T){return ai(l(_,T),T)}function d(_,T,E,S){var b="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+XB(_.f,{r:E,c:S}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function f(_,T){T.forEach(function(E,S){var b="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?b+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Sd(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=bd(E.wpx)),typeof E.wch=="number"&&(b+=Math.round(E.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function g(_,T){T.forEach(function(E,S){var b="F;";E.hidden?b+="M0;":E.hpt?b+="M"+20*E.hpt+";":E.hpx&&(b+="M"+20*lS(E.hpx)+";"),b.length>2&&_.push(b+"R"+(S+1))})}function v(_,T){var E=["ID;PWXL;N;E"],S=[],b=xn(_["!ref"]),k,A=Array.isArray(_),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&f(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var M=b.s.r;M<=b.e.r;++M)for(var B=b.s.c;B<=b.e.c;++B){var H=ot({r:M,c:B});k=A?(_[M]||[])[B]:_[H],!(!k||k.v==null&&(!k.f||k.F))&&S.push(d(k,_,M,B))}return E.join(C)+C+S.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:l,from_sheet:v}}(),d9=function(){function t(i,l){switch(l.type){case"base64":return e(Or(i),l);case"binary":return e(i,l);case"buffer":return e(bt&&Buffer.isBuffer(i)?i.toString("binary"):Ki(i),l);case"array":return e($i(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var c=i.split(`
`),d=-1,f=-1,g=0,v=[];g!==c.length;++g){if(c[g].trim()==="BOT"){v[++d]=[],f=0;continue}if(!(d<0)){var _=c[g].trim().split(","),T=_[0],E=_[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){v[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?v[d][f]=!0:S==="FALSE"?v[d][f]=!1:isNaN(ha(E))?isNaN(dl(E).getDate())?v[d][f]=E:v[d][f]=$n(E):v[d][f]=ha(E),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),v[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function n(i,l){return Sl(t(i,l),l)}function r(i,l){return ai(n(i,l),l)}var a=function(){var i=function(d,f,g,v,_){d.push(f),d.push(g+","+v),d.push('"'+_.replace(/"/g,'""')+'"')},l=function(d,f,g,v){d.push(f+","+g),d.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var f=[],g=xn(d["!ref"]),v,_=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,g.e.r-g.s.r+1,""),i(f,"TUPLES",0,g.e.c-g.s.c+1,""),i(f,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(f,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=ot({r:T,c:E});if(v=_?(d[T]||[])[E]:d[S],!v){l(f,1,0,"");continue}switch(v.t){case"n":var b=v.w;!b&&v.v!=null&&(b=v.v),b==null?v.f&&!v.F?l(f,1,0,"="+v.f):l(f,1,0,""):l(f,0,b,"V");break;case"b":l(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Zr(v.z||ut[14],gr($n(v.v)))),l(f,0,v.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var k=`\r
`,A=f.join(k);return A}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),h9=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(v,_){for(var T=v.split(`
`),E=-1,S=-1,b=0,k=[];b!==T.length;++b){var A=T[b].trim().split(":");if(A[0]==="cell"){var C=hr(A[1]);if(k.length<=C.r)for(E=k.length;E<=C.r;++E)k[E]||(k[E]=[]);switch(E=C.r,S=C.c,A[2]){case"t":k[E][S]=t(A[3]);break;case"v":k[E][S]=+A[3];break;case"vtf":var M=A[A.length-1];case"vtc":switch(A[3]){case"nl":k[E][S]=!!+A[4];break;default:k[E][S]=+A[4];break}A[2]=="vtf"&&(k[E][S]=[k[E][S],M])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function r(v,_){return Sl(n(v,_),_)}function a(v,_){return ai(r(v,_),_)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var _=[],T=[],E,S="",b=El(v["!ref"]),k=Array.isArray(v),A=b.s.r;A<=b.e.r;++A)for(var C=b.s.c;C<=b.e.c;++C)if(S=ot({r:A,c:C}),E=k?(v[A]||[])[C]:v[S],!(!E||E.v==null||E.t==="z")){switch(T=["cell",S,"t"],E.t){case"s":case"str":T.push(e(E.v));break;case"n":E.f?(T[2]="vtf",T[3]="n",T[4]=E.v,T[5]=e(E.f)):(T[2]="v",T[3]=E.v);break;case"b":T[2]="vt"+(E.f?"f":"c"),T[3]="nl",T[4]=E.v?"1":"0",T[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var M=gr($n(E.v));T[2]="vtc",T[3]="nd",T[4]=""+M,T[5]=E.w||Zr(E.z||ut[14],M);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(v){return[i,l,c,l,f(v),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),au=function(){function t(g,v,_,T,E){E.raw?v[_][T]=g:g===""||(g==="TRUE"?v[_][T]=!0:g==="FALSE"?v[_][T]=!1:isNaN(ha(g))?isNaN(dl(g).getDate())?v[_][T]=g:v[_][T]=$n(g):v[_][T]=ha(g))}function e(g,v){var _=v||{},T=[];if(!g||g.length===0)return T;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var b=10,k=0,A=0;A<=S;++A)k=E[A].indexOf(" "),k==-1?k=E[A].length:k++,b=Math.max(b,k);for(A=0;A<=S;++A){T[A]=[];var C=0;for(t(E[A].slice(0,b).trim(),T,A,C,_),C=1;C<=(E[A].length-b)/10+1;++C)t(E[A].slice(b+(C-1)*10,b+C*10).trim(),T,A,C,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var v={},_=!1,T=0,E=0;T<g.length;++T)(E=g.charCodeAt(T))==34?_=!_:!_&&E in n&&(v[E]=(v[E]||0)+1);E=[];for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T]);if(!E.length){v=r;for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T])}return E.sort(function(S,b){return S[0]-b[0]||r[S[1]]-r[b[1]]}),n[E.pop()[1]]||44}function i(g,v){var _=v||{},T="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var b=0,k=0,A=0,C=0,M=0,B=T.charCodeAt(0),H=!1,F=0,K=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var P=_.dateNF!=null?SP(_.dateNF):null;function ae(){var G=g.slice(C,M),te={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)te.t="z";else if(_.raw)te.t="s",te.v=G;else if(G.trim().length===0)te.t="s",te.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(te.t="s",te.v=G.slice(2,-1).replace(/""/g,'"')):QB(G)?(te.t="n",te.f=G.slice(1)):(te.t="s",te.v=G);else if(G=="TRUE")te.t="b",te.v=!0;else if(G=="FALSE")te.t="b",te.v=!1;else if(!isNaN(A=ha(G)))te.t="n",_.cellText!==!1&&(te.w=G),te.v=A;else if(!isNaN(dl(G).getDate())||P&&G.match(P)){te.z=_.dateNF||ut[14];var we=0;P&&G.match(P)&&(G=bP(G,_.dateNF,G.match(P)||[]),we=1),_.cellDates?(te.t="d",te.v=$n(G,we)):(te.t="n",te.v=gr($n(G,we))),_.cellText!==!1&&(te.w=Zr(te.z,te.v instanceof Date?gr(te.v):te.v)),_.cellNF||delete te.z}else te.t="s",te.v=G;if(te.t=="z"||(_.dense?(E[b]||(E[b]=[]),E[b][k]=te):E[ot({c:k,r:b})]=te),C=M+1,K=g.charCodeAt(C),S.e.c<k&&(S.e.c=k),S.e.r<b&&(S.e.r=b),F==B)++k;else if(k=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;M<g.length;++M)switch(F=g.charCodeAt(M)){case 34:K===34&&(H=!H);break;case B:case 10:case 13:if(!H&&ae())break e;break}return M-C>0&&ae(),E["!ref"]=Nt(S),E}function l(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?i(g,v):Sl(e(g,v),v)}function c(g,v){var _="",T=v.type=="string"?[0,0,0,0]:rg(g,v);switch(v.type){case"base64":_=Or(g);break;case"binary":_=g;break;case"buffer":v.codepage==65001?_=g.toString("utf8"):v.codepage&&typeof eu<"u"||(_=bt&&Buffer.isBuffer(g)?g.toString("binary"):Ki(g));break;case"array":_=$i(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+v.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=Kt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=Kt(_):v.type=="binary"&&typeof eu<"u",_.slice(0,19)=="socialcalc:version:"?h9.to_sheet(v.type=="string"?_:Kt(_),v):l(_,v)}function d(g,v){return ai(c(g,v),v)}function f(g){for(var v=[],_=xn(g["!ref"]),T,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var b=[],k=_.s.c;k<=_.e.c;++k){var A=ot({r:S,c:k});if(T=E?(g[S]||[])[k]:g[A],!T||T.v==null){b.push("          ");continue}for(var C=(T.w||(fs(T),T.w)||"").slice(0,10);C.length<10;)C+=" ";b.push(C+(k===0?" ":""))}v.push(b.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}();function m9(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=f9.to_workbook(t,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return au.to_workbook(t,e)}}var Hc=function(){function t(I,W,X){if(I){Yn(I,I.l||0);for(var q=X.Enum||D;I.l<I.length;){var oe=I.read_shift(2),_e=q[oe]||q[65535],Se=I.read_shift(2),Ee=I.l+Se,Ce=_e.f&&_e.f(I,Se,X);if(I.l=Ee,W(Ce,_e,oe))return}}}function e(I,W){switch(W.type){case"base64":return n(ua(Or(I)),W);case"binary":return n(ua(I),W);case"buffer":case"array":return n(I,W)}throw"Unsupported type "+W.type}function n(I,W){if(!I)return I;var X=W||{},q=X.dense?[]:{},oe="Sheet1",_e="",Se=0,Ee={},Ce=[],Ke=[],Z={s:{r:0,c:0},e:{r:0,c:0}},ft=X.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)X.Enum=D,t(I,function(Fe,Ut,cn){switch(cn){case 0:X.vers=Fe,Fe>=4096&&(X.qpro=!0);break;case 6:Z=Fe;break;case 204:Fe&&(_e=Fe);break;case 222:_e=Fe;break;case 15:case 51:X.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:cn==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=X.dateNF||ut[14],X.cellDates&&(Fe[1].t="d",Fe[1].v=Bd(Fe[1].v))),X.qpro&&Fe[3]>Se&&(q["!ref"]=Nt(Z),Ee[oe]=q,Ce.push(oe),q=X.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Se=Fe[3],oe=_e||"Sheet"+(Se+1),_e="");var rn=X.dense?(q[Fe[0].r]||[])[Fe[0].c]:q[ot(Fe[0])];if(rn){rn.t=Fe[1].t,rn.v=Fe[1].v,Fe[1].z!=null&&(rn.z=Fe[1].z),Fe[1].f!=null&&(rn.f=Fe[1].f);break}X.dense?(q[Fe[0].r]||(q[Fe[0].r]=[]),q[Fe[0].r][Fe[0].c]=Fe[1]):q[ot(Fe[0])]=Fe[1];break}},X);else if(I[2]==26||I[2]==14)X.Enum=ee,I[2]==14&&(X.qpro=!0,I.l=0),t(I,function(Fe,Ut,cn){switch(cn){case 204:oe=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>Se&&(q["!ref"]=Nt(Z),Ee[oe]=q,Ce.push(oe),q=X.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Se=Fe[3],oe="Sheet"+(Se+1)),ft>0&&Fe[0].r>=ft)break;X.dense?(q[Fe[0].r]||(q[Fe[0].r]=[]),q[Fe[0].r][Fe[0].c]=Fe[1]):q[ot(Fe[0])]=Fe[1],Z.e.c<Fe[0].c&&(Z.e.c=Fe[0].c),Z.e.r<Fe[0].r&&(Z.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(Ke[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:Ke[Fe[0]]=Fe[1],Fe[0]==Se&&(oe=Fe[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(q["!ref"]=Nt(Z),Ee[_e||oe]=q,Ce.push(_e||oe),!Ke.length)return{SheetNames:Ce,Sheets:Ee};for(var Xe={},wt=[],rt=0;rt<Ke.length;++rt)Ee[Ce[rt]]?(wt.push(Ke[rt]||Ce[rt]),Xe[Ke[rt]]=Ee[Ke[rt]]||Ee[Ce[rt]]):(wt.push(Ke[rt]),Xe[Ke[rt]]={"!ref":"A1"});return{SheetNames:wt,Sheets:Xe}}function r(I,W){var X=W||{};if(+X.codepage>=0&&fa(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Zm(),oe=xn(I["!ref"]),_e=Array.isArray(I),Se=[];oa(q,0,i(1030)),oa(q,6,d(oe));for(var Ee=Math.min(oe.e.r,8191),Ce=oe.s.r;Ce<=Ee;++Ce)for(var Ke=Jn(Ce),Z=oe.s.c;Z<=oe.e.c;++Z){Ce===oe.s.r&&(Se[Z]=In(Z));var ft=Se[Z]+Ke,Xe=_e?(I[Ce]||[])[Z]:I[ft];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")(Xe.v|0)==Xe.v&&Xe.v>=-32768&&Xe.v<=32767?oa(q,13,T(Ce,Z,Xe.v)):oa(q,14,S(Ce,Z,Xe.v));else{var wt=fs(Xe);oa(q,15,v(Ce,Z,wt.slice(0,239)))}}return oa(q,1),q.end()}function a(I,W){var X=W||{};if(+X.codepage>=0&&fa(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Zm();oa(q,0,l(I));for(var oe=0,_e=0;oe<I.SheetNames.length;++oe)(I.Sheets[I.SheetNames[oe]]||{})["!ref"]&&oa(q,27,J(I.SheetNames[oe],_e++));var Se=0;for(oe=0;oe<I.SheetNames.length;++oe){var Ee=I.Sheets[I.SheetNames[oe]];if(!(!Ee||!Ee["!ref"])){for(var Ce=xn(Ee["!ref"]),Ke=Array.isArray(Ee),Z=[],ft=Math.min(Ce.e.r,8191),Xe=Ce.s.r;Xe<=ft;++Xe)for(var wt=Jn(Xe),rt=Ce.s.c;rt<=Ce.e.c;++rt){Xe===Ce.s.r&&(Z[rt]=In(rt));var Fe=Z[rt]+wt,Ut=Ke?(Ee[Xe]||[])[rt]:Ee[Fe];if(!(!Ut||Ut.t=="z"))if(Ut.t=="n")oa(q,23,ae(Xe,rt,Se,Ut.v));else{var cn=fs(Ut);oa(q,22,F(Xe,rt,Se,cn.slice(0,239)))}}++Se}}return oa(q,1),q.end()}function i(I){var W=Dn(2);return W.write_shift(2,I),W}function l(I){var W=Dn(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var X=0,q=0,oe=0,_e=0;_e<I.SheetNames.length;++_e){var Se=I.SheetNames[_e],Ee=I.Sheets[Se];if(!(!Ee||!Ee["!ref"])){++oe;var Ce=El(Ee["!ref"]);X<Ce.e.r&&(X=Ce.e.r),q<Ce.e.c&&(q=Ce.e.c)}}return X>8191&&(X=8191),W.write_shift(2,X),W.write_shift(1,oe),W.write_shift(1,q),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function c(I,W,X){var q={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&X.qpro?(q.s.c=I.read_shift(1),I.l++,q.s.r=I.read_shift(2),q.e.c=I.read_shift(1),I.l++,q.e.r=I.read_shift(2),q):(q.s.c=I.read_shift(2),q.s.r=I.read_shift(2),W==12&&X.qpro&&(I.l+=2),q.e.c=I.read_shift(2),q.e.r=I.read_shift(2),W==12&&X.qpro&&(I.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function d(I){var W=Dn(8);return W.write_shift(2,I.s.c),W.write_shift(2,I.s.r),W.write_shift(2,I.e.c),W.write_shift(2,I.e.r),W}function f(I,W,X){var q=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(q[0].c=I.read_shift(1),q[3]=I.read_shift(1),q[0].r=I.read_shift(2),I.l+=2):(q[2]=I.read_shift(1),q[0].c=I.read_shift(2),q[0].r=I.read_shift(2)),q}function g(I,W,X){var q=I.l+W,oe=f(I,W,X);if(oe[1].t="s",X.vers==20768){I.l++;var _e=I.read_shift(1);return oe[1].v=I.read_shift(_e,"utf8"),oe}return X.qpro&&I.l++,oe[1].v=I.read_shift(q-I.l,"cstr"),oe}function v(I,W,X){var q=Dn(7+X.length);q.write_shift(1,255),q.write_shift(2,W),q.write_shift(2,I),q.write_shift(1,39);for(var oe=0;oe<q.length;++oe){var _e=X.charCodeAt(oe);q.write_shift(1,_e>=128?95:_e)}return q.write_shift(1,0),q}function _(I,W,X){var q=f(I,W,X);return q[1].v=I.read_shift(2,"i"),q}function T(I,W,X){var q=Dn(7);return q.write_shift(1,255),q.write_shift(2,W),q.write_shift(2,I),q.write_shift(2,X,"i"),q}function E(I,W,X){var q=f(I,W,X);return q[1].v=I.read_shift(8,"f"),q}function S(I,W,X){var q=Dn(13);return q.write_shift(1,255),q.write_shift(2,W),q.write_shift(2,I),q.write_shift(8,X,"f"),q}function b(I,W,X){var q=I.l+W,oe=f(I,W,X);if(oe[1].v=I.read_shift(8,"f"),X.qpro)I.l=q;else{var _e=I.read_shift(2);M(I.slice(I.l,I.l+_e),oe),I.l+=_e}return oe}function k(I,W,X){var q=W&32768;return W&=-32769,W=(q?I:0)+(W>=8192?W-16384:W),(q?"":"$")+(X?In(W):Jn(W))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(I,W){Yn(I,0);for(var X=[],q=0,oe="",_e="",Se="",Ee="";I.l<I.length;){var Ce=I[I.l++];switch(Ce){case 0:X.push(I.read_shift(8,"f"));break;case 1:_e=k(W[0].c,I.read_shift(2),!0),oe=k(W[0].r,I.read_shift(2),!1),X.push(_e+oe);break;case 2:{var Ke=k(W[0].c,I.read_shift(2),!0),Z=k(W[0].r,I.read_shift(2),!1);_e=k(W[0].c,I.read_shift(2),!0),oe=k(W[0].r,I.read_shift(2),!1),X.push(Ke+Z+":"+_e+oe)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(I.read_shift(2));break;case 6:{for(var ft="";Ce=I[I.l++];)ft+=String.fromCharCode(Ce);X.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Ee=X.pop(),Se=X.pop(),X.push(["AND","OR"][Ce-20]+"("+Se+","+Ee+")");break;default:if(Ce<32&&C[Ce])Ee=X.pop(),Se=X.pop(),X.push(Se+C[Ce]+Ee);else if(A[Ce]){if(q=A[Ce][1],q==69&&(q=I[I.l++]),q>X.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+X.join("|")+"|");return}var Xe=X.slice(-q);X.length-=q,X.push(A[Ce][0]+"("+Xe.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}X.length==1?W[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function B(I){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=I.read_shift(2),W[3]=I[I.l++],W[0].c=I[I.l++],W}function H(I,W){var X=B(I);return X[1].t="s",X[1].v=I.read_shift(W-4,"cstr"),X}function F(I,W,X,q){var oe=Dn(6+q.length);oe.write_shift(2,I),oe.write_shift(1,X),oe.write_shift(1,W),oe.write_shift(1,39);for(var _e=0;_e<q.length;++_e){var Se=q.charCodeAt(_e);oe.write_shift(1,Se>=128?95:Se)}return oe.write_shift(1,0),oe}function K(I,W){var X=B(I);X[1].v=I.read_shift(2);var q=X[1].v>>1;if(X[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return X[1].v=q,X}function P(I,W){var X=B(I),q=I.read_shift(4),oe=I.read_shift(4),_e=I.read_shift(2);if(_e==65535)return q===0&&oe===3221225472?(X[1].t="e",X[1].v=15):q===0&&oe===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var Se=_e&32768;return _e=(_e&32767)-16446,X[1].v=(1-Se*2)*(oe*Math.pow(2,_e+32)+q*Math.pow(2,_e)),X}function ae(I,W,X,q){var oe=Dn(14);if(oe.write_shift(2,I),oe.write_shift(1,X),oe.write_shift(1,W),q==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var _e=0,Se=0,Ee=0,Ce=0;return q<0&&(_e=1,q=-q),Se=Math.log2(q)|0,q/=Math.pow(2,Se-31),Ce=q>>>0,(Ce&2147483648)==0&&(q/=2,++Se,Ce=q>>>0),q-=Ce,Ce|=2147483648,Ce>>>=0,q*=Math.pow(2,32),Ee=q>>>0,oe.write_shift(4,Ee),oe.write_shift(4,Ce),Se+=16383+(_e?32768:0),oe.write_shift(2,Se),oe}function G(I,W){var X=P(I);return I.l+=W-14,X}function te(I,W){var X=B(I),q=I.read_shift(4);return X[1].v=q>>6,X}function we(I,W){var X=B(I),q=I.read_shift(8,"f");return X[1].v=q,X}function Re(I,W){var X=we(I);return I.l+=W-10,X}function ye(I,W){return I[I.l+W-1]==0?I.read_shift(W,"cstr"):""}function se(I,W){var X=I[I.l++];X>W-1&&(X=W-1);for(var q="";q.length<X;)q+=String.fromCharCode(I[I.l++]);return q}function me(I,W,X){if(!(!X.qpro||W<21)){var q=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var oe=I.read_shift(W-21,"cstr");return[q,oe]}}function re(I,W){for(var X={},q=I.l+W;I.l<q;){var oe=I.read_shift(2);if(oe==14e3){for(X[oe]=[0,""],X[oe][0]=I.read_shift(2);I[I.l];)X[oe][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return X}function J(I,W){var X=Dn(5+I.length);X.write_shift(2,14e3),X.write_shift(2,W);for(var q=0;q<I.length;++q){var oe=I.charCodeAt(q);X[X.l++]=oe>127?95:oe}return X[X.l++]=0,X}var D={0:{n:"BOF",f:Cn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:we},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function p9(t){var e={},n=t.match(or),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=et(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Ip[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var g9=function(){var t=nu("t"),e=nu("rPr");function n(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Rt(l[1])},d=i.match(e);return d&&(c.s=p9(d[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),x9=function(){var e=/(\r\n|\n)/g;function n(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var i=[[],a.v,[]];return a.v?(a.s&&n(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),v9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y9=/<(?:\w+:)?r>/,_9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kp(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Rt(Kt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Kt(t),n&&(r.h=jp(r.t))):t.match(y9)&&(r.r=Kt(t),r.t=Rt(Kt((t.replace(_9,"").match(v9)||[]).join("").replace(or,""))),n&&(r.h=x9(g9(r.r)))),r):{t:""}}var w9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,T9=/<(?:\w+:)?(?:si|sstItem)>/g,E9=/<\/(?:\w+:)?(?:si|sstItem)>/;function S9(t,e){var n=[],r="";if(!t)return n;var a=t.match(w9);if(a){r=a[2].replace(T9,"").split(E9);for(var i=0;i!=r.length;++i){var l=Kp(r[i].trim(),e);l!=null&&(n[n.length]=l)}a=et(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function b9(t){return[t.read_shift(4),t.read_shift(4)]}function C9(t,e){var n=[],r=!1;return ms(t,function(i,l,c){switch(c){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function nS(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function os(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function A9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=os(t,4),e.U=os(t,4),e.W=os(t,4),e}function k9(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=i,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function N9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(k9(t));return e}function R9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function D9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=os(t,4),e.U=os(t,4),e.W=os(t,4),e}function M9(t){var e=D9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function rS(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function aS(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function I9(t){var e=os(t);switch(e.Minor){case 2:return[e.Minor,F9(t)];case 3:return[e.Minor,L9()];case 4:return[e.Minor,O9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function F9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=rS(t,n),a=aS(t,t.length-t.l);return{t:"Std",h:r,v:a}}function L9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function O9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(or,function(i){var l=et(i);switch(Oa(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function P9(t,e){var n={},r=n.EncryptionVersionInfo=os(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=rS(t,a),e-=a,n.EncryptionVerifier=aS(t,e),n}function U9(t){var e={},n=e.EncryptionVersionInfo=os(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function B9(t){var e=0,n,r=nS(t),a=r.length+1,i,l,c,d,f;for(n=ti(a),n[0]=r.length,i=1;i!=a;++i)n[i]=r[i-1];for(i=a-1;i>=0;--i)l=n[i],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var sS=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},i=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var g=l[f],v=0;v!=7;++v)g&64&&(c^=n[d]),g*=2,--d;return c};return function(l){for(var c=nS(l),d=i(c),f=c.length,g=ti(16),v=0;v!=16;++v)g[v]=0;var _,T,E;for((f&1)===1&&(_=d>>8,g[f]=a(t[0],_),--f,_=d&255,T=c[c.length-1],g[f]=a(T,_));f>0;)--f,_=d>>8,g[f]=a(c[f],_),--f,_=d&255,g[f]=a(c[f],_);for(f=15,E=15-c.length;E>0;)_=d>>8,g[f]=a(t[E],_),--f,--E,_=d&255,g[f]=a(c[f],_),--f,--E;return g}}(),j9=function(t,e,n,r,a){a||(a=e),r||(r=sS(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=r[n],l=(l>>5|l<<3)&255,a[i]=l,++n;return[a,n,r]},V9=function(t){var e=0,n=sS(t);return function(r){var a=j9("",r,e,n);return e=a[1],a[0]}};function $9(t,e,n,r){var a={key:Cn(t),verificationBytes:Cn(t)};return n.password&&(a.verifier=B9(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=V9(n.password)),a}function H9(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=U9(t):r.Data=P9(t,e),r}function G9(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?H9(t,e-2,r):$9(t,n.biff>=8?e:e-2,n,r),r}var z9=function(){function t(a,i){switch(i.type){case"base64":return e(Or(a),i);case"binary":return e(a,i);case"buffer":return e(bt&&Buffer.isBuffer(a)?a.toString("binary"):Ki(a),i);case"array":return e($i(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},c=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,v){Array.isArray(c)&&(c[v]=[]);for(var _=/\\\w+\b/g,T=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var b=g.slice(T,_.lastIndex-E[0].length);if(b[0]==" "&&(b=b.slice(1)),++S,b.length){var k={v:b,t:"s"};Array.isArray(c)?c[v][S]=k:c[ot({r:v,c:S})]=k}break}T=_.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=Nt(f),c}function n(a,i){return ai(t(a,i),i)}function r(a){for(var i=["{\\rtf1\\ansi"],l=xn(a["!ref"]),c,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){i.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)i.push("\\cellx"+(g+1));for(i.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var v=ot({r:f,c:g});c=d?(a[f]||[])[g]:a[v],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(fs(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function q9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function su(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function Y9(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),i=Math.min(e,n,r),l=a-i;if(l===0)return[0,0,e];var c=0,d=0,f=a+i;switch(d=l/(f>1?2-f:f),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,d,f/2]}function W9(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),i=r-a/2,l=[i,i,i],c=6*e,d;if(n!==0)switch(c|0){case 0:case 6:d=a*c,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-c),l[0]+=d,l[1]+=a;break;case 2:d=a*(c-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-c),l[1]+=d,l[2]+=a;break;case 4:d=a*(c-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-c),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function Ed(t,e){if(e===0)return t;var n=Y9(q9(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),su(W9(n))}var iS=6,J9=15,K9=1,dr=iS;function Sd(t){return Math.floor((t+Math.round(128/dr)/256)*dr)}function bd(t){return Math.floor((t-5)/dr*100+.5)/100}function np(t){return Math.round((t*dr+5)/dr*256)/256}function mm(t){return np(bd(Sd(t)))}function Xp(t){var e=Math.abs(t-mm(t)),n=dr;if(e>.005)for(dr=K9;dr<J9;++dr)Math.abs(t-mm(t))<=e&&(e=Math.abs(t-mm(t)),n=dr);dr=n}function hl(t){t.width?(t.wpx=Sd(t.width),t.wch=bd(t.wpx),t.MDW=dr):t.wpx?(t.wch=bd(t.wpx),t.width=np(t.wch),t.MDW=dr):typeof t.wch=="number"&&(t.width=np(t.wch),t.wpx=Sd(t.width),t.MDW=dr),t.customWidth&&delete t.customWidth}var X9=96,oS=X9;function lS(t){return t*96/oS}function iu(t){return t*oS/96}var Z9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Q9(t,e,n,r){e.Borders=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=et(l);switch(Oa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=nn(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=nn(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function eB(t,e,n,r){e.Fills=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=et(l);switch(Oa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function tB(t,e,n,r){e.Fonts=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=et(l);switch(Oa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Kt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?nn(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?nn(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?nn(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?nn(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?nn(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?nn(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?nn(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Ip[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=nn(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=Ii[a.color.index];a.color.index==81&&(d=Ii[1]),d||(d=Ii[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=Ed(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function nB(t,e,n){e.NumberFmt=[];for(var r=Ma(ut),a=0;a<r.length;++a)e.NumberFmt[r[a]]=ut[r[a]];var i=t[0].match(or);if(i)for(a=0;a<i.length;++a){var l=et(i[a]);switch(Oa(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Rt(Kt(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}Mi(c,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Wf=["numFmtId","fillId","fontId","borderId","xfId"],Jf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rB(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(or)||[]).forEach(function(i){var l=et(i),c=0;switch(Oa(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<Wf.length;++c)r[Wf[c]]&&(r[Wf[c]]=parseInt(r[Wf[c]],10));for(c=0;c<Jf.length;++c)r[Jf[c]]&&(r[Jf[c]]=nn(r[Jf[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=nn(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var aB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&nB(v,g,f),(v=c.match(a))&&tB(v,g,d,f),(v=c.match(r))&&eB(v,g,d,f),(v=c.match(i))&&Q9(v,g,d,f),(v=c.match(n))&&rB(v,g,f),g}}();function sB(t,e){var n=t.read_shift(2),r=sr(t);return[n,r]}function iB(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=gU(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var i=t.read_shift(2);switch(i===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=pU(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=sr(t),r}var oB=ir;function lB(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}var cB=ir;function uB(t,e,n){var r={};r.NumberFmt=[];for(var a in ut)r.NumberFmt[a]=ut[a];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return ms(t,function(d,f,g){switch(g){case 44:r.NumberFmt[d[0]]=d[1],Mi(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=Ed(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(g),l=!0;break;case 38:i.pop(),l=!1;break;default:if(f.T>0)i.push(g);else if(f.T<0)i.pop();else if(!l||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var fB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dB(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(or)||[]).forEach(function(a){var i=et(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[fB.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function hB(){}function mB(){}var pB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vB(t,e,n){e.themeElements={};var r;[["clrScheme",pB,dB],["fontScheme",gB,hB],["fmtScheme",xB,mB]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var yB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function cS(t,e){(!t||t.length===0)&&(t=_B());var n,r={};if(!(n=t.match(yB)))throw new Error("themeElements not found in theme");return vB(n[0],r,e),r.raw=t,r}function _B(t,e){var n=[_E];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function wB(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var i=t.slice(t.l);t.l=r;var l;try{l=yE(i,{type:"array"})}catch{return}var c=Lr(l,"theme/theme/theme1.xml",!0);if(c)return cS(c,n)}}function TB(t){return t.read_shift(4)}function EB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=SB(t,4);break;case 2:e.xclrValue=JE(t);break;case 3:e.xclrValue=TB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function SB(t,e){return ir(t,e)}function bB(t,e){return ir(t,e)}function CB(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=EB(t);break;case 6:r[1]=bB(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function AB(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(CB(t,n-t.l));return{ixfe:r,ext:i}}function kB(t,e){e.forEach(function(n){n[0]})}function NB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:sr(t)}}function RB(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function DB(t){return t.l+=4,t.read_shift(4)!=0}function MB(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],l=!1,c=2;return ms(t,function(d,f,g){switch(g){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(v){c==1?r.Cell.push({type:r.Types[v[0]-1].name,index:v[1]}):c==0&&r.Value.push({type:r.Types[v[0]-1].name,index:v[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:i.push(g),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function IB(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,i=2,l;return t.replace(or,function(c){var d=et(c);switch(Oa(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):i==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),r}function FB(t){var e=[];if(!t)return e;var n=1;return(t.match(or)||[]).forEach(function(r){var a=et(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function LB(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=ot(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function OB(t,e,n){var r=[];return ms(t,function(i,l,c){switch(c){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function PB(t,e,n,r){if(!t)return t;var a=r||{},i=!1;ms(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function UB(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}function Qw(t,e,n,r){var a=Array.isArray(t),i;e.forEach(function(l){var c=hr(l.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[l.ref]=i;var d=xn(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=Nt(d);f!==t["!ref"]&&(t["!ref"]=f)}i.c||(i.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var v=i.c.length-1;v>=0;--v){if(!n&&i.c[v].T)return;n&&!i.c[v].T&&i.c.splice(v,1)}if(n&&r){for(v=0;v<r.length;++v)if(g.a==r[v].id){g.a=r[v].name||g.a;break}}i.c.push(g)})}function BB(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=et(c[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=hr(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Kp(v[1])||{r:"",t:"",h:""};f.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),f.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=_.h),r.push(f)}}}}),r}function jB(t,e){var n=[],r=!1,a={},i=0;return t.replace(or,function(c,d){var f=et(c);switch(Oa(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":i=d+c.length;break;case"</text>":a.t=t.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function VB(t,e){var n=[],r=!1;return t.replace(or,function(i){var l=et(i);switch(Oa(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}function $B(t){var e={};e.iauthor=t.read_shift(4);var n=Zi(t);return e.rfx=n.s,e.ref=ot(n.s),t.l+=16,e}var HB=sr;function GB(t,e){var n=[],r=[],a={},i=!1;return ms(t,function(c,d,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var zB="application/vnd.ms-office.vbaProject";function qB(t){var e=kt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");kt.utils.cfb_add(e,a,t.FileIndex[r].content)}}),kt.write(e)}function YB(){return{"!type":"dialog"}}function WB(){return{"!type":"dialog"}}function JB(){return{"!type":"macro"}}function KB(){return{"!type":"macro"}}var rl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,i,l){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,d?f+=e.r:--f,a+(c?"":"$")+In(g)+(d?"":"$")+Jn(f)}return function(a,i){return e=i,a.replace(t,n)}}(),uS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,XB=function(){return function(e,n){return e.replace(uS,function(r,a,i,l,c,d){var f=Gp(l)-(i?0:n.c),g=Hp(d)-(c?0:n.r),v=g==0?"":c?g+1:"["+g+"]",_=f==0?"":i?f+1:"["+f+"]";return a+"R"+v+"C"+_})}}();function fS(t,e){return t.replace(uS,function(n,r,a,i,l,c){return r+(a=="$"?a+i:In(Gp(i)+e.c))+(l=="$"?l+c:Jn(Hp(c)+e.r))})}function ZB(t,e,n){var r=El(e),a=r.s,i=hr(n),l={r:i.r-a.r,c:i.c-a.c};return fS(t,l)}function QB(t){return t.length!=1}function eT(t){return t.replace(/_xlfn\./g,"")}function Sn(t){t.l+=1}function ni(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function dS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return hS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),i=t.read_shift(r),l=ni(t),c=ni(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function hS(t){var e=ni(t),n=ni(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function ej(t,e,n){if(n.biff<8)return hS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),i=ni(t),l=ni(t);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function mS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return tj(t);var r=t.read_shift(n&&n.biff==12?4:2),a=ni(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function tj(t){var e=ni(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function nj(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function rj(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return aj(t);var a=t.read_shift(r>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function aj(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function sj(t,e,n){var r=(t[t.l++]&96)>>5,a=dS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function ij(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=dS(t,i,n);return[r,a,l]}function oj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function lj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[r,a]}function cj(t,e,n){var r=(t[t.l++]&96)>>5,a=ej(t,e-1,n);return[r,a]}function uj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function tT(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function fj(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],i=0;i<=r;++i)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function dj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function hj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function mj(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function pj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function pS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function gj(t){return t.read_shift(2),pS(t)}function xj(t){return t.read_shift(2),pS(t)}function vj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=mS(t,0,n);return[r,a]}function yj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=rj(t,0,n);return[r,a]}function _j(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var i=mS(t,0,n);return[r,a,i]}function wj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[TV[a],vS[a],r]}function Tj(t,e,n){var r=t[t.l++],a=t.read_shift(1),i=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:Ej(t);return[a,(i[0]===0?vS:wV)[i[1]]]}function Ej(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Sj(t,e,n){t.l+=n&&n.biff==2?3:4}function bj(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Cj(t){return t.l++,Qi[t.read_shift(1)]}function Aj(t){return t.l++,t.read_shift(2)}function kj(t){return t.l++,t.read_shift(1)!==0}function Nj(t){return t.l++,nr(t)}function Rj(t,e,n){return t.l++,yu(t,e-1,n)}function Dj(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=wn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=Qi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=nr(t);break;case 2:n[1]=eo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Mj(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],i=0;i!=r;++i)a.push((n.biff==12?Zi:jd)(t));return a}function Ij(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=Dj(t,n.biff);return l}function Fj(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,i]}function Lj(t,e,n){if(n.biff==5)return Oj(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[r,a,i]}function Oj(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Pj(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Uj(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Bj(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function jj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[r,a]}var Vj=ir,$j=ir,Hj=ir;function wu(t,e,n){return t.l+=2,[nj(t)]}function Zp(t){return t.l+=6,[]}var Gj=wu,zj=Zp,qj=Zp,Yj=wu;function gS(t){return t.l+=2,[Cn(t),t.read_shift(2)&1]}var Wj=wu,Jj=gS,Kj=Zp,Xj=wu,Zj=wu,Qj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eV(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=Qj[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:i}}function tV(t){return t.l+=2,[t.read_shift(4)]}function nV(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function rV(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function aV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function sV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function iV(t){return t.l+=4,[0,0]}var nT={1:{n:"PtgExp",f:bj},2:{n:"PtgTbl",f:Hj},3:{n:"PtgAdd",f:Sn},4:{n:"PtgSub",f:Sn},5:{n:"PtgMul",f:Sn},6:{n:"PtgDiv",f:Sn},7:{n:"PtgPower",f:Sn},8:{n:"PtgConcat",f:Sn},9:{n:"PtgLt",f:Sn},10:{n:"PtgLe",f:Sn},11:{n:"PtgEq",f:Sn},12:{n:"PtgGe",f:Sn},13:{n:"PtgGt",f:Sn},14:{n:"PtgNe",f:Sn},15:{n:"PtgIsect",f:Sn},16:{n:"PtgUnion",f:Sn},17:{n:"PtgRange",f:Sn},18:{n:"PtgUplus",f:Sn},19:{n:"PtgUminus",f:Sn},20:{n:"PtgPercent",f:Sn},21:{n:"PtgParen",f:Sn},22:{n:"PtgMissArg",f:Sn},23:{n:"PtgStr",f:Rj},26:{n:"PtgSheet",f:nV},27:{n:"PtgEndSheet",f:rV},28:{n:"PtgErr",f:Cj},29:{n:"PtgBool",f:kj},30:{n:"PtgInt",f:Aj},31:{n:"PtgNum",f:Nj},32:{n:"PtgArray",f:uj},33:{n:"PtgFunc",f:wj},34:{n:"PtgFuncVar",f:Tj},35:{n:"PtgName",f:Fj},36:{n:"PtgRef",f:vj},37:{n:"PtgArea",f:sj},38:{n:"PtgMemArea",f:Pj},39:{n:"PtgMemErr",f:Vj},40:{n:"PtgMemNoMem",f:$j},41:{n:"PtgMemFunc",f:Uj},42:{n:"PtgRefErr",f:Bj},43:{n:"PtgAreaErr",f:oj},44:{n:"PtgRefN",f:yj},45:{n:"PtgAreaN",f:cj},46:{n:"PtgMemAreaN",f:aV},47:{n:"PtgMemNoMemN",f:sV},57:{n:"PtgNameX",f:Lj},58:{n:"PtgRef3d",f:_j},59:{n:"PtgArea3d",f:ij},60:{n:"PtgRefErr3d",f:jj},61:{n:"PtgAreaErr3d",f:lj},255:{}},oV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lV={1:{n:"PtgElfLel",f:gS},2:{n:"PtgElfRw",f:Xj},3:{n:"PtgElfCol",f:Gj},6:{n:"PtgElfRwV",f:Zj},7:{n:"PtgElfColV",f:Yj},10:{n:"PtgElfRadical",f:Wj},11:{n:"PtgElfRadicalS",f:Kj},13:{n:"PtgElfColS",f:zj},15:{n:"PtgElfColSV",f:qj},16:{n:"PtgElfRadicalLel",f:Jj},25:{n:"PtgList",f:eV},29:{n:"PtgSxName",f:tV},255:{}},cV={0:{n:"PtgAttrNoop",f:iV},1:{n:"PtgAttrSemi",f:pj},2:{n:"PtgAttrIf",f:hj},4:{n:"PtgAttrChoose",f:fj},8:{n:"PtgAttrGoto",f:dj},16:{n:"PtgAttrSum",f:Sj},32:{n:"PtgAttrBaxcel",f:tT},33:{n:"PtgAttrBaxcel",f:tT},64:{n:"PtgAttrSpace",f:gj},65:{n:"PtgAttrSpaceSemi",f:xj},128:{n:"PtgAttrIfError",f:mj},255:{}};function Tu(t,e,n,r){if(r.biff<8)return ir(t,e);for(var a=t.l+e,i=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=Ij(t,0,r),i.push(n[l][1]);break;case"PtgMemArea":n[l][2]=Mj(t,n[l][1],r),i.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),i.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&i.push(ir(t,e)),i}function Eu(t,e,n){for(var r=t.l+e,a,i,l=[];r!=t.l;)e=r-t.l,i=t[t.l],a=nT[i]||nT[oV[i]],(i===24||i===25)&&(a=(i===24?lV:cV)[t[t.l+1]]),!a||!a.f?ir(t,e):l.push([a.n,a.f(t,e,n)]);return l}function uV(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var fV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function xS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function rT(t,e,n){var r=xS(t,e,n);return r=="#REF"?r:dV(r,n)}function tr(t,e,n,r,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},c=[],d,f,g,v=0,_=0,T,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,b="",k=0,A=t[0].length;k<A;++k){var C=t[0][k];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:b=gn(" ",t[0][S][1][1]);break;case 1:b=gn("\r",t[0][S][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}f=f+b,S=-1}c.push(f+fV[C[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Bc(C[1][1],l,a),c.push(jc(g,i));break;case"PtgRefN":g=n?Bc(C[1][1],n,a):C[1][1],c.push(jc(g,i));break;case"PtgRef3d":v=C[1][1],g=Bc(C[1][2],l,a),E=rT(r,v,a),c.push(E+"!"+jc(g,i));break;case"PtgFunc":case"PtgFuncVar":var M=C[1][0],B=C[1][1];M||(M=0),M&=127;var H=M==0?[]:c.slice(-M);c.length-=M,B==="User"&&(B=H.shift()),c.push(B+"("+H.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":T=Pw(C[1][1],n?{s:n}:l,a),c.push(dm(T,a));break;case"PtgArea":T=Pw(C[1][1],l,a),c.push(dm(T,a));break;case"PtgArea3d":v=C[1][1],T=C[1][2],E=rT(r,v,a),c.push(E+"!"+dm(T,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=C[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],K=F?F.Name:"SH33TJSNAME"+String(_);K&&K.slice(0,6)=="_xlfn."&&!a.xlfn&&(K=K.slice(6)),c.push(K);break;case"PtgNameX":var P=C[1][1];_=C[1][2];var ae;if(a.biff<=5)P<0&&(P=-P),r[P]&&(ae=r[P][_]);else{var G="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][_]&&r[P][_].itab>0&&(G=r.SheetNames[r[P][_].itab-1]+"!"):G=r.SheetNames[_-1]+"!"),r[P]&&r[P][_])G+=r[P][_].Name;else if(r[0]&&r[0][_])G+=r[0][_].Name;else{var te=(xS(r,P,a)||"").split(";;");te[_-1]?G=te[_-1]:G+="SH33TJSERRX"}c.push(G);break}ae||(ae={Name:"SH33TJSERRY"}),c.push(ae.Name);break;case"PtgParen":var we="(",Re=")";if(S>=0){switch(b="",t[0][S][1][0]){case 2:we=gn(" ",t[0][S][1][1])+we;break;case 3:we=gn("\r",t[0][S][1][1])+we;break;case 4:Re=gn(" ",t[0][S][1][1])+Re;break;case 5:Re=gn("\r",t[0][S][1][1])+Re;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(we+c.pop()+Re);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var ye={c:n.c,r:n.r};if(r.sharedf[ot(g)]){var se=r.sharedf[ot(g)];c.push(tr(se,l,ye,r,a))}else{var me=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(tr(f[1],l,ye,r,a)),me=!0;break}me||c.push(C[1])}break;case"PtgArray":c.push("{"+uV(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&re.indexOf(t[0][k][0])==-1){C=t[0][S];var J=!0;switch(C[1][0]){case 4:J=!1;case 0:b=gn(" ",C[1][1]);break;case 5:J=!1;case 1:b=gn("\r",C[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((J?b:"")+c.pop()+(J?"":b)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function hV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],ir(t,e-2)];var c=Eu(t,l,n);return e!==l+a&&(i=Tu(t,e-l-a,c,n)),t.l=r,[c,i]}function mV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],ir(t,e-2)];var c=Eu(t,l,n);return e!==l+a&&(i=Tu(t,e-l-a,c,n)),t.l=r,[c,i]}function pV(t,e,n,r){var a=t.l+e,i=Eu(t,r,n),l;return a!==t.l&&(l=Tu(t,a-t.l,i,n)),[i,l]}function gV(t,e,n){var r=t.l+e,a,i=t.read_shift(2),l=Eu(t,i,n);return i==65535?[[],ir(t,e-2)]:(e!==i+2&&(a=Tu(t,r-i-2,l,n)),[l,a])}function xV(t){var e;if(as(t,t.l+6)!==65535)return[nr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function pm(t,e,n){var r=t.l+e,a=Pa(t);n.biff==2&&++t.l;var i=xV(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=mV(t,r-t.l,n);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function Vd(t,e,n){var r=t.read_shift(4),a=Eu(t,r,n),i=t.read_shift(4),l=i>0?Tu(t,i,a,n):null;return[a,l]}var vV=Vd,$d=Vd,yV=Vd,_V=Vd,wV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function aT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function gm(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Gc={},al={};function zc(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function yS(t,e,n,r,a,i){try{r.cellNF&&(t.z=ut[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=$n(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&Mi(EP[e]||"General",e),t.t==="e")t.w=t.w||Qi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v);else if(t.t==="d"){var l=gr(t.v);(l|0)===l?t.w=l.toString(10):t.w=tu(l)}else{if(t.v===void 0)return"";t.w=Vi(t.v,al)}else t.t==="d"?t.w=Zr(e,gr(t.v),al):t.w=Zr(e,t.v,al)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=i.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ed(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ed(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&i.Fills)throw c}}}function EV(t,e){var n=xn(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=Nt(n))}var SV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,CV=/<(?:\w:)?hyperlink [^>]*>/mg,AV=/"(\w*:\w*)"/,kV=/<(?:\w:)?col\b[^>]*[\/]?>/g,NV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RV=/<(?:\w:)?pageMargins[^>]*\/>/g,_S=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,MV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IV(t,e,n,r,a,i,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",g="",v=t.match(bV);v?(f=t.slice(0,v.index),g=t.slice(v.index+v[0].length)):f=g=t;var _=f.match(_S);_?Qp(_[0],c,a,n):(_=f.match(DV))&&FV(_[0],_[1]||"",c,a,n);var T=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var E=f.slice(T,T+50).match(AV);E&&EV(c,E[1])}var S=f.match(MV);S&&S[1]&&jV(S[1],a);var b=[];if(e.cellStyles){var k=f.match(kV);k&&PV(b,k)}v&&VV(v[1],c,e,d,i,l);var A=g.match(NV);A&&(c["!autofilter"]=UV(A[0]));var C=[],M=g.match(SV);if(M)for(T=0;T!=M.length;++T)C[T]=xn(M[T].slice(M[T].indexOf('"')+1));var B=g.match(CV);B&&LV(c,B,r);var H=g.match(RV);if(H&&(c["!margins"]=OV(et(H[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=Nt(d)),e.sheetRows>0&&c["!ref"]){var F=xn(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>d.e.r&&(F.e.r=d.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>d.e.c&&(F.e.c=d.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nt(F))}return b.length>0&&(c["!cols"]=b),C.length>0&&(c["!merges"]=C),c}function Qp(t,e,n,r){var a=et(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Rt(Kt(a.codeName)))}function FV(t,e,n,r,a){Qp(t.slice(0,t.indexOf(">")),n,r,a)}function LV(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var i=et(Kt(e[a]),!0);if(!i.ref)return;var l=((n||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Rt(i.location))):(i.Target="#"+Rt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=xn(i.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var g=ot({c:f,r:d});r?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=i):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=i)}}}function OV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function PV(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=et(e[r],!0);a.hidden&&(a.hidden=nn(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,Xp(a.width)),hl(a);i<=l;)t[i++]=Wn(a)}}function UV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var BV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jV(t,e){e.Views||(e.Views=[{}]),(t.match(BV)||[]).forEach(function(n,r){var a=et(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),nn(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var VV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=nu("v"),l=nu("f");return function(d,f,g,v,_,T){for(var E=0,S="",b=[],k=[],A=0,C=0,M=0,B="",H,F,K=0,P=0,ae,G,te=0,we=0,Re=Array.isArray(T.CellXf),ye,se=[],me=[],re=Array.isArray(f),J=[],D={},ee=!1,I=!!g.sheetStubs,W=d.split(e),X=0,q=W.length;X!=q;++X){S=W[X].trim();var oe=S.length;if(oe!==0){var _e=0;e:for(E=0;E<oe;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(F=et(S.slice(_e,E),!0),K=F.r!=null?parseInt(F.r,10):K+1,P=-1,g.sheetRows&&g.sheetRows<K)continue;D={},ee=!1,F.ht&&(ee=!0,D.hpt=parseFloat(F.ht),D.hpx=iu(D.hpt)),F.hidden=="1"&&(ee=!0,D.hidden=!0),F.outlineLevel!=null&&(ee=!0,D.level=+F.outlineLevel),ee&&(J[K-1]=D)}break;case"<":_e=E;break}if(_e>=E)break;if(F=et(S.slice(_e,E),!0),K=F.r!=null?parseInt(F.r,10):K+1,P=-1,!(g.sheetRows&&g.sheetRows<K)){v.s.r>K-1&&(v.s.r=K-1),v.e.r<K-1&&(v.e.r=K-1),g&&g.cellStyles&&(D={},ee=!1,F.ht&&(ee=!0,D.hpt=parseFloat(F.ht),D.hpx=iu(D.hpt)),F.hidden=="1"&&(ee=!0,D.hidden=!0),F.outlineLevel!=null&&(ee=!0,D.level=+F.outlineLevel),ee&&(J[K-1]=D)),b=S.slice(E).split(t);for(var Se=0;Se!=b.length&&b[Se].trim().charAt(0)=="<";++Se);for(b=b.slice(Se),E=0;E!=b.length;++E)if(S=b[E].trim(),S.length!==0){if(k=S.match(n),A=E,C=0,M=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(A=0,B=k[1],C=0;C!=B.length&&!((M=B.charCodeAt(C)-64)<1||M>26);++C)A=26*A+M;--A,P=A}else++P;for(C=0;C!=S.length&&S.charCodeAt(C)!==62;++C);if(++C,F=et(S.slice(0,C),!0),F.r||(F.r=ot({r:K-1,c:P})),B=S.slice(C),H={t:""},(k=B.match(i))!=null&&k[1]!==""&&(H.v=Rt(k[1])),g.cellFormula){if((k=B.match(l))!=null&&k[1]!==""){if(H.f=Rt(Kt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(H.f=eT(H.f)),k[0].indexOf('t="array"')>-1)H.F=(B.match(a)||[])[1],H.F.indexOf(":")>-1&&se.push([xn(H.F),H.F]);else if(k[0].indexOf('t="shared"')>-1){G=et(k[0]);var Ee=Rt(Kt(k[1]));g.xlfn||(Ee=eT(Ee)),me[parseInt(G.si,10)]=[G,Ee,F.r]}}else(k=B.match(/<f[^>]*\/>/))&&(G=et(k[0]),me[G.si]&&(H.f=ZB(me[G.si][1],me[G.si][2],F.r)));var Ce=hr(F.r);for(C=0;C<se.length;++C)Ce.r>=se[C][0].s.r&&Ce.r<=se[C][0].e.r&&Ce.c>=se[C][0].s.c&&Ce.c<=se[C][0].e.c&&(H.F=se[C][1])}if(F.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(I)H.t="z";else continue;else H.t=F.t||"n";switch(v.s.c>P&&(v.s.c=P),v.e.c<P&&(v.e.c=P),H.t){case"n":if(H.v==""||H.v==null){if(!I)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!I)continue;H.t="z"}else ae=Gc[parseInt(H.v,10)],H.v=ae.t,H.r=ae.r,g.cellHTML&&(H.h=ae.h);break;case"str":H.t="s",H.v=H.v!=null?Kt(H.v):"",g.cellHTML&&(H.h=jp(H.v));break;case"inlineStr":k=B.match(r),H.t="s",k!=null&&(ae=Kp(k[1]))?(H.v=ae.t,g.cellHTML&&(H.h=ae.h)):H.v="";break;case"b":H.v=nn(H.v);break;case"d":g.cellDates?H.v=$n(H.v,1):(H.v=gr($n(H.v,1)),H.t="n");break;case"e":(!g||g.cellText!==!1)&&(H.w=H.v),H.v=VE[H.v];break}if(te=we=0,ye=null,Re&&F.s!==void 0&&(ye=T.CellXf[F.s],ye!=null&&(ye.numFmtId!=null&&(te=ye.numFmtId),g.cellStyles&&ye.fillId!=null&&(we=ye.fillId))),yS(H,te,we,g,_,T),g.cellDates&&Re&&H.t=="n"&&Tl(ut[te])&&(H.t="d",H.v=Bd(H.v)),F.cm&&g.xlmeta){var Ke=(g.xlmeta.Cell||[])[+F.cm-1];Ke&&Ke.type=="XLDAPR"&&(H.D=!0)}if(re){var Z=hr(F.r);f[Z.r]||(f[Z.r]=[]),f[Z.r][Z.c]=H}else f[F.r]=H}}}}J.length>0&&(f["!rows"]=J)}}();function $V(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=r,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=a/20),n}var HV=Zi;function GV(){}function zV(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=hU(t),n}function qV(t){var e=ea(t);return[e]}function YV(t){var e=Xi(t);return[e]}function WV(t){var e=ea(t),n=t.read_shift(1);return[e,n,"b"]}function JV(t){var e=Xi(t),n=t.read_shift(1);return[e,n,"b"]}function KV(t){var e=ea(t),n=t.read_shift(1);return[e,n,"e"]}function XV(t){var e=Xi(t),n=t.read_shift(1);return[e,n,"e"]}function ZV(t){var e=ea(t),n=t.read_shift(4);return[e,n,"s"]}function QV(t){var e=Xi(t),n=t.read_shift(4);return[e,n,"s"]}function e$(t){var e=ea(t),n=nr(t);return[e,n,"n"]}function wS(t){var e=Xi(t),n=nr(t);return[e,n,"n"]}function t$(t){var e=ea(t),n=Yp(t);return[e,n,"n"]}function n$(t){var e=Xi(t),n=Yp(t);return[e,n,"n"]}function r$(t){var e=ea(t),n=zp(t);return[e,n,"is"]}function a$(t){var e=ea(t),n=sr(t);return[e,n,"str"]}function s$(t){var e=Xi(t),n=sr(t);return[e,n,"str"]}function i$(t,e,n){var r=t.l+e,a=ea(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function o$(t,e,n){var r=t.l+e,a=ea(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function l$(t,e,n){var r=t.l+e,a=ea(t);a.r=n["!row"];var i=nr(t),l=[a,i,"n"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function c$(t,e,n){var r=t.l+e,a=ea(t);a.r=n["!row"];var i=sr(t),l=[a,i,"str"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}var u$=Zi;function f$(t,e){var n=t.l+e,r=Zi(t),a=qp(t),i=sr(t),l=sr(t),c=sr(t);t.l=n;var d={rfx:r,relId:a,loc:i,display:c};return l&&(d.Tooltip=l),d}function d$(){}function h$(t,e,n){var r=t.l+e,a=UE(t),i=t.read_shift(1),l=[a];if(l[2]=i,n.cellFormula){var c=vV(t,r-t.l,n);l[1]=c}else t.l=r;return l}function m$(t,e,n){var r=t.l+e,a=Zi(t),i=[a];if(n.cellFormula){var l=_V(t,r-t.l,n);i[1]=l,t.l=r}else t.l=r;return i}var p$=["left","right","top","bottom","header","footer"];function g$(t){var e={};return p$.forEach(function(n){e[n]=nr(t)}),e}function x$(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function v$(){}function y$(){}function _$(t,e,n,r,a,i,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var d=c.dense?[]:{},f,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,T,E,S,b,k,A,C,M,B,H=[];c.biff=12,c["!row"]=0;var F=0,K=!1,P=[],ae={},G=c.supbooks||a.supbooks||[[]];if(G.sharedf=ae,G.arrayf=P,G.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!c.supbooks&&(c.supbooks=G,a.Names))for(var te=0;te<a.Names.length;++te)G[0][te+1]=a.Names[te];var we=[],Re=[],ye=!1;Cd[16]={n:"BrtShortReal",f:wS};var se;if(ms(t,function(J,D,ee){if(!_)switch(ee){case 148:f=J;break;case 0:T=J,c.sheetRows&&c.sheetRows<=T.r&&(_=!0),M=Jn(b=T.r),c["!row"]=T.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=iu(J.hpt)),Re[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:J[2]},J[2]){case"n":E.v=J[1];break;case"s":C=Gc[J[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!J[1];break;case"e":E.v=J[1],c.cellText!==!1&&(E.w=Qi[E.v]);break;case"str":E.t="s",E.v=J[1];break;case"is":E.t="s",E.v=J[1].t;break}if((S=l.CellXf[J[0].iStyleRef])&&yS(E,S.numFmtId,null,c,i,l),k=J[0].c==-1?k+1:J[0].c,c.dense?(d[b]||(d[b]=[]),d[b][k]=E):d[In(k)+M]=E,c.cellFormula){for(K=!1,F=0;F<P.length;++F){var I=P[F];T.r>=I[0].s.r&&T.r<=I[0].e.r&&k>=I[0].s.c&&k<=I[0].e.c&&(E.F=Nt(I[0]),K=!0)}!K&&J.length>3&&(E.f=J[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),c.cellDates&&S&&E.t=="n"&&Tl(ut[S.numFmtId])){var W=Ri(E.v);W&&(E.t="d",E.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;E={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,c.dense?(d[b]||(d[b]=[]),d[b][k]=E):d[In(k)+M]=E,g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 176:H.push(J);break;case 49:se=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var X=r["!id"][J.relId];for(X?(J.Target=X.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=X):J.relId==""&&(J.Target="#"+J.loc),b=J.rfx.s.r;b<=J.rfx.e.r;++b)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)c.dense?(d[b]||(d[b]=[]),d[b][k]||(d[b][k]={t:"z",v:void 0}),d[b][k].l=J):(A=ot({c:k,r:b}),d[A]||(d[A]={t:"z",v:void 0}),d[A].l=J);break;case 426:if(!c.cellFormula)break;P.push(J),B=c.dense?d[b][k]:d[In(k)+M],B.f=tr(J[1],g,{r:T.r,c:k},G,c),B.F=Nt(J[0]);break;case 427:if(!c.cellFormula)break;ae[ot(J[0].s)]=J[1],B=c.dense?d[b][k]:d[In(k)+M],B.f=tr(J[1],g,{r:T.r,c:k},G,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)we[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},ye||(ye=!0,Xp(J.w/256)),hl(we[J.e+1]);break;case 161:d["!autofilter"]={ref:Nt(J)};break;case 476:d["!margins"]=J;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),J.name&&(a.Sheets[n].CodeName=J.name),(J.above||J.left)&&(d["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!D.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(g.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=Nt(f||g)),c.sheetRows&&d["!ref"]){var me=xn(d["!ref"]);c.sheetRows<=+me.e.r&&(me.e.r=c.sheetRows-1,me.e.r>g.e.r&&(me.e.r=g.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>g.e.c&&(me.e.c=g.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Nt(me))}return H.length>0&&(d["!merges"]=H),we.length>0&&(d["!cols"]=we),Re.length>0&&(d["!rows"]=Re),d}function w$(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=Rt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[e,a,r]}function T$(t,e,n,r,a,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,d=0,f="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=w$(v);g.s.r=g.s.c=0,g.e.c=c,f=In(c),_[0].forEach(function(T,E){l[f+Jn(E)]={t:"n",v:T,z:_[1]},d=E}),g.e.r<d&&(g.e.r=d),++c}),c>0&&(l["!ref"]=Nt(g)),l}function E$(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(_S);return c&&Qp(c[0],i,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function S$(t,e){t.l+=10;var n=sr(t);return{name:n}}function b$(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ms(t,function(d,f,g){switch(g){case 550:i["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var TS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],C$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],A$=[],k$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function sT(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var i=e[a];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=nn(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function iT(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=nn(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function ES(t){iT(t.WBProps,TS),iT(t.CalcPr,k$),sT(t.WBView,C$),sT(t.Sheets,A$),al.date1904=nn(t.WBProps.date1904)}var N$="][*?/\\".split("");function R$(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return N$.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var D$=/<\w+:workbook/;function M$(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},l=0;if(t.replace(or,function(d,f){var g=et(d);switch(Oa(g[0])){case"<?xml":break;case"<workbook":d.match(D$)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":TS.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":n.WBProps[v[0]]=nn(g[v[0]]);break;case"int":n.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:n.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(n.WBProps.CodeName=Kt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Rt(Kt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Kt(g.name),g.comment&&(i.Comment=g.comment),g.localSheetId&&(i.Sheet=+g.localSheetId),nn(g.hidden||"0")&&(i.Hidden=!0),l=f+d.length;break;case"</definedName>":i.Ref=Rt(Kt(t.slice(l,f))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),KP.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return ES(n),n}function I$(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=Qm(t),n.name=sr(t),n}function F$(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?sr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function L$(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function O$(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=mU(t),l=yV(t,0,n),c=qp(t);t.l=r;var d={Name:i,Ptg:l};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function P$(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Cd[16]={n:"BrtFRTArchID$",f:L$},ms(t,function(d,f,g){switch(g){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=tr(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),ES(n),n.Names=i,n.supbooks=l,n}function U$(t,e,n){return e.slice(-4)===".bin"?P$(t,n):M$(t,n)}function B$(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?_$(t,r,n,a,i,l,c):IV(t,r,n,a,i,l,c)}function j$(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?b$(t,r,n,a,i):E$(t,r,n,a,i)}function V$(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?JB():KB()}function $$(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?YB():WB()}function H$(t,e,n,r){return e.slice(-4)===".bin"?uB(t,n,r):aB(t,n,r)}function G$(t,e,n){return cS(t,n)}function z$(t,e,n){return e.slice(-4)===".bin"?C9(t,n):S9(t,n)}function q$(t,e,n){return e.slice(-4)===".bin"?GB(t,n):BB(t,n)}function Y$(t,e,n){return e.slice(-4)===".bin"?OB(t):FB(t)}function W$(t,e,n,r){return n.slice(-4)===".bin"?PB(t,e,n,r):void 0}function J$(t,e,n){return e.slice(-4)===".bin"?MB(t,e,n):IB(t,e,n)}var SS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,bS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ia(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(SS),i,l,c,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(bS),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),r[c]=i[2].slice(1,i[2].length-1));return r}function K$(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(SS),a,i,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(bS),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}var qc;function X$(t,e){var n=qc[t]||Rt(t);return n==="General"?Vi(e):Zr(n,e)}function Z$(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=nn(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=$n(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[Rt(e)]=a}function Q$(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Qi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v):t.w=Vi(t.v):t.w=X$(e||"General",t.v)}catch(i){if(n.WTF)throw i}try{var r=qc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&Tl(r)){var a=Ri(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function eH(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=Z9[r.Pattern]||r.Pattern)}t[e.ID]=e}function tH(t,e,n,r,a,i,l,c,d,f){var g="General",v=r.StyleID,_={};f=f||{};var T=[],E=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);i[v]!==void 0&&(i[v].nf&&(g=i[v].nf),i[v].Interior&&T.push(i[v].Interior),!!i[v].Parent);)v=i[v].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=nn(t);break;case"String":r.t="s",r.r=kw(Rt(t)),r.v=t.indexOf("<")>-1?Rt(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=($n(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Rt(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=VE[t],f.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=kw(e||t));break}if(Q$(r,g,f),f.cellFormula!==!1)if(r.Formula){var S=Rt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=rl(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=rl("RC:RC",a):r.ArrayRange&&(r.F=rl(r.ArrayRange,a),d.push([xn(r.F),r.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(r.F=d[E][1]);f.cellStyles&&(T.forEach(function(b){!_.patternType&&b.patternType&&(_.patternType=b.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function nH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function xm(t,e){var n=e||{};hE();var r=Nc(Vp(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Kt(r));var a=r.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Wn(n);return l.type="string",au.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ut){a.indexOf("<"+Ut)>=0&&(i=!0)}),i)return fH(r,n);qc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,g={},v=[],_=n.dense?[]:{},T="",E={},S={},b=ia('<Data ss:Type="String">'),k=0,A=0,C=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},H={},F="",K=0,P=[],ae={},G={},te=0,we=[],Re=[],ye={},se=[],me,re=!1,J=[],D=[],ee={},I=0,W=0,X={Sheets:[],WBProps:{date1904:!1}},q={};ru.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=ru.exec(r);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?tH(r.slice(k,c.index),F,b,d[d.length-1][0]=="comment"?ye:E,{c:A,r:C},B,se[A],S,J,n):(F="",b=ia(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Re.length>0&&(E.c=Re),(!n.sheetRows||n.sheetRows>C)&&E.v!==void 0&&(n.dense?(_[C]||(_[C]=[]),_[C][A]=E):_[In(A)+Jn(C)]=E),E.HRef&&(E.l={Target:Rt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(I=A+(parseInt(E.MergeAcross,10)|0),W=C+(parseInt(E.MergeDown,10)|0),P.push({s:{c:A,r:C},e:{c:I,r:W}})),!n.sheetStubs)E.MergeAcross?A=I+1:++A;else if(E.MergeAcross||E.MergeDown){for(var _e=A;_e<=I;++_e)for(var Se=C;Se<=W;++Se)(_e>A||Se>C)&&(n.dense?(_[Se]||(_[Se]=[]),_[Se][_e]={t:"z"}):_[In(_e)+Jn(Se)]={t:"z"});A=I+1}else++A;else E=K$(c[0]),E.Index&&(A=+E.Index-1),A<M.s.c&&(M.s.c=A),A>M.e.c&&(M.e.c=A),c[0].slice(-2)==="/>"&&++A,Re=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<M.s.r&&(M.s.r=C),C>M.e.r&&(M.e.r=C),c[0].slice(-2)==="/>"&&(S=ia(c[0]),S.Index&&(C=+S.Index-1)),A=0,++C):(S=ia(c[0]),S.Index&&(C=+S.Index-1),ee={},(S.AutoFitHeight=="0"||S.Height)&&(ee.hpx=parseInt(S.Height,10),ee.hpt=lS(ee.hpx),D[C]=ee),S.Hidden=="1"&&(ee.hidden=!0,D[C]=ee));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));v.push(T),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(_["!ref"]=Nt(M),n.sheetRows&&n.sheetRows<=M.e.r&&(_["!fullref"]=_["!ref"],M.e.r=n.sheetRows-1,_["!ref"]=Nt(M))),P.length&&(_["!merges"]=P),se.length>0&&(_["!cols"]=se),D.length>0&&(_["!rows"]=D),g[T]=_}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=A=0,d.push([c[3],!1]),f=ia(c[0]),T=Rt(f.Name),_=n.dense?[]:{},P=[],J=[],D=[],q={name:T,Hidden:0},X.Sheets.push(q);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),se=[],re=!1}break;case"style":c[1]==="/"?eH(B,H,n):H=ia(c[0]);break;case"numberformat":H.nf=Rt(ia(c[0]).Format||"General"),qc[H.nf]&&(H.nf=qc[H.nf]);for(var Ee=0;Ee!=392&&ut[Ee]!=H.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(ut[Ee]==null){Mi(H.nf,Ee);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(me=ia(c[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!re&&me.wpx>10){re=!0,dr=iS;for(var Ce=0;Ce<se.length;++Ce)se[Ce]&&hl(se[Ce])}re&&hl(me),se[me.Index-1||se.length]=me;for(var Ke=0;Ke<+me.Span;++Ke)se[se.length]=Wn(me);break;case"namedrange":if(c[1]==="/")break;X.Names||(X.Names=[]);var Z=et(c[0]),ft={Name:Z.Name,Ref:rl(Z.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(ft.Sheet=X.Sheets.length-1),X.Names.push(ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(K,c.index):K=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;H.Interior=ia(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?BU(ae,oe,r.slice(te,c.index)):te=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));nH(ye),Re.push(ye)}else d.push([c[3],!1]),f=ia(c[0]),ye={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Xe=ia(c[0]);_["!autofilter"]={ref:rl(Xe.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return dT(r,n);var wt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:wt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(te,c.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else te=c.index+c[0].length;break;case"header":_["!margins"]||zc(_["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(_["!margins"].header=+et(c[0]).Margin);break;case"footer":_["!margins"]||zc(_["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(_["!margins"].footer=+et(c[0]).Margin);break;case"pagemargins":var rt=et(c[0]);_["!margins"]||zc(_["!margins"]={},"xlml"),isNaN(+rt.Top)||(_["!margins"].top=+rt.Top),isNaN(+rt.Left)||(_["!margins"].left=+rt.Left),isNaN(+rt.Right)||(_["!margins"].right=+rt.Right),isNaN(+rt.Bottom)||(_["!margins"].bottom=+rt.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wt=!1}break;case"smarttags":break;default:wt=!1;break}if(wt||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Z$(G,oe,we,r.slice(te,c.index)):(we=c,te=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Fe={};return!n.bookSheets&&!n.bookProps&&(Fe.Sheets=g),Fe.SheetNames=v,Fe.Workbook=X,Fe.SSF=Wn(ut),Fe.Props=ae,Fe.Custprops=G,Fe}function rp(t,e){switch(ng(e=e||{}),e.type||"base64"){case"base64":return xm(Or(t),e);case"binary":case"buffer":case"file":return xm(t,e);case"array":return xm(Ki(t),e)}}function rH(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=xU(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=vU(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var aH=[60,1084,2066,2165,2175];function sH(t,e,n,r,a){var i=r,l=[],c=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=i;for(var d=as(n,n.l),f=ap[d],g=0;f!=null&&aH.indexOf(d)>-1;)i=as(n,n.l+2),g=n.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),c=n.slice(g,n.l+4+i),l.push(c),n.l+=4+i,f=ap[d=as(n,n.l)];var v=Ys(l);Yn(v,0);var _=0;v.lens=[];for(var T=0;T<l.length;++T)v.lens.push(_),_+=l[T].length;if(v.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+r;return e.f(v,v.length,a)}function Ea(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[r])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Qi[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v):t.w=Vi(t.v):t.w=Zr(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&r&&t.t=="n"&&Tl(ut[r]||String(r))){var a=Ri(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Kf(t,e,n){return{v:t,ixfe:e,t:n}}function iH(t,e){var n={opts:{}},r={},a=e.dense?[]:{},i={},l={},c=null,d=[],f="",g={},v,_="",T,E,S,b,k={},A=[],C,M,B=[],H=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},P=function(tt){return tt<8?Ii[tt]:tt<64&&H[tt-8]||Ii[tt]},ae=function(tt,Et,sn){var Me=Et.XF.data;if(!(!Me||!Me.patternType||!sn||!sn.cellStyles)){Et.s={},Et.s.patternType=Me.patternType;var Ye;(Ye=su(P(Me.icvFore)))&&(Et.s.fgColor={rgb:Ye}),(Ye=su(P(Me.icvBack)))&&(Et.s.bgColor={rgb:Ye})}},G=function(tt,Et,sn){if(!(ee>1)&&!(sn.sheetRows&&tt.r>=sn.sheetRows)){if(sn.cellStyles&&Et.XF&&Et.XF.data&&ae(tt,Et,sn),delete Et.ixfe,delete Et.XF,v=tt,_=ot(tt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<l.s.r&&(l.s.r=tt.r),tt.c<l.s.c&&(l.s.c=tt.c),tt.r+1>l.e.r&&(l.e.r=tt.r+1),tt.c+1>l.e.c&&(l.e.c=tt.c+1),sn.cellFormula&&Et.f){for(var Me=0;Me<A.length;++Me)if(!(A[Me][0].s.c>tt.c||A[Me][0].s.r>tt.r)&&!(A[Me][0].e.c<tt.c||A[Me][0].e.r<tt.r)){Et.F=Nt(A[Me][0]),(A[Me][0].s.c!=tt.c||A[Me][0].s.r!=tt.r)&&delete Et.f,Et.f&&(Et.f=""+tr(A[Me][1],l,tt,J,te));break}}sn.dense?(a[tt.r]||(a[tt.r]=[]),a[tt.r][tt.c]=Et):a[_]=Et}},te={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(te.password=e.password);var we,Re=[],ye=[],se=[],me=[],re=!1,J=[];J.SheetNames=te.snames,J.sharedf=te.sharedf,J.arrayf=te.arrayf,J.names=[],J.XTI=[];var D=0,ee=0,I=0,W=[],X=[],q;te.codepage=1200,fa(1200);for(var oe=!1;t.l<t.length-1;){var _e=t.l,Se=t.read_shift(2);if(Se===0&&D===10)break;var Ee=t.l===t.length?0:t.read_shift(2),Ce=ap[Se];if(Ce&&Ce.f){if(e.bookSheets&&D===133&&Se!==133)break;if(D=Se,Ce.r===2||Ce.r==12){var Ke=t.read_shift(2);if(Ee-=2,!te.enc&&Ke!==Se&&((Ke&255)<<8|Ke>>8)!==Se)throw new Error("rt mismatch: "+Ke+"!="+Se);Ce.r==12&&(t.l+=10,Ee-=10)}var Z={};if(Se===10?Z=Ce.f(t,Ee,te):Z=sH(Se,Ce,t,Ee,te),ee==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(Se){case 34:n.opts.Date1904=F.WBProps.date1904=Z;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(te.enc||(t.l=0),te.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=Z;break;case 66:var ft=Number(Z);switch(ft){case 21010:ft=1200;break;case 32768:ft=1e4;break;case 32769:ft=1252;break}fa(te.codepage=ft),oe=!0;break;case 317:te.rrtabid=Z;break;case 25:te.winlocked=Z;break;case 439:n.opts.RefreshAll=Z;break;case 12:n.opts.CalcCount=Z;break;case 16:n.opts.CalcDelta=Z;break;case 17:n.opts.CalcIter=Z;break;case 13:n.opts.CalcMode=Z;break;case 14:n.opts.CalcPrecision=Z;break;case 95:n.opts.CalcSaveRecalc=Z;break;case 15:te.CalcRefMode=Z;break;case 2211:n.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:B.push(Z);break;case 430:J.push([Z]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(Z);break;case 24:case 536:q={Name:Z.Name,Ref:tr(Z.rgce,l,null,J,te)},Z.itab>0&&(q.Sheet=Z.itab-1),J.names.push(q),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(X[Z.itab-1]={ref:Nt(Z.rgce[0][0][1][2])});break;case 22:te.ExternCount=Z;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(Z),J.XTI=J.XTI.concat(Z);break;case 2196:if(te.biff<8)break;q!=null&&(q.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&te.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,te.snames.push(Z.name);break;case 10:{if(--ee)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Nt(l),e.sheetRows&&e.sheetRows<=l.e.r){var Xe=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Nt(l),l.e.r=Xe}l.e.r++,l.e.c++}Re.length>0&&(a["!merges"]=Re),ye.length>0&&(a["!objects"]=ye),se.length>0&&(a["!cols"]=se),me.length>0&&(a["!rows"]=me),F.Sheets.push(K)}f===""?g=a:r[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),te.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(te.biff=5,oe=!0,fa(te.codepage=28591)),te.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(te.biff=2),ee++)break;if(a=e.dense?[]:{},te.biff<8&&!oe&&(oe=!0,fa(te.codepage=e.codepage||1252)),te.biff<5||Z.BIFFVer==0&&Z.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var wt={pos:t.l-Ee,name:f};i[wt.pos]=wt,te.snames.push(f)}else f=(i[_e]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),Re=[],ye=[],te.arrayf=A=[],se=[],me=[],re=!1,K={Hidden:(i[_e]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[ot({c:Z.c,r:Z.r})])&&++Z.c,C={ixfe:Z.ixfe,XF:B[Z.ixfe]||{},v:Z.val,t:"n"},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 5:case 517:C={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.val,t:Z.t},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 638:C={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.rknum,t:"n"},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 189:for(var rt=Z.c;rt<=Z.C;++rt){var Fe=Z.rkrec[rt-Z.c][0];C={ixfe:Fe,XF:B[Fe],v:Z.rkrec[rt-Z.c][1],t:"n"},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:rt,r:Z.r},C,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){c=Z;break}if(C=Kf(Z.val,Z.cell.ixfe,Z.tt),C.XF=B[C.ixfe],e.cellFormula){var Ut=Z.formula;if(Ut&&Ut[0]&&Ut[0][0]&&Ut[0][0][0]=="PtgExp"){var cn=Ut[0][0][1][0],rn=Ut[0][0][1][1],an=ot({r:cn,c:rn});k[an]?C.f=""+tr(Z.formula,l,Z.cell,J,te):C.F=((e.dense?(a[cn]||[])[rn]:a[an])||{}).F}else C.f=""+tr(Z.formula,l,Z.cell,J,te)}I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G(Z.cell,C,e),c=Z}break;case 7:case 519:if(c)c.val=Z,C=Kf(Z,c.cell.ixfe,"s"),C.XF=B[C.ixfe],e.cellFormula&&(C.f=""+tr(c.formula,l,c.cell,J,te)),I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(Z);var Ln=ot(Z[0].s);if(T=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[Ln],e.cellFormula&&T){if(!c||!Ln||!T)break;T.f=""+tr(Z[1],l,Z[0],J,te),T.F=Nt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!c)break;k[ot(c.cell)]=Z[0],T=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[ot(c.cell)],(T||{}).f=""+tr(Z[0],l,v,J,te)}}break;case 253:C=Kf(d[Z.isst].t,Z.ixfe,"s"),d[Z.isst].h&&(C.h=d[Z.isst].h),C.XF=B[C.ixfe],I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Z.ixfe,XF:B[Z.ixfe],t:"z"},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e));break;case 190:if(e.sheetStubs)for(var Tt=Z.c;Tt<=Z.C;++Tt){var en=Z.ixfe[Tt-Z.c];C={ixfe:en,XF:B[en],t:"z"},I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Tt,r:Z.r},C,e)}break;case 214:case 516:case 4:C=Kf(Z.val,Z.ixfe,"s"),C.XF=B[C.ixfe],I>0&&(C.z=W[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 0:case 512:ee===1&&(l=Z);break;case 252:d=Z;break;case 1054:if(te.biff==4){W[I++]=Z[1];for(var Hn=0;Hn<I+163&&ut[Hn]!=Z[1];++Hn);Hn>=163&&Mi(Z[1],I+163)}else Mi(Z[1],Z[0]);break;case 30:{W[I++]=Z;for(var vn=0;vn<I+163&&ut[vn]!=Z;++vn);vn>=163&&Mi(Z,I+163)}break;case 229:Re=Re.concat(Z);break;case 93:ye[Z.cmo[0]]=te.lastobj=Z;break;case 438:te.lastobj.TxO=Z;break;case 127:te.lastobj.ImData=Z;break;case 440:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[ot({c:S,r:b})],T&&(T.l=Z[1]);break;case 2048:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[ot({c:S,r:b})],T&&T.l&&(T.l.Tooltip=Z[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;T=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[ot(Z[0])];var Zt=ye[Z[2]];T||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),T=a[Z[0].r][Z[0].c]={t:"z"}):T=a[ot(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),T.c||(T.c=[]),E={a:Z[1],t:Zt.TxO.t},T.c.push(E)}break;case 2173:kB(B[Z.ixfe],Z.ext);break;case 125:{if(!te.cellStyles)break;for(;Z.e>=Z.s;)se[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},re||(re=!0,Xp(Z.w/256)),hl(se[Z.e+1])}break;case 520:{var Dt={};Z.level!=null&&(me[Z.r]=Dt,Dt.level=Z.level),Z.hidden&&(me[Z.r]=Dt,Dt.hidden=!0),Z.hpt&&(me[Z.r]=Dt,Dt.hpt=Z.hpt,Dt.hpx=iu(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Se]]=Z;break;case 161:a["!margins"]||zc(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(F.Views[0].RTL=!0);break;case 146:H=Z;break;case 2198:we=Z;break;case 140:M=Z;break;case 442:f?K.CodeName=Z||K.name:F.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+Se.toString(16)),t.l+=Ee}return n.SheetNames=Ma(i).sort(function(it,tt){return Number(it)-Number(tt)}).map(function(it){return i[it].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&X.forEach(function(it,tt){n.Sheets[n.SheetNames[tt]]["!autofilter"]=it}),n.Strings=d,n.SSF=Wn(ut),te.enc&&(n.Encryption=te.enc),we&&(n.Themes=we),n.Metadata={},M!==void 0&&(n.Metadata.Country=M),J.names.length>0&&(F.Names=J.names),n.Workbook=F,n}var oT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oH(t,e,n){var r=kt.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Gw(r,SU,oT.DSI);for(var i in a)e[i]=a[i]}catch(f){if(n.WTF)throw f}var l=kt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=Gw(l,bU,oT.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(n.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(HE(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function CS(t,e){e||(e={}),ng(e),tE(),e.codepage&&Fp(e.codepage);var n,r;if(t.FullPaths){if(kt.find(t,"/encryption"))throw new Error("File is password-protected");n=kt.find(t,"!CompObj"),r=kt.find(t,"/Workbook")||kt.find(t,"/Book")}else{switch(e.type){case"base64":t=ua(Or(t));break;case"binary":t=ua(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Yn(t,0),r={content:t}}var a,i;if(n&&rH(n),e.bookProps&&!e.bookSheets)a={};else{var l=bt?"buffer":"array";if(r&&r.content)a=iH(r.content,e);else if((i=kt.find(t,"PerfectOffice_MAIN"))&&i.content)a=Hc.to_workbook(i.content,(e.type=l,e));else if((i=kt.find(t,"NativeContent_MAIN"))&&i.content)a=Hc.to_workbook(i.content,(e.type=l,e));else throw(i=kt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&kt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=qB(t))}var c={};return t.FullPaths&&oH(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}var Cd={0:{f:$V},1:{f:qV},2:{f:t$},3:{f:KV},4:{f:WV},5:{f:e$},6:{f:a$},7:{f:ZV},8:{f:c$},9:{f:l$},10:{f:i$},11:{f:o$},12:{f:YV},13:{f:n$},14:{f:XV},15:{f:JV},16:{f:wS},17:{f:s$},18:{f:QV},19:{f:zp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:O$},40:{},42:{},43:{f:iB},44:{f:sB},45:{f:oB},46:{f:cB},47:{f:lB},48:{},49:{f:uU},50:{},51:{f:RB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tS},62:{f:r$},63:{f:LB},64:{f:v$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ir,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:x$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:zV},148:{f:HV,p:16},151:{f:d$},152:{},153:{f:F$},154:{},155:{},156:{f:I$},157:{},158:{},159:{T:1,f:b9},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:u$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:NB},336:{T:-1},337:{f:DB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:h$},427:{f:m$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:g$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:f$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HB},633:{T:1},634:{T:-1},635:{T:1,f:$B},636:{T:-1},637:{f:dU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:S$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:y$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ap={6:{f:pm},10:{f:$s},12:{f:Cn},13:{f:Cn},14:{f:wn},15:{f:wn},16:{f:nr},17:{f:wn},18:{f:wn},19:{f:Cn},20:{f:Ww},21:{f:Ww},23:{f:eS},24:{f:Kw},25:{f:wn},26:{},27:{},28:{f:j7},29:{},34:{f:wn},35:{f:Jw},38:{f:nr},39:{f:nr},40:{f:nr},41:{f:nr},42:{f:wn},43:{f:wn},47:{f:G9},49:{f:w7},51:{f:Cn},60:{},61:{f:v7},64:{f:wn},65:{f:_7},66:{f:Cn},77:{},80:{},81:{},82:{},85:{f:Cn},89:{},90:{},91:{},92:{f:u7},93:{f:$7},94:{},95:{f:wn},96:{},97:{},99:{f:wn},125:{f:tS},128:{f:D7},129:{f:f7},130:{f:Cn},131:{f:wn},132:{f:wn},133:{f:d7},134:{},140:{f:W7},141:{f:Cn},144:{},146:{f:K7},151:{},152:{},153:{},154:{},155:{},156:{f:Cn},157:{},158:{},160:{f:t9},161:{f:Z7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:A7},190:{f:k7},193:{f:$s},197:{},198:{},199:{},200:{},201:{},202:{f:wn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cn},220:{},221:{f:wn},222:{},224:{f:R7},225:{f:c7},226:{f:$s},227:{},229:{f:V7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:h7},253:{f:T7},255:{f:m7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:WE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wn},353:{f:$s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:I7},431:{f:wn},432:{},433:{},434:{},437:{},438:{f:z7},439:{f:wn},440:{f:q7},441:{},442:{f:_u},443:{},444:{f:Cn},445:{},446:{},448:{f:$s},449:{f:x7,r:2},450:{f:$s},512:{f:qw},513:{f:e9},515:{f:M7},516:{f:E7},517:{f:Yw},519:{f:n9},520:{f:p7},523:{},545:{f:Xw},549:{f:zw},566:{},574:{f:y7},638:{f:C7},659:{},1048:{},1054:{f:S7},1084:{},1212:{f:P7},2048:{f:Y7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:X7,r:12},2173:{f:AB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:O7,r:12},2197:{},2198:{f:wB,r:12},2199:{},2200:{},2201:{},2202:{f:U7,r:12},2203:{f:$s},2204:{},2205:{},2206:{},2207:{},2211:{f:g7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Q7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qw},1:{},2:{f:i9},3:{f:s9},4:{f:a9},5:{f:Yw},7:{f:o9},8:{},9:{f:Yf},11:{},22:{f:Cn},30:{f:b7},31:{},32:{},33:{f:Xw},36:{},37:{f:zw},50:{f:l9},62:{},52:{},67:{},68:{f:Cn},69:{},86:{},126:{},127:{f:r9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:c9},223:{},234:{},354:{},421:{},518:{f:pm},521:{f:Yf},536:{f:Kw},547:{f:Jw},561:{},579:{},1030:{f:pm},1033:{f:Yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oa(t,e,n,r){var a=e;if(!isNaN(a)){var i=(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&LE(n)&&t.push(n)}}function lT(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,c=i&&i.index||t.length,d=MP(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,g=0,v=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),b=S.slice(0,3).toLowerCase();if(b=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}g=0;continue}if(!(b!="<td"&&b!="<th")){var k=S.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var A=k[c].trim();if(A.match(/<t[dh]/i)){for(var C=A,M=0;C.charAt(0)=="<"&&(M=C.indexOf(">"))>-1;)C=C.slice(M+1);for(var B=0;B<E.length;++B){var H=E[B];H.s.c==g&&H.s.r<f&&f<=H.e.r&&(g=H.e.c+1,B=-1)}var F=et(A.slice(0,A.indexOf(">")));_=F.colspan?+F.colspan:1,((v=+F.rowspan)>1||_>1)&&E.push({s:{r:f,c:g},e:{r:f+(v||1)-1,c:g+_-1}});var K=F.t||F["data-t"]||"";if(!C.length){g+=_;continue}if(C=TE(C),T.s.r>f&&(T.s.r=f),T.e.r<f&&(T.e.r=f),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!C.length){g+=_;continue}var P={t:"s",v:C};n.raw||!C.trim().length||K=="s"||(C==="TRUE"?P={t:"b",v:!0}:C==="FALSE"?P={t:"b",v:!1}:isNaN(ha(C))?isNaN(dl(C).getDate())||(P={t:"d",v:$n(C)},n.cellDates||(P={t:"n",v:gr(P.v)}),P.z=n.dateNF||ut[14]):P={t:"n",v:ha(C)}),n.dense?(r[f]||(r[f]=[]),r[f][g]=P):r[ot({r:f,c:g})]=P,g+=_}}}}return r["!ref"]=Nt(T),E.length&&(r["!merges"]=E),r}function lH(t,e,n,r){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var g=ot({r:n,c:l}),v=r.dense?(t[n]||[])[l]:t[g],_=v&&v.v!=null&&(v.h||jp(v.w||(fs(v),v.w)||""))||"",T={};c>1&&(T.rowspan=c),d>1&&(T.colspan=d),r.editable?_='<span contenteditable="true">'+_+"</span>":v&&(T["data-t"]=v&&v.t||"z",v.v!=null&&(T["data-v"]=v.v),v.z!=null&&(T["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),T.id=(r.id||"sjs")+"-"+g,i.push(WP("td",_,T))}}var E="<tr>";return E+i.join("")+"</tr>"}var cH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uH="</body></html>";function fH(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return ai(lT(n[0],e),e);var r=ag();return n.forEach(function(a,i){sg(r,lT(a,e),"Sheet"+(i+1))}),r}function dH(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function hH(t,e){var n=e||{},r=n.header!=null?n.header:cH,a=n.footer!=null?n.footer:uH,i=[r],l=El(t["!ref"]);n.dense=Array.isArray(t),i.push(dH(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)i.push(lH(t,l,c,n));return i.push("</table>"+a),i.join("")}function AS(t,e,n){var r=n||{},a=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?hr(r.origin):r.origin;a=l.r,i=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var g=El(t["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),a==-1&&(f.e.r=a=g.e.r+1)}var v=[],_=0,T=t["!rows"]||(t["!rows"]=[]),E=0,S=0,b=0,k=0,A=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<d;++E){var M=c[E];if(cT(M)){if(r.display)continue;T[S]={hidden:!0}}var B=M.children;for(b=k=0;b<B.length;++b){var H=B[b];if(!(r.display&&cT(H))){var F=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):TE(H.innerHTML),K=H.getAttribute("data-z")||H.getAttribute("z");for(_=0;_<v.length;++_){var P=v[_];P.s.c==k+i&&P.s.r<S+a&&S+a<=P.e.r&&(k=P.e.c+1-i,_=-1)}C=+H.getAttribute("colspan")||1,((A=+H.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:S+a,c:k+i},e:{r:S+a+(A||1)-1,c:k+i+(C||1)-1}});var ae={t:"s",v:F},G=H.getAttribute("data-t")||H.getAttribute("t")||"";F!=null&&(F.length==0?ae.t=G||"z":r.raw||F.trim().length==0||G=="s"||(F==="TRUE"?ae={t:"b",v:!0}:F==="FALSE"?ae={t:"b",v:!1}:isNaN(ha(F))?isNaN(dl(F).getDate())||(ae={t:"d",v:$n(F)},r.cellDates||(ae={t:"n",v:gr(ae.v)}),ae.z=r.dateNF||ut[14]):ae={t:"n",v:ha(F)})),ae.z===void 0&&K!=null&&(ae.z=K);var te="",we=H.getElementsByTagName("A");if(we&&we.length)for(var Re=0;Re<we.length&&!(we[Re].hasAttribute("href")&&(te=we[Re].getAttribute("href"),te.charAt(0)!="#"));++Re);te&&te.charAt(0)!="#"&&(ae.l={Target:te}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][k+i]=ae):t[ot({c:k+i,r:S+a})]=ae,f.e.c<k+i&&(f.e.c=k+i),k+=C}}++S}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,S-1+a),t["!ref"]=Nt(f),S>=d&&(t["!fullref"]=Nt((f.e.r=c.length-E+S-1+a,f))),t}function kS(t,e){var n=e||{},r=n.dense?[]:{};return AS(r,t,e)}function mH(t,e){return ai(kS(t,e),e)}function cT(t){var e="",n=pH(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function pH(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function gH(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Rt(e.replace(/<[^>]*>/g,""));return[n]}var uT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function NS(t,e){var n=e||{},r=Vp(t),a=[],i,l,c={name:""},d="",f=0,g,v,_={},T=[],E=n.dense?[]:{},S,b,k={value:""},A="",C=0,M=[],B=-1,H=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,P={},ae=[],G={},te=0,we=0,Re=[],ye=1,se=1,me=[],re={Names:[]},J={},D=["",""],ee=[],I={},W="",X=0,q=!1,oe=!1,_e=0;for(ru.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=ru.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?E["!ref"]=Nt(F):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(E["!fullref"]=E["!ref"],F.e.r=n.sheetRows-1,E["!ref"]=Nt(F)),ae.length&&(E["!merges"]=ae),Re.length&&(E["!rows"]=Re),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=E,oe=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=et(S[0],!1),B=H=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,E=n.dense?[]:{},ae=[],Re=[],oe=!0);break;case"table-row-group":S[1]==="/"?--K:++K;break;case"table-row":case"":if(S[1]==="/"){B+=ye,ye=1;break}if(v=et(S[0],!1),v.?B=v.-1:B==-1&&(B=0),ye=+v["number-rows-repeated"]||1,ye<10)for(_e=0;_e<ye;++_e)K>0&&(Re[B+_e]={level:K});H=-1;break;case"covered-table-cell":S[1]!=="/"&&++H,n.sheetStubs&&(n.dense?(E[B]||(E[B]=[]),E[B][H]={t:"z"}):E[ot({r:B,c:H})]={t:"z"}),A="",M=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++H,k=et(S[0],!1),se=parseInt(k["number-columns-repeated"]||"1",10),b={t:"z",v:null},k.formula&&n.cellFormula!=!1&&(b.f=aT(Rt(k.formula))),(k.||k["value-type"])=="string"&&(b.t="s",b.v=Rt(k["string-value"]||""),n.dense?(E[B]||(E[B]=[]),E[B][H]=b):E[ot({r:B,c:H})]=b),H+=se-1;else if(S[1]!=="/"){++H,A="",C=0,M=[],se=1;var Se=ye?B+ye-1:B;if(H>F.e.c&&(F.e.c=H),H<F.s.c&&(F.s.c=H),B<F.s.r&&(F.s.r=B),Se>F.e.r&&(F.e.r=Se),k=et(S[0],!1),ee=[],I={},b={t:k.||k["value-type"],v:null},n.cellFormula)if(k.formula&&(k.formula=Rt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(te=parseInt(k["number-matrix-rows-spanned"],10)||0,we=parseInt(k["number-matrix-columns-spanned"],10)||0,G={s:{r:B,c:H},e:{r:B+te-1,c:H+we-1}},b.F=Nt(G),me.push([G,b.F])),k.formula)b.f=aT(k.formula);else for(_e=0;_e<me.length;++_e)B>=me[_e][0].s.r&&B<=me[_e][0].e.r&&H>=me[_e][0].s.c&&H<=me[_e][0].e.c&&(b.F=me[_e][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(te=parseInt(k["number-rows-spanned"],10)||0,we=parseInt(k["number-columns-spanned"],10)||0,G={s:{r:B,c:H},e:{r:B+te-1,c:H+we-1}},ae.push(G)),k["number-columns-repeated"]&&(se=parseInt(k["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=nn(k["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(k.value);break;case"percentage":b.t="n",b.v=parseFloat(k.value);break;case"currency":b.t="n",b.v=parseFloat(k.value);break;case"date":b.t="d",b.v=$n(k["date-value"]),n.cellDates||(b.t="n",b.v=gr(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=NP(k["time-value"])/86400,n.cellDates&&(b.t="d",b.v=Bd(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(k.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",k["string-value"]!=null&&(A=Rt(k["string-value"]),M=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(q=!1,b.t==="s"&&(b.v=A||"",M.length&&(b.R=M),q=C==0),J.Target&&(b.l=J),ee.length>0&&(b.c=ee,ee=[]),A&&n.cellText!==!1&&(b.w=A),q&&(b.t="z",delete b.v),(!q||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var Ee=0;Ee<ye;++Ee){if(se=parseInt(k["number-columns-repeated"]||"1",10),n.dense)for(E[B+Ee]||(E[B+Ee]=[]),E[B+Ee][H]=Ee==0?b:Wn(b);--se>0;)E[B+Ee][H+se]=Wn(b);else for(E[ot({r:B+Ee,c:H})]=b;--se>0;)E[ot({r:B+Ee,c:H+se})]=Wn(b);F.e.c<=H&&(F.e.c=H)}se=parseInt(k["number-columns-repeated"]||"1",10),H+=se-1,se=0,b={},A="",M=[]}J={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i;I.t=A,M.length&&(I.R=M),I.a=W,ee.push(I)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);W="",X=0,A="",C=0,M=[];break;case"creator":S[1]==="/"?W=r.slice(X,S.index):X=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);A="",C=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(P[c.name]=d,(i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&(d="",c=et(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=uT[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=uT[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=et(S[0],!1),D=gm(l["cell-range-address"]);var Ce={Name:l.name,Ref:D[0]+"!"+D[1]};oe&&(Ce.Sheet=T.length),re.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!k||!k["string-value"])){var Ke=gH(r.slice(C,S.index));A=(A.length>0?A+`
`:"")+Ke[0]}else et(S[0],!1),C=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{D=gm(et(S[0])["target-range-address"]),_[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(J=et(S[0],!1),!J.href)break;J.Target=Rt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(D=gm(J.Target.slice(1)),J.Target="#"+D[0]+"!"+D[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var Z={Sheets:_,SheetNames:T,Workbook:re};return n.bookSheets&&delete Z.Sheets,Z}function fT(t,e){e=e||{},Kr(t,"META-INF/manifest.xml")&&MU(bn(t,"META-INF/manifest.xml"),e);var n=Lr(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=NS(Kt(n),e);return Kr(t,"meta.xml")&&(r.Props=$E(bn(t,"meta.xml"))),r}function dT(t,e){return NS(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function eg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function sp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Kt(Ki(t))}function ip(t){var e=t.reduce(function(a,i){return a+i.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function hT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function xH(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function ou(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Fn(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function ar(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=ou(t,n),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var d=n[0];t[n[0]++]>=128;);c=t.slice(d,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=ou(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:i};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function tg(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function vH(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=ou(t,r),i=ar(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:Fn(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=ar(c.data),f=Fn(d[3][0].data);l.messages.push({meta:d,data:t.slice(r[0],r[0]+f)}),r[0]+=f}),(e=i[3])!=null&&e[0]&&(l.merge=Fn(i[3][0].data)>>>0>0),n.push(l)}return n}function yH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=ou(e,n),a=[];n[0]<e.length;){var i=e[n[0]]&3;if(i==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(i==1?(f=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(f=(e[n[0]++]>>2)+1,i==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[ip(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var g=ip(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function _H(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(yH(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return ip(e)}function wH(t,e,n,r){var a=eg(t),i=a.getUint32(4,!0),l=(r>1?12:8)+hT(i&(r>1?3470:398))*4,c=-1,d=-1,f=NaN,g=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=hT(i&(r>1?12288:4096))*4,i&16&&(d=a.getUint32(l,!0),l+=4),i&32&&(f=a.getFloat64(l,!0),l+=8),i&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[d]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:n[c]};else if(d>-1)v={t:"s",v:e[d]};else if(!isNaN(f))v={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function TH(t,e,n){var r=eg(t),a=r.getUint32(8,!0),i=12,l=-1,c=-1,d=NaN,f=NaN,g=new Date(2001,0,1);a&1&&(d=xH(t,i),i+=16),a&2&&(f=r.getFloat64(i,!0),i+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=r.getUint32(i,!0),i+=4),a&16&&(l=r.getUint32(i,!0),i+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function EH(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return wH(t,e,n,t[0]);case 5:return TH(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qs(t){var e=ar(t);return ou(e[1][0].data)}function mT(t,e){var n=ar(e.data),r=Fn(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(l){var c=ar(l.data),d=Fn(c[1][0].data)>>>0;switch(r){case 1:i[d]=sp(c[3][0].data);break;case 8:{var f=t[Qs(c[9][0].data)][0],g=ar(f.data),v=t[Qs(g[1][0].data)][0],_=Fn(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=ar(v.data);i[d]=T[3].map(function(E){return sp(E.data)}).join("")}break}}),i}function SH(t,e){var n,r,a,i,l,c,d,f,g,v,_,T,E,S,b=ar(t),k=Fn(b[1][0].data)>>>0,A=Fn(b[2][0].data)>>>0,C=((r=(n=b[8])==null?void 0:n[0])==null?void 0:r.data)&&Fn(b[8][0].data)>0||!1,M,B;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&e!=0)M=(c=(l=b[7])==null?void 0:l[0])==null?void 0:c.data,B=(f=(d=b[6])==null?void 0:d[0])==null?void 0:f.data;else if((v=(g=b[4])==null?void 0:g[0])!=null&&v.data&&e!=1)M=(T=(_=b[4])==null?void 0:_[0])==null?void 0:T.data,B=(S=(E=b[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=C?4:1,F=eg(M),K=[],P=0;P<M.length/2;++P){var ae=F.getUint16(P*2,!0);ae<65535&&K.push([P,ae])}if(K.length!=A)throw"Expected ".concat(A," cells, found ").concat(K.length);var G=[];for(P=0;P<K.length-1;++P)G[K[P][0]]=B.subarray(K[P][1]*H,K[P+1][1]*H);return K.length>=1&&(G[K[K.length-1][0]]=B.subarray(K[K.length-1][1]*H)),{R:k,cells:G}}function bH(t,e){var n,r=ar(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Fn(r[7][0].data)>>>0>0?1:0:-1,i=tg(r[5],function(l){return SH(l,a)});return{nrows:Fn(r[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function CH(t,e,n){var r,a=ar(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Fn(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Fn(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=Nt(i);var l=ar(a[4][0].data),c=mT(t,t[Qs(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?mT(t,t[Qs(l[17][0].data)][0]):[],f=ar(l[3][0].data),g=0;f[1].forEach(function(v){var _=ar(v.data),T=t[Qs(_[2][0].data)][0],E=Fn(T.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=bH(t,T);S.data.forEach(function(b,k){b.forEach(function(A,C){var M=ot({r:g+k,c:C}),B=EH(A,c,d);B&&(n[M]=B)})}),g+=S.nrows})}function AH(t,e){var n=ar(e.data),r={"!ref":"A1"},a=t[Qs(n[2][0].data)],i=Fn(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return CH(t,a[0],r),r}function kH(t,e){var n,r=ar(e.data),a={name:(n=r[1])!=null&&n[0]?sp(r[1][0].data):"",sheets:[]},i=tg(r[2],Qs);return i.forEach(function(l){t[l].forEach(function(c){var d=Fn(c.meta[1][0].data);d==6e3&&a.sheets.push(AH(t,c))})}),a}function NH(t,e){var n=ag(),r=ar(e.data),a=tg(r[1],Qs);if(a.forEach(function(i){t[i].forEach(function(l){var c=Fn(l.meta[1][0].data);if(c==2){var d=kH(t,l);d.sheets.forEach(function(f,g){sg(n,f,g==0?d.name:d.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function vm(t){var e,n,r,a,i={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=_H(d.content)}catch(v){return console.log("?? "+d.content.length+" "+(v.message||v))}var g;try{g=vH(f)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){i[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Fn(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(d){i[d].forEach(function(f){var g=Fn(f.meta[1][0].data)>>>0;if(g==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return NH(i,c)}function RH(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function ng(t){RH([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function DH(t){return Qo.WS.indexOf(t)>-1?"sheet":t==Qo.CS?"chart":t==Qo.DS?"dialog":t==Qo.MS?"macro":t&&t.length?t:"sheet"}function MH(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,DH(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function IH(t,e,n,r,a,i,l,c,d,f,g,v){try{i[r]=Vc(Lr(t,n,!0),e);var _=bn(t,e),T;switch(c){case"sheet":T=B$(_,e,a,d,i[r],f,g,v);break;case"chart":if(T=j$(_,e,a,d,i[r],f,g,v),!T||!T["!drawel"])break;var E=Dc(T["!drawel"].Target,e),S=ep(E),b=UB(Lr(t,E,!0),Vc(Lr(t,S,!0),E)),k=Dc(b,E),A=ep(k);T=T$(Lr(t,k,!0),k,d,Vc(Lr(t,A,!0),k),f,T);break;case"macro":T=V$(_,e,a,d,i[r],f,g,v);break;case"dialog":T=$$(_,e,a,d,i[r],f,g,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=T;var C=[];i&&i[r]&&Ma(i[r]).forEach(function(M){var B="";if(i[r][M].Type==Qo.CMNT){B=Dc(i[r][M].Target,e);var H=q$(bn(t,B,!0),B,d);if(!H||!H.length)return;Qw(T,H,!1)}i[r][M].Type==Qo.TCMNT&&(B=Dc(i[r][M].Target,e),C=C.concat(jB(bn(t,B,!0),d)))}),C&&C.length&&Qw(T,C,!0,d.people||[])}catch(M){if(d.WTF)throw M}}function Wr(t){return t.charAt(0)=="/"?t.slice(1):t}function FH(t,e){if(hE(),e=e||{},ng(e),Kr(t,"META-INF/manifest.xml")||Kr(t,"objectdata.xml"))return fT(t,e);if(Kr(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vm<"u"){if(t.FileIndex)return vm(t);var n=kt.utils.cfb_new();return Cw(t).forEach(function(Re){LP(n,Re,FP(t,Re))}),vm(n)}throw new Error("Unsupported NUMBERS file")}if(!Kr(t,"[Content_Types].xml"))throw Kr(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Kr(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Cw(t),a=RU(Lr(t,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",bn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!bn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(Gc=[],a.sst)try{Gc=z$(bn(t,Wr(a.sst)),a.sst,e)}catch(Re){if(e.WTF)throw Re}e.cellStyles&&a.themes.length&&(d=G$(Lr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=H$(bn(t,Wr(a.style)),a.style,d,e))}a.links.map(function(Re){try{var ye=Vc(Lr(t,ep(Wr(Re))),Re);return W$(bn(t,Wr(Re)),ye,Re,e)}catch{}});var g=U$(bn(t,Wr(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=bn(t,Wr(a.coreprops[0]),!0),_&&(v=$E(_)),a.extprops.length!==0&&(_=bn(t,Wr(a.extprops[0]),!0),_&&LU(_,v,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Lr(t,Wr(a.custprops[0]),!0),_&&(T=PU(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(ye){return ye.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(E.Props=v,E.Custprops=T),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=Y$(bn(t,Wr(a.calcchain)),a.calcchain));var b=0,k={},A,C;{var M=g.Sheets;v.Worksheets=M.length,v.SheetNames=[];for(var B=0;B!=M.length;++B)v.SheetNames[B]=M[B].name}var H=i?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),K=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Kr(t,K)||(K="xl/_rels/workbook."+H+".rels");var P=Vc(Lr(t,K,!0),K.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=J$(bn(t,Wr(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=VB(bn(t,Wr(a.people[0])),e)),P&&(P=MH(P,g.Sheets));var ae=bn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=v.Worksheets;++b){var G="sheet";if(P&&P[b]?(A="xl/"+P[b][1].replace(/[\/]?xl\//,""),Kr(t,A)||(A=P[b][1]),Kr(t,A)||(A=K.replace(/_rels\/.*$/,"")+P[b][1]),G=P[b][2]):(A="xl/worksheets/sheet"+(b+1-ae)+"."+H,A=A.replace(/sheet0\./,"sheet.")),C=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(v.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var te=!1,we=0;we!=e.sheets.length;++we)typeof e.sheets[we]=="number"&&e.sheets[we]==b&&(te=1),typeof e.sheets[we]=="string"&&e.sheets[we].toLowerCase()==v.SheetNames[b].toLowerCase()&&(te=1);if(!te)continue e}}IH(t,A,C,v.SheetNames[b],b,k,l,G,e,g,d,f)}return E={Directory:a,Workbook:g,Props:v,Custprops:T,Deps:S,Sheets:l,SheetNames:v.SheetNames,Strings:Gc,Styles:f,Themes:d,SSF:Wn(ut)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Re,ye){Re=Re.replace(/^Root Entry[\/]/,""),E.keys.push(Re),E.files[Re]=t.FileIndex[ye]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=bn(t,Wr(a.vba[0]),!0):a.defaults&&a.defaults.bin===zB&&(E.vbaraw=bn(t,"xl/vbaProject.bin",!0))),E}function LH(t,e){var n=e||{},r="Workbook",a=kt.find(t,r);try{if(r="/!DataSpaces/Version",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(A9(a.content),r="/!DataSpaces/DataSpaceMap",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=N9(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=R9(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);M9(a.content)}catch{}if(r="/EncryptionInfo",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=I9(a.content);if(r="/EncryptedPackage",a=kt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function rg(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Or(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function OH(t,e){return kt.find(t,"EncryptedPackage")?LH(t,e):CS(t,e)}function PH(t,e){var n,r=t,a=e||{};return a.type||(a.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),n=yE(r,a),FH(n,a)}function RS(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return rp(t.slice(n),e);default:break e}return au.to_workbook(t,e)}function UH(t,e){var n="",r=rg(t,e);switch(e.type){case"base64":n=Or(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=$i(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Kt(n)),e.type="binary",RS(n,e)}function BH(t,e){var n=t;return e.type=="base64"&&(n=Or(n)),n=eu.utils.decode(1200,n.slice(2),"str"),e.type="binary",RS(n,e)}function jH(t){return t.match(/[^\x00-\x7F]/)?Mc(t):t}function ym(t,e,n,r){return r?(n.type="string",au.to_workbook(t,n)):au.to_workbook(e,n)}function op(t,e){tE();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return op(new Uint8Array(t),(n=Wn(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),al={},n.dateNF&&(al.dateNF=n.dateNF),n.type||(n.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=bt?"buffer":"binary",r=AP(t),typeof Uint8Array<"u"&&!bt&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,r=jH(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Wn(n),n.type="array",op(Lp(r),n)}switch((a=rg(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return OH(kt.read(r,n),n);break;case 9:if(a[1]<=8)return CS(r,n);break;case 60:return rp(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return m9(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return d9.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?PH(r,n):ym(t,r,n,i);case 239:return a[3]===60?rp(r,n):ym(t,r,n,i);case 255:if(a[1]===254)return BH(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Hc.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Hc.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return Zw.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return z9.to_workbook(r,n);break;case 10:case 13:case 32:return UH(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return u9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Zw.to_workbook(r,n):ym(t,r,n,i)}function VH(t,e,n,r,a,i,l,c){var d=Jn(n),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!l||t[n])for(var T=e.s.c;T<=e.e.c;++T){var E=l?t[n][T]:t[r[T]+d];if(E===void 0||E.t===void 0){if(f===void 0)continue;i[T]!=null&&(_[i[T]]=f);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[T]!=null){if(S==null)if(E.t=="e"&&S===null)_[i[T]]=null;else if(f!==void 0)_[i[T]]=f;else if(g&&S===null)_[i[T]]=null;else continue;else _[i[T]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:fs(E,S,c);S!=null&&(v=!1)}}return{row:_,isempty:v}}function lp(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,i=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof g){case"string":d=xn(g);break;case"number":d=xn(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var v=Jn(d.s.r),_=[],T=[],E=0,S=0,b=Array.isArray(t),k=d.s.r,A=0,C={};b&&!t[k]&&(t[k]=[]);var M=f.skipHidden&&t["!cols"]||[],B=f.skipHidden&&t["!rows"]||[];for(A=d.s.c;A<=d.e.c;++A)if(!(M[A]||{}).hidden)switch(_[A]=In(A),n=b?t[k][A]:t[_[A]+v],r){case 1:i[A]=A-d.s.c;break;case 2:i[A]=_[A];break;case 3:i[A]=f.header[A-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=fs(n,null,f),S=C[l]||0,!S)C[l]=1;else{do c=l+"_"+S++;while(C[c]);C[l]=S,C[c]=1}i[A]=c}for(k=d.s.r+a;k<=d.e.r;++k)if(!(B[k]||{}).hidden){var H=VH(t,d,k,_,r,i,b,f);(H.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(T[E++]=H.row)}return T.length=E,T}var pT=/"/g;function $H(t,e,n,r,a,i,l,c){for(var d=!0,f=[],g="",v=Jn(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var T=c.dense?(t[n]||[])[_]:t[r[_]+v];if(T==null)g="";else if(T.v!=null){d=!1,g=""+(c.rawNumbers&&T.t=="n"?T.v:fs(T,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===i||S===34||c.forceQuotes){g='"'+g.replace(pT,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(d=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(pT,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&d?null:f.join(l)}function DS(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=xn(t["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),g="",v=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],T=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(v[E]=In(E));for(var S=0,b=a.s.r;b<=a.e.r;++b)(T[b]||{}).hidden||(g=$H(t,a,b,v,l,d,i,r),g!=null&&(r.strip&&(g=g.replace(f,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function HH(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=DS(t,e);return n}function GH(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=xn(t["!ref"]),i="",l=[],c,d=[],f=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=In(c);for(var g=a.s.r;g<=a.e.r;++g)for(i=Jn(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+i,n=f?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function MS(t,e,n){var r=n||{},a=+!r.skipHeader,i=t||{},l=0,c=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?hr(r.origin):r.origin;l=d.r,c=d.c}var f,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(i["!ref"]){var v=xn(i["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),l==-1&&(l=v.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=r.header||[],T=0;e.forEach(function(S,b){Ma(S).forEach(function(k){(T=_.indexOf(k))==-1&&(_[T=_.length]=k);var A=S[k],C="z",M="",B=ot({c:c+T,r:l+b+a});f=lu(i,B),A&&typeof A=="object"&&!(A instanceof Date)?i[B]=A:(typeof A=="number"?C="n":typeof A=="boolean"?C="b":typeof A=="string"?C="s":A instanceof Date?(C="d",r.cellDates||(C="n",A=gr(A)),M=r.dateNF||ut[14]):A===null&&r.nullError&&(C="e",A=0),f?(f.t=C,f.v=A,delete f.w,delete f.R,M&&(f.z=M)):i[B]=f={t:C,v:A},M&&(f.z=M))})}),g.e.c=Math.max(g.e.c,c+_.length-1);var E=Jn(l);if(a)for(T=0;T<_.length;++T)i[In(T+c)+E]={t:"s",v:_[T]};return i["!ref"]=Nt(g),i}function zH(t,e){return MS(null,t,e)}function lu(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=hr(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?lu(t,ot(e)):lu(t,ot({r:e,c:n||0}))}function qH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ag(){return{SheetNames:[],Sheets:{}}}function sg(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(R$(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function YH(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=qH(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function WH(t,e){return t.z=e,t}function IS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function JH(t,e,n){return IS(t,"#"+e,n)}function KH(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function XH(t,e,n,r){for(var a=typeof e!="string"?e:xn(e),i=typeof e=="string"?e:Nt(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var d=lu(t,l,c);d.t="n",d.F=i,delete d.v,l==a.s.r&&c==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var ZH={encode_col:In,encode_row:Jn,encode_cell:ot,encode_range:Nt,decode_col:Gp,decode_row:Hp,split_cell:cU,decode_cell:hr,decode_range:El,format_cell:fs,sheet_add_aoa:PE,sheet_add_json:MS,sheet_add_dom:AS,aoa_to_sheet:Sl,json_to_sheet:zH,table_to_sheet:kS,table_to_book:mH,sheet_to_csv:DS,sheet_to_txt:HH,sheet_to_json:lp,sheet_to_html:hH,sheet_to_formulae:GH,sheet_to_row_object_array:lp,sheet_get_cell:lu,book_new:ag,book_append_sheet:sg,book_set_sheet_visibility:YH,cell_set_number_format:WH,cell_set_hyperlink:IS,cell_set_internal_link:JH,cell_add_comment:KH,sheet_set_array_formula:XH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const FS=({matrixData:t,onUpdate:e})=>{const n=(d,f)=>e({...t,headers:t.headers.map((g,v)=>v===d?f:g)}),r=(d,f,g)=>e({...t,rows:t.rows.map((v,_)=>_===d?v.map((T,E)=>E===f?g:T):v)}),a=()=>e({...t,rows:[...t.rows,Array(t.headers.length).fill("")]}),i=d=>e({...t,rows:t.rows.filter((f,g)=>g!==d)}),l=()=>{const d=` ${t.headers.length+1}`;e({headers:[...t.headers,d],rows:t.rows.map(f=>[...f,""])})},c=d=>{t.headers.length<=1||e({headers:t.headers.filter((f,g)=>g!==d),rows:t.rows.map(f=>f.filter((g,v)=>v!==d))})};return x.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[x.jsxs("table",{className:"w-full text-xs border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-slate-200",children:[t.headers.map((d,f)=>x.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:x.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[x.jsx("input",{type:"text",value:d,onChange:g=>n(f,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),x.jsx("button",{onClick:()=>c(f),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:x.jsx(ma,{className:"w-3 h-3"})})]})},f)),x.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),x.jsx("tbody",{children:t.rows.map((d,f)=>x.jsxs("tr",{children:[d.map((g,v)=>x.jsx("td",{className:"border border-slate-300 p-0",children:x.jsx("input",{type:"text",value:g,onChange:_=>r(f,v,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},v)),x.jsx("td",{className:"border border-slate-300 p-1 text-center",children:x.jsx("button",{onClick:()=>i(f),className:"text-red-500 hover:text-red-700",title:"",children:x.jsx(ma,{className:"w-3 h-3"})})})]},f))})]}),x.jsxs("div",{className:"flex gap-2 mt-2",children:[x.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Ui,{className:"w-3 h-3"}),""]}),x.jsxs("button",{onClick:l,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Ui,{className:"w-3 h-3"}),""]})]})]})},gT=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},QH=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=gT(r);r+=d;const[v,_]=gT(r),T=d>.5?1:0;return{path:`M ${f} ${g} A 1 1 0 ${T} 1 ${v} ${_} L 0 0`,color:a[c%a.length],label:l.label,value:l.value}});return x.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"font-bold text-sm mb-2",children:e}),x.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:l.color}}),x.jsx("span",{children:l.label})]}),x.jsxs("span",{children:[l.value," (",(l.value/n*100).toFixed(1),"%)"]})]},c))})]})},eG=({data:t,title:e})=>{if(t.length<2)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...t.map(r=>r.value),0);return x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>x.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:t.map((r,a)=>`${a/(t.length-1)*100},${50-r.value/n*45}`).join(" ")}),t.map((r,a)=>x.jsx("circle",{cx:`${a/(t.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},tG=({data:t,title:e})=>{const n=Math.max(...t.map(r=>r.value),0);return n===0?x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsx("div",{className:"space-y-1",children:t.map(r=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),x.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:x.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:x.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},nG=({actionItem:t,onSave:e,onClose:n,generateUniqueId:r})=>{var k;const[a,i]=U.useState(t.report||{notes:"",attachments:[],matrixData:null}),[l,c]=U.useState("bar"),d=U.useRef(null),f=U.useRef(null),g=A=>{i(C=>({...C,...A}))},v=()=>{e({...t,report:a})},_=A=>{var F;const C=(F=A.target.files)==null?void 0:F[0];if(!C)return;const M=5,B=M*1024*1024;if(C.size>B){alert(`${M}MB`),A.target&&(A.target.value="");return}const H=new FileReader;H.onload=K=>{var P;if(typeof((P=K.target)==null?void 0:P.result)=="string"){const ae={id:r("attach"),name:C.name,type:C.type,dataUrl:K.target.result};g({attachments:[...a.attachments||[],ae]})}else alert("")},H.onerror=()=>{alert("")},H.readAsDataURL(C),A.target&&(A.target.value="")},T=A=>{var C;g({attachments:(C=a.attachments)==null?void 0:C.filter(M=>M.id!==A)})},E=A=>{var B;const C=(B=A.target.files)==null?void 0:B[0];if(!C)return;const M=new FileReader;M.onload=H=>{var F;try{const K=(F=H.target)==null?void 0:F.result,P=op(K,{type:"array"}),ae=P.SheetNames[0],G=P.Sheets[ae],te=ZH.sheet_to_json(G,{header:1});if(!Array.isArray(te)||te.length===0){alert("Excel"),A.target&&(A.target.value="");return}const we=te[0];if(!Array.isArray(we)){alert("Excel"),A.target&&(A.target.value="");return}const Re=we.map(String),ye=te.slice(1),se=[];for(const me of ye)if(Array.isArray(me)){const re=Array(Re.length).fill("");for(let J=0;J<Re.length;J++)re[J]=me[J]!==null&&me[J]!==void 0?String(me[J]):"";se.push(re)}g({matrixData:{headers:Re,rows:se}})}catch(K){console.error("Error parsing Excel file:",K),alert(`Excel: ${K instanceof Error?K.message:"Unknown error"}`)}finally{A.target&&(A.target.value="")}},M.readAsArrayBuffer(C)},S=(((k=a.matrixData)==null?void 0:k.rows)||[]).map(A=>({label:A[0],value:parseFloat(A[1])||0})).filter(A=>A.label&&!isNaN(A.value)),b=()=>{if(!a.matrixData||S.length===0)return null;switch(l){case"line":return x.jsx(eG,{data:S,title:""});case"pie":return x.jsx(QH,{data:S,title:""});case"bar":default:return x.jsx(tG,{data:S,title:""})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500",children:t.text})]}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),x.jsx("textarea",{value:a.notes,onChange:A=>g({notes:A.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",x.jsx("button",{onClick:()=>{var A;return(A=d.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:x.jsx(Xs,{className:"w-5 h-5"})}),x.jsx("input",{type:"file",ref:d,onChange:_,className:"hidden",multiple:!1})]}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(A=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[x.jsx("a",{href:A.dataUrl,download:A.name,className:"block w-full h-full","aria-label":`Download ${A.name}`,children:A.type.startsWith("image/")?x.jsx("img",{src:A.dataUrl,alt:A.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:x.jsx(Xs,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:A.name,children:A.name})}),x.jsx("button",{onClick:()=>T(A.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(ma,{className:"w-3 h-3"})})]},A.id))})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{var A;return(A=f.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:x.jsx(P2,{className:"w-5 h-5 text-green-600"})}),x.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[x.jsx("button",{onClick:()=>c("bar"),className:`px-2 py-0.5 rounded-full text-xs ${l==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),x.jsx("button",{onClick:()=>c("line"),className:`px-2 py-0.5 rounded-full text-xs ${l==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),x.jsx("button",{onClick:()=>c("pie"),className:`px-2 py-0.5 rounded-full text-xs ${l==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),x.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"":"",children:a.matrixData?x.jsx(ma,{className:"w-5 h-5 text-red-500"}):x.jsx(xu,{className:"w-5 h-5"})})]})]}),a.matrixData?x.jsx(FS,{matrixData:a.matrixData,onUpdate:A=>g({matrixData:A})}):null,x.jsx("div",{className:"mt-4",children:b()})]})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsx("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},_m=({value:t,onChange:e,placeholder:n})=>x.jsx("textarea",{value:t,onChange:r=>e(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),rG=({isOpen:t,onClose:e,onSave:n,task:r,generateUniqueId:a})=>{var F;const[i,l]=U.useState([]),[c,d]=U.useState(!1),[f,g]=U.useState(null),[v,_]=U.useState({key:"status",direction:"ascending"});U.useEffect(()=>{var K;t&&l(((K=r.extendedDetails)==null?void 0:K.decisions)||[])},[t,(F=r.extendedDetails)==null?void 0:F.decisions]);const T=U.useMemo(()=>{let K=[...i];return v!==null&&K.sort((P,ae)=>{let G="",te="";switch(v.key){case"status":G=P.status==="undecided"?0:1,te=ae.status==="undecided"?0:1;break;case"date":G=P.date||"9999-12-31",te=ae.date||"9999-12-31";break;default:G=(P[v.key]||"").toLowerCase(),te=(ae[v.key]||"").toLowerCase()}return G<te?v.direction==="ascending"?-1:1:G>te?v.direction==="ascending"?1:-1:0}),K},[i,v]),E=K=>{let P="ascending";v&&v.key===K&&v.direction==="ascending"&&(P="descending"),_({key:K,direction:P})},S=K=>!v||v.key!==K?x.jsx(ji,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):v.direction==="ascending"?x.jsx(Xc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(ji,{className:"w-3 h-3 ml-1 text-blue-600"}),b=({sortKey:K,label:P,className:ae})=>x.jsx("th",{className:`p-0 border border-slate-300 ${ae||""}`,children:x.jsxs("button",{onClick:()=>E(K),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:P}),S(K)]})}),k=async()=>{d(!0),g(null);try{const P=(await yL(r,i)).map(ae=>ae.id==="NEW"?{...ae,id:a("dec_ai")}:ae);l(P)}catch(K){g(K instanceof Error?K.message:"")}finally{d(!1)}},A=(K,P)=>{l(ae=>ae.map(G=>G.id===K?{...G,...P}:G))},C=(K,P)=>{const ae=i.find(te=>te.id===K);if(!ae)return;const G={status:P};P==="decided"&&!ae.date?G.date=new Date().toISOString().split("T")[0]:P==="undecided"&&(G.date=void 0),A(K,G)},M=K=>{l(P=>P.filter(ae=>ae.id!==K))},B=()=>{const K={id:a("dec_manual"),question:"",status:"undecided"};l(P=>[K,...P])},H=()=>{n(i)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[x.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[c?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(wl,{className:"w-5 h-5"}),x.jsx("span",{children:"AI"})]}),x.jsxs("button",{onClick:B,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[x.jsx(Np,{className:"w-5 h-5"}),x.jsx("span",{children:""})]}),x.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]})]}),f&&x.jsx("div",{className:"p-4",children:x.jsx(Wi,{message:f})}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(b,{sortKey:"status",label:"",className:"w-32"}),x.jsx(b,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),x.jsx(b,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),x.jsx(b,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),x.jsx(b,{sortKey:"date",label:"",className:"w-36"}),x.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),x.jsxs("tbody",{children:[T.map(K=>x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsxs("select",{value:K.status,onChange:P=>C(K.id,P.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${K.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[x.jsx("option",{value:"undecided",children:""}),x.jsx("option",{value:"decided",children:""})]})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(_m,{value:K.question||"",onChange:P=>A(K.id,{question:P}),placeholder:""})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(_m,{value:K.decision||"",onChange:P=>A(K.id,{decision:P}),placeholder:"..."})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(_m,{value:K.reasoning||"",onChange:P=>A(K.id,{reasoning:P}),placeholder:"..."})}),x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsx("input",{type:"date",value:K.date||"",onChange:P=>A(K.id,{date:P.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:K.status==="undecided"})}),x.jsx("td",{className:"border border-slate-300 text-center align-middle",children:x.jsx("button",{onClick:()=>M(K.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:x.jsx(ma,{className:"w-5 h-5"})})})]},K.id)),i.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),x.jsx("button",{onClick:H,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},xT=({items:t,taskName:e,onClose:n})=>{var g;const[r,a]=U.useState(null),i=U.useMemo(()=>new Set(t.map(v=>v.subStep.id)).size<=1,[t]),l=U.useMemo(()=>{let v=[...t];return r!==null&&v.sort((_,T)=>{let E="",S="";switch(r.key){case"status":E=_.actionItem.completed,S=T.actionItem.completed;break;case"dueDate":E=_.actionItem.dueDate||"9999-12-31",S=T.actionItem.dueDate||"9999-12-31";break;case"completedDate":E=_.actionItem.completedDate||"9999-12-31",S=T.actionItem.completedDate||"9999-12-31";break;case"text":E=(_.actionItem.text||"").toLowerCase(),S=(T.actionItem.text||"").toLowerCase();break;case"subStep":E=(_.subStep.text||"").toLowerCase(),S=(T.subStep.text||"").toLowerCase();break;case"responsible":E=(_.actionItem.responsible||"").toLowerCase(),S=(T.actionItem.responsible||"").toLowerCase();break}return E<S?r.direction==="ascending"?-1:1:E>S?r.direction==="ascending"?1:-1:0}),v},[t,r]),c=v=>{let _="ascending";r&&r.key===v&&r.direction==="ascending"&&(_="descending"),a({key:v,direction:_})},d=v=>!r||r.key!==v?x.jsx(ji,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):r.direction==="ascending"?x.jsx(Xc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(ji,{className:"w-3 h-3 ml-1 text-blue-600"}),f=({sortKey:v,label:_,className:T})=>x.jsx("th",{scope:"col",className:`p-0 ${T||""}`,children:x.jsxs("button",{onClick:()=>c(v),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:_}),d(v)]})});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("p",{className:"text-sm text-slate-500",children:i?`: ${e} / : ${((g=t[0])==null?void 0:g.subStep.text)||""}`:`: ${e}`})]}),x.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(f,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),x.jsx(f,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),!i&&x.jsx(f,{sortKey:"subStep",label:"",className:"w-1/5 border border-slate-300"}),x.jsx(f,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),x.jsxs("tbody",{className:"bg-white",children:[l.map(({actionItem:v,subStep:_})=>{var T;return x.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:v.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(gu,{className:"w-4 h-4 mr-1"}),""]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(Ld,{className:"w-4 h-4 mr-1"}),""]})}),x.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[v.text,v.report&&Array.isArray(v.report.attachments)&&v.report.attachments.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:v.report.attachments.map(E=>x.jsxs("a",{href:E.dataUrl,target:"_blank",rel:"noopener noreferrer",download:E.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[x.jsx(Xs,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:E.name})]},E.id))}),((T=v.report)==null?void 0:T.notes)&&x.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:v.report.notes})]}),!i&&x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.responsible||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.dueDate||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.completedDate||""})]},v.id)}),t.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:i?5:6,className:"text-center py-10 text-slate-500",children:""})})]})]})}),x.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},aG=({task:t,isOpen:e,onClose:n,onReportGenerated:r})=>{const[a,i]=U.useState(""),[l,c]=U.useState(new Set),[d,f]=U.useState(!1),[g,v]=U.useState(null),_=U.useMemo(()=>{var C,M,B,H;const A=[];return A.push({id:`task-data-${t.id}`,name:`: ${t.title}`,type:"Task Data",source:{name:`: ${t.title}`,type:"json",content:t}}),(M=(C=t.extendedDetails)==null?void 0:C.attachments)==null||M.forEach(F=>{A.push({id:F.id,name:`: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(H=(B=t.extendedDetails)==null?void 0:B.subSteps)==null||H.forEach(F=>{var K;(K=F.actionItems)==null||K.forEach(P=>{var ae,G,te;(ae=P.report)!=null&&ae.matrixData&&A.push({id:`matrix-${P.id}`,name:`: ${P.text} (${F.text})`,type:"Data Matrix",source:{name:`: ${P.text}`,type:"json",content:P.report.matrixData}}),(te=(G=P.report)==null?void 0:G.attachments)==null||te.forEach(we=>{A.push({id:we.id,name:`: ${we.name} (${P.text})`,type:"Attachment",source:{name:we.name,type:we.type.startsWith("image/")?"image":"text",content:we.dataUrl}})})})}),A},[t]),T=U.useMemo(()=>_.find(A=>A.type==="Task Data"),[_]),E=U.useMemo(()=>_.filter(A=>A.type!=="Task Data"),[_]);U.useEffect(()=>{if(e){const A=new Set;T&&A.add(T.id),c(A)}},[e,T]);const S=A=>{const C=_.find(M=>M.id===A);(C==null?void 0:C.type)!=="Task Data"&&c(M=>{const B=new Set(M);return B.has(A)?B.delete(A):B.add(A),B})},b=async()=>{if(!a.trim()){v("");return}if(l.size===0){v("1");return}f(!0),v(null);try{const A=_.filter(M=>l.has(M.id)).map(M=>M.source),C=await L2(A,a);r(C)}catch(A){v(A instanceof Error?A.message:"")}finally{f(!1)}};if(!e)return null;const k=A=>{switch(A){case"Task Data":return x.jsx(Bi,{className:"w-5 h-5 text-blue-600"});case"Attachment":return x.jsx(Xs,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(xu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Bi,{className:"w-5 h-5 text-slate-500"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),x.jsxs("div",{className:"mb-4",children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),x.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[x.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),T&&k(T.type),x.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:T==null?void 0:T.name,children:T==null?void 0:T.name})]})]}),E.length>0&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:E.map(A=>x.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:l.has(A.id),onChange:()=>S(A.id),className:"w-4 h-4 accent-blue-600"}),k(A.type),x.jsx("span",{className:"text-sm text-slate-700 truncate",title:A.name,children:A.name})]},A.id))})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),x.jsx("textarea",{value:a,onChange:A=>i(A.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&x.jsx("div",{className:"mt-2",children:x.jsx(Wi,{message:g})})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),x.jsxs("button",{onClick:b,disabled:d,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[d?x.jsx(Mn,{size:"sm",color:"border-white"}):x.jsx(wl,{className:"w-5 h-5"}),x.jsx("span",{children:d?"...":""})]})]})]})})},Sa=({label:t,name:e,value:n,onChange:r,type:a="text",placeholder:i,rows:l,disabled:c=!1,icon:d,required:f=!1})=>x.jsxs("div",{className:"mb-4",children:[x.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[d&&x.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:d}),t,f&&x.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a==="textarea"?x.jsx("textarea",{id:e,name:e,value:n,onChange:r,rows:l||3,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):x.jsx("input",{type:a,id:e,name:e,value:n,onChange:r,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),sG=ls.memo(({subStep:t,onRemove:e,onDragStart:n,onClick:r,cardRef:a,isSelected:i,onStartConnection:l,onEndConnection:c})=>{var g,v;const d=_=>{switch(_){case ur.COMPLETED:return"border-l-4 border-green-500";case ur.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},f=_=>{_.stopPropagation(),l(t.id,_)};return x.jsxs("div",{ref:a,draggable:!0,onDragStart:_=>n(_,t.id),onClick:r,onMouseUp:_=>{_.stopPropagation(),c(t.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-56 h-auto min-h-[100px] text-xs flex flex-col hover:shadow-md transition-all duration-200 ${i?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${d(t.status)}`,style:{left:((g=t.position)==null?void 0:g.x)||0,top:((v=t.position)==null?void 0:v.y)||0,touchAction:"none"},children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[x.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",t.id.slice(-4)]}),x.jsx("button",{onClick:_=>{_.stopPropagation(),e()},className:"text-red-400 hover:text-red-600 p-0.5",title:"",children:x.jsx(ma,{className:"w-3.5 h-3.5"})})]}),x.jsx("p",{className:`mb-1 break-words font-semibold text-slate-800 ${t.status===ur.COMPLETED?"line-through text-slate-500":""}`,children:t.text||""})]}),x.jsx("div",{className:"flex-grow my-1 border-t pt-1 min-h-0",children:x.jsx("div",{className:"text-[10px] text-slate-600 space-y-1 h-full max-h-20 overflow-y-auto pr-1",children:(t.actionItems||[]).length>0?(t.actionItems||[]).map(_=>x.jsxs("div",{className:`flex justify-between items-center ${_.completed?"text-slate-400 line-through":""}`,children:[x.jsx("span",{className:"truncate pr-1",title:_.text,children:_.text}),_.dueDate&&x.jsx("span",{className:"flex-shrink-0 text-slate-500",children:new Date(_.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]},_.id)):x.jsx("div",{className:"text-center text-slate-400 pt-2",children:""})})}),x.jsx("div",{className:"mt-auto",children:t.dueDate&&x.jsxs("div",{className:"text-[11px] text-orange-600 font-medium flex items-center justify-end",children:[x.jsx(Pd,{className:"w-3 h-3 mr-1"}),": ",new Date(t.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"2-digit",month:"numeric",day:"numeric"})]})}),x.jsx("div",{onMouseDown:f,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:""})]})}),iG=ls.memo(({items:t,onToggle:e,onAdd:n,onUpdate:r,onRemove:a,onOpenReport:i,onOpenTable:l})=>x.jsxs("div",{className:"space-y-2 mt-2",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:""}),x.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-slate-200",title:"",children:x.jsx(xu,{className:"w-5 h-5 text-slate-500"})})]}),x.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:t.map(c=>x.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>e(c.id),className:"flex-shrink-0",children:c.completed?x.jsx(gu,{className:"w-5 h-5 text-green-600"}):x.jsx(Ld,{className:"w-5 h-5 text-slate-400"})}),x.jsx("div",{className:"flex-grow",onDoubleClick:()=>i(c),children:x.jsx("input",{type:"text",value:c.text,onChange:d=>r(c.id,{text:d.target.value}),placeholder:"",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${c.completed?"line-through text-slate-500":"text-slate-800"}`})}),x.jsx("button",{onClick:()=>a(c.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:x.jsx(ma,{className:"w-4 h-4"})})]}),x.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[c.completed&&c.completedDate?x.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[x.jsx(pu,{className:"w-4 h-4 mr-1"}),": ",new Date(c.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):x.jsx("div",{className:"mr-auto"}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`responsible-${c.id}`,className:"mr-1 flex items-center",title:"",children:x.jsx(U2,{className:"w-4 h-4"})}),x.jsx("input",{type:"text",id:`responsible-${c.id}`,value:c.responsible||"",onChange:d=>r(c.id,{responsible:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"",disabled:c.completed})]}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`due-date-${c.id}`,className:"mr-1",children:":"}),x.jsx("input",{type:"date",id:`due-date-${c.id}`,value:c.dueDate||"",onChange:d=>r(c.id,{dueDate:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"",disabled:c.completed})]})]})]},c.id))}),x.jsxs("button",{onClick:n,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(Np,{className:"w-4 h-4"}),""]})]})),oG=({task:t,onClose:e,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:i,targetDate:l})=>{var R,j,O,V,z,Y,ue,ve,le,de,pe,De,Le,Ue,Ie;if(!t)return null;const[c,d]=U.useState(t),[f,g]=U.useState(t),[v,_]=U.useState("none"),[T,E]=U.useState(!1),[S,b]=U.useState(!1),[k,A]=U.useState(!1),[C,M]=U.useState(!1),[B,H]=U.useState(!1),[F,K]=U.useState(null),[P,ae]=U.useState(!1),[G,te]=U.useState(!1),[we,Re]=U.useState([]),[ye,se]=U.useState([]),[me,re]=U.useState(!1),[J,D]=U.useState(null),[ee,I]=U.useState([]),W=U.useRef(null),[X,q]=U.useState(new Map),oe=U.useRef(null),_e=U.useRef({x:0,y:0}),[Se,Ee]=U.useState(null),Ce=U.useRef(null),Ke=U.useRef(null),[Z,ft]=U.useState(null),[Xe,wt]=U.useState({x:0,y:0}),[rt,Fe]=U.useState([]),Ut=U.useMemo(()=>JSON.stringify(f)!==JSON.stringify(c),[f,c]),cn=U.useMemo(()=>{var Te;const Q=((Te=c.extendedDetails)==null?void 0:Te.decisions)||[];return{decided:Q.filter(ke=>ke.status==="decided").length,undecided:Q.filter(ke=>ke.status==="undecided").length}},[(R=c.extendedDetails)==null?void 0:R.decisions]);U.useEffect(()=>{d(t),g(t),Re([]),se([])},[t]),U.useEffect(()=>{var Te;const Q=new Map;(((Te=c.extendedDetails)==null?void 0:Te.subSteps)||[]).forEach(ke=>{ke&&ke.id&&Q.set(ke.id,X.get(ke.id)||ls.createRef())}),q(Q)},[(j=c.extendedDetails)==null?void 0:j.subSteps]);const rn=U.useCallback(()=>{var Te;if(!W.current){Fe([]);return}const Q=[];(((Te=c.extendedDetails)==null?void 0:Te.subSteps)||[]).forEach(ke=>{var Pe,je;if((Pe=ke==null?void 0:ke.nextSubStepIds)!=null&&Pe.length){const lt=(je=X.get(ke.id))==null?void 0:je.current;if(lt&&ke.position){const Mt={x:ke.position.x+lt.offsetWidth,y:ke.position.y+lt.offsetHeight/2};ke.nextSubStepIds.forEach(St=>{var Ft,jr;const It=(Ft=c.extendedDetails)==null?void 0:Ft.subSteps.find(hn=>hn.id===St),dn=(jr=X.get(St))==null?void 0:jr.current;if(It&&dn&&It.position){const hn={x:It.position.x,y:It.position.y+dn.offsetHeight/2};Q.push({id:`subconn-${ke.id}-${St}`,from:Mt,to:hn,sourceId:ke.id,targetId:St})}})}}}),Fe(Q)},[(O=c.extendedDetails)==null?void 0:O.subSteps,X]);U.useEffect(()=>{const Q=setTimeout(rn,100);return()=>clearTimeout(Q)},[rn]);const an=U.useCallback(Q=>{d(Te=>(Re(ke=>[...ke,Te]),se([]),Q(Te)))},[]),Ln=Q=>{an(Te=>({...Te,...typeof Q=="function"?Q(Te):Q}))},Tt=Q=>{Ln(Te=>({extendedDetails:{...Te.extendedDetails,...typeof Q=="function"?Q(Te.extendedDetails):Q}}))},en=()=>{if(we.length===0)return;const Q=we[we.length-1];Re(Te=>Te.slice(0,-1)),se(Te=>[c,...Te]),d(Q)},Hn=()=>{if(ye.length===0)return;const Q=ye[0];se(Te=>Te.slice(1)),Re(Te=>[...Te,c]),d(Q)},vn=async()=>{re(!0),D(null);try{const Q=await vL(c);I(Q),b(!0)}catch(Q){D(Q instanceof Error?Q.message:"")}finally{re(!1)}},Zt=Q=>{Tt(Te=>{const ke=Te.subSteps||[],Pe=ke.length,je=Q.newSubSteps.map((Mt,St)=>({id:a("sub_ai"),text:Mt.title,notes:Mt.description,status:ur.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Pe+St)%4*210,y:Math.floor((Pe+St)/4)*90+10}}));return{subSteps:[...ke.map(Mt=>{const St=Q.newActionItems.filter(dn=>dn.targetSubStepId===Mt.id);if(St.length===0)return Mt;const It=St.map(dn=>({id:a("action_ai"),text:dn.title,completed:!1}));return{...Mt,actionItems:[...Mt.actionItems||[],...It]}}),...je]}}),b(!1)},Dt=()=>{var ke,Pe;const Q=((Pe=(ke=c.extendedDetails)==null?void 0:ke.subSteps)==null?void 0:Pe.length)||0,Te={id:a("sub_new"),text:"",status:ur.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+Q%4*210,y:Math.floor(Q/4)*90+10}};Tt(je=>({subSteps:[...je.subSteps||[],Te]})),Ee(Te.id)},it=U.useCallback((Q,Te)=>{Tt(ke=>({subSteps:(ke.subSteps||[]).map(Pe=>Pe.id===Q?{...Pe,...typeof Te=="function"?Te(Pe):Te}:Pe)}))},[Tt]),tt=U.useCallback(Q=>{Ee(Te=>Te===Q?null:Te),Tt(Te=>({subSteps:(Te.subSteps||[]).filter(ke=>ke.id!==Q).map(ke=>{var Pe;return{...ke,nextSubStepIds:(Pe=ke.nextSubStepIds)==null?void 0:Pe.filter(je=>je!==Q)}})}))},[Tt]),Et=()=>{var ii;const Q=(ii=c.extendedDetails)==null?void 0:ii.subSteps,Te=W.current;if(!Q||Q.length===0||!Te)return;const ke=new Map;Q.forEach($t=>{var kn;const xt=(kn=X.get($t.id))==null?void 0:kn.current;ke.set($t.id,{width:(xt==null?void 0:xt.offsetWidth)||224,height:(xt==null?void 0:xt.offsetHeight)||100})});const Pe=new Map,je=new Map;Q.forEach($t=>{Pe.set($t.id,[]),je.set($t.id,0)}),Q.forEach($t=>{($t.nextSubStepIds||[]).forEach(xt=>{Pe.has(xt)&&(Pe.get($t.id).push(xt),je.set(xt,je.get(xt)+1))})});const lt=Q.filter($t=>je.get($t.id)===0).map($t=>$t.id),Mt=[];let St=0;for(;lt.length>0;){const $t=lt.length,xt=[];for(let kn=0;kn<$t;kn++){const oi=lt.shift();xt.push(oi),St++,(Pe.get(oi)||[]).forEach(na=>{je.set(na,je.get(na)-1),je.get(na)===0&&lt.push(na)})}Mt.push(xt)}if(St<Q.length){const $t=new Set(Mt.flat()),xt=Q.filter(kn=>!$t.has(kn.id)).map(kn=>kn.id);xt.length>0&&Mt.push(xt)}const It=Te.clientWidth,dn=60,Ft=20,jr=new Map;let hn=10,bl=10,to=0;Mt.forEach($t=>{const kn=Math.max(...$t.map(br=>ke.get(br).width))+dn;let oi=$t.reduce((br,Su)=>br+ke.get(Su).height+Ft,0)-($t.length>0?Ft:0);hn>10&&hn+kn>It&&(hn=10,bl+=to+Ft*2,to=0);let na=0;$t.forEach(br=>{jr.set(br,{x:hn,y:bl+na}),na+=ke.get(br).height+Ft}),hn+=kn,to=Math.max(to,oi)});let ys=0,no=0;jr.forEach(($t,xt)=>{const kn=ke.get(xt);ys=Math.max(ys,$t.x+kn.width),no=Math.max(no,$t.y+kn.height)}),Tt($t=>({subSteps:($t.subSteps||[]).map(xt=>({...xt,position:jr.get(xt.id)||xt.position})),subStepCanvasSize:{width:ys+20,height:no+20}}))},sn=(Q,Te)=>{oe.current=Te;const ke=Q.currentTarget.getBoundingClientRect();_e.current={x:Q.clientX-ke.left,y:Q.clientY-ke.top},Q.dataTransfer.effectAllowed="move"},Me=Q=>{Q.preventDefault(),Q.dataTransfer.dropEffect="move"},Ye=Q=>{var It;if(Q.preventDefault(),!oe.current||!W.current)return;const Te=W.current.getBoundingClientRect(),ke=(It=X.get(oe.current))==null?void 0:It.current;if(!ke)return;const Pe=ke.offsetWidth,je=ke.offsetHeight;let lt=Q.clientX-Te.left-_e.current.x+W.current.scrollLeft,Mt=Q.clientY-Te.top-_e.current.y+W.current.scrollTop;const St=W.current.querySelector(".substep-inner-canvas");St&&(lt=Math.max(0,Math.min(lt,St.scrollWidth-Pe)),Mt=Math.max(0,Math.min(Mt,St.scrollHeight-je))),it(oe.current,{position:{x:lt,y:Mt}}),oe.current=null},Ge=Q=>{K(Q),A(!0)},We=(Q,Te)=>{var Mt;const ke=(Mt=Q.target.files)==null?void 0:Mt[0];if(!ke)return;const Pe=5,je=Pe*1024*1024;if(ke.size>je){alert(`${Pe}MB`),Q.target&&(Q.target.value="");return}const lt=new FileReader;lt.onload=St=>{var It;if(typeof((It=St.target)==null?void 0:It.result)=="string"){const dn={id:a("attach"),name:ke.name,type:ke.type,dataUrl:St.target.result};Te==="task"?Tt(Ft=>({attachments:[...Ft.attachments||[],dn]})):Te==="substep"&&Se&&it(Se,Ft=>({attachments:[...Ft.attachments||[],dn]}))}else alert("")},lt.onerror=()=>{alert("")},lt.readAsDataURL(ke),Q.target&&(Q.target.value="")},nt=(Q,Te)=>{Te==="task"?Tt(ke=>{var Pe;return{attachments:(Pe=ke.attachments)==null?void 0:Pe.filter(je=>je.id!==Q)}}):Te==="substep"&&Se&&it(Se,ke=>{var Pe;return{attachments:(Pe=ke.attachments)==null?void 0:Pe.filter(je=>je.id!==Q)}})},lr=(Q,Te)=>{if(!W.current)return;const ke=W.current.getBoundingClientRect(),Pe={x:Te.clientX-ke.left+W.current.scrollLeft,y:Te.clientY-ke.top+W.current.scrollTop};ft({fromId:Q,fromPos:Pe})},Ur=Q=>{if(!Z)return;const{fromId:Te}=Z;if(Te===Q){ft(null);return}it(Te,ke=>({...ke,nextSubStepIds:Array.from(new Set([...ke.nextSubStepIds||[],Q]))})),ft(null)},Ua=(Q,Te)=>{it(Q,ke=>{var Pe;return{...ke,nextSubStepIds:(Pe=ke.nextSubStepIds)==null?void 0:Pe.filter(je=>je!==Te)}})},Ba=Q=>{if(!Z||!W.current)return;const Te=W.current.getBoundingClientRect();wt({x:Q.clientX-Te.left+W.current.scrollLeft,y:Q.clientY-Te.top+W.current.scrollTop})},ta=()=>{Z&&ft(null)},xa=(Q,Te)=>{it(Q,ke=>{var Pe;return{actionItems:(Pe=ke.actionItems)==null?void 0:Pe.map(je=>je.id===Te.id?Te:je)}}),A(!1),K(null)},ps=(Q,Te,ke)=>{it(Q,Pe=>{var je;return{actionItems:(je=Pe.actionItems)==null?void 0:je.map(lt=>lt.id===Te?{...lt,...ke}:lt)}})},gs=(Q,Te)=>{Tt(ke=>({subSteps:(ke.subSteps||[]).map(je=>{var dn;if(je.id!==Q)return je;const lt=(dn=je.actionItems)==null?void 0:dn.map(Ft=>{if(Ft.id!==Te)return Ft;const jr=!Ft.completed;return{...Ft,completed:jr,completedDate:jr?new Date().toISOString().split("T")[0]:void 0}}),Mt=lt==null?void 0:lt.every(Ft=>Ft.completed),St=lt==null?void 0:lt.some(Ft=>Ft.completed);let It=je.status;return lt&&lt.length>0?Mt?It=ur.COMPLETED:St?It=ur.IN_PROGRESS:It=ur.NOT_STARTED:It=ur.NOT_STARTED,{...je,actionItems:lt,status:It}})}))},ja=Q=>{it(Q,Te=>({actionItems:[...Te.actionItems||[],{id:a("action"),text:"",completed:!1}]}))},Va=(Q,Te)=>{it(Q,ke=>{var Pe;return{actionItems:(Pe=ke.actionItems)==null?void 0:Pe.filter(je=>je.id!==Te)}})},xs=()=>{n(c.id,{title:c.title,description:c.description,status:c.status}),r(c.id,c.extendedDetails),e()},si=Q=>{Tt({reportDeck:Q})},xr=()=>{H(!0)},un=Q=>{Tt({reportDeck:Q}),H(!1),E(!0)},fn=()=>{if(!Ut){e();return}window.confirm(`

OK
`)&&e()},Br=Q=>{Tt({decisions:Q}),M(!1)},gt=((z=(V=c.extendedDetails)==null?void 0:V.subSteps)==null?void 0:z.find(Q=>Q.id===Se))||null,vs=(Q,Te)=>x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!Q||Q.length===0?x.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:""}):Q.map(ke=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[x.jsx("a",{href:ke.dataUrl,download:ke.name,className:"block w-full h-full","aria-label":`Download ${ke.name}`,children:ke.type.startsWith("image/")?x.jsx("img",{src:ke.dataUrl,alt:ke.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:x.jsx(Xs,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:ke.name,children:ke.name})}),x.jsx("button",{onClick:()=>Te(ke.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(ma,{className:"w-3 h-3"})})]},ke.id))});return T&&((Y=c.extendedDetails)!=null&&Y.reportDeck)?x.jsx(G2,{tasks:[c],initialDeck:c.extendedDetails.reportDeck,onSave:si,onClose:()=>E(!1),generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:"task"}):S?x.jsx(KO,{proposals:ee,existingSubSteps:((ue=c.extendedDetails)==null?void 0:ue.subSteps)||[],onConfirm:Zt,onClose:()=>b(!1)}):k&&F&&gt?x.jsx(nG,{actionItem:F,onSave:Q=>xa(gt.id,Q),onClose:()=>A(!1),generateUniqueId:a}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:x.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[x.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[c.title," - "]}),x.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[x.jsx("button",{onClick:fn,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:""}),x.jsx("button",{onClick:xs,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:""}),x.jsx("button",{onClick:xr,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:""})]})]})}),x.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:x.jsxs("div",{className:"flex gap-6 h-full",children:[x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="info"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(AL,{className:"w-5 h-5 mr-2 text-purple-600"}),""]}),x.jsx("button",{onClick:()=>_(v==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="info"?"":"",children:v==="info"?x.jsx(lm,{className:"w-5 h-5"}):x.jsx(om,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[x.jsx(Sa,{label:"",name:"title",value:c.title,onChange:Q=>Ln({title:Q.target.value}),required:!0}),x.jsx(Sa,{label:"",name:"description",value:c.description,onChange:Q=>Ln({description:Q.target.value}),type:"textarea",rows:3,required:!0}),x.jsx(Sa,{icon:x.jsx(U2,{}),label:"/",name:"responsible",value:c.extendedDetails.responsible,onChange:Q=>Tt({responsible:Q.target.value})}),x.jsx(Sa,{icon:x.jsx(Pd,{}),label:"",name:"dueDate",type:"date",value:c.extendedDetails.dueDate||"",onChange:Q=>Tt({dueDate:Q.target.value})}),x.jsxs("div",{children:[x.jsx(Sa,{icon:x.jsx(LL,{}),label:"",name:"resources",value:c.extendedDetails.resources,onChange:Q=>Tt({resources:Q.target.value}),type:"textarea"}),(ve=c.extendedDetails)!=null&&ve.resourceMatrix?x.jsx("div",{className:"mt-2",children:x.jsx(FS,{matrixData:c.extendedDetails.resourceMatrix,onUpdate:Q=>Tt({resourceMatrix:Q})})}):x.jsxs("button",{onClick:()=>Tt({resourceMatrix:{headers:["",""],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(xu,{className:"w-4 h-4"}),""]})]}),x.jsx(Sa,{icon:x.jsx(FL,{}),label:"",name:"notes",value:c.extendedDetails.notes,onChange:Q=>Tt({notes:Q.target.value}),type:"textarea",rows:4}),x.jsx("div",{className:"pt-4 border-t mt-4",children:x.jsxs("button",{onClick:()=>M(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx($2,{className:"w-5 h-5 text-cyan-600"}),""]}),x.jsxs("div",{className:"flex gap-2 text-xs",children:[x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:[": ",cn.decided]}),x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:[": ",cn.undecided]})]})]})}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",x.jsx("button",{onClick:()=>{var Q;return(Q=Ce.current)==null?void 0:Q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:x.jsx(Xs,{className:"w-4 h-4 text-slate-600"})})]}),vs((le=c.extendedDetails)==null?void 0:le.attachments,Q=>nt(Q,"task")),x.jsx("input",{type:"file",ref:Ce,onChange:Q=>We(Q,"task"),className:"hidden"})]}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[x.jsx(Rp,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AI"]}),x.jsx("button",{onClick:vn,disabled:me,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:me?x.jsx(Mn,{size:"sm"}):"AI"}),J&&x.jsx("div",{className:"mt-2",children:x.jsx(Wi,{message:J})})]})]})]}),x.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${v==="canvas"||v==="none"?"flex-1":"hidden"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(RL,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),x.jsxs("div",{className:"flex gap-2 items-center",children:[x.jsx("button",{onClick:en,disabled:we.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:x.jsx(j2,{className:"w-3 h-3"})}),x.jsx("button",{onClick:Hn,disabled:ye.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:x.jsx(V2,{className:"w-3 h-3"})}),x.jsxs("button",{onClick:Dt,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[x.jsx(Ui,{className:"w-3 h-3"}),""]}),x.jsxs("button",{onClick:Et,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"",children:[x.jsx(Od,{className:"w-3 h-3"}),""]}),x.jsx("button",{onClick:()=>_(v==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="canvas"?"":"",children:v==="canvas"?x.jsx(lm,{className:"w-5 h-5"}):x.jsx(om,{className:"w-5 h-5"})})]})]}),x.jsx("div",{ref:W,onMouseMove:Ba,onMouseUp:ta,onDragOver:Me,onDrop:Ye,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${v==="canvas"?"":"flex-grow"}`,children:x.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((pe=(de=c.extendedDetails)==null?void 0:de.subStepCanvasSize)==null?void 0:pe.width)||1200}px`,height:`${((Le=(De=c.extendedDetails)==null?void 0:De.subStepCanvasSize)==null?void 0:Le.height)||800}px`},children:[(((Ue=c.extendedDetails)==null?void 0:Ue.subSteps)||[]).map(Q=>Q?x.jsx(sG,{subStep:Q,cardRef:X.get(Q.id),isSelected:Se===Q.id,onClick:()=>Ee(Q.id),onRemove:()=>tt(Q.id),onDragStart:sn,onStartConnection:lr,onEndConnection:Ur},Q.id):null),rt.map(Q=>x.jsx(Qc,{from:Q.from,to:Q.to,id:Q.id,onDelete:()=>Ua(Q.sourceId,Q.targetId)},Q.id)),Z&&x.jsx(Qc,{from:Z.fromPos,to:Xe,id:"preview-connector"})]})})]}),x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="details"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[x.jsx("div",{className:"mb-0",children:x.jsx("button",{onClick:()=>te(!0),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-indigo-800 font-semibold flex justify-between items-center",children:x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(gu,{className:"w-5 h-5 text-indigo-600"}),""]})})}),x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:""}),x.jsx("button",{onClick:()=>_(v==="details"?"none":"details"),disabled:!gt,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:v==="details"?"":"",children:v==="details"?x.jsx(lm,{className:"w-5 h-5"}):x.jsx(om,{className:"w-5 h-5"})})]}),x.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:gt?x.jsxs("div",{className:"space-y-4",children:[x.jsx(Sa,{label:"",name:"text",value:gt.text,onChange:Q=>it(gt.id,{text:Q.target.value}),type:"textarea"}),x.jsx(Sa,{label:"",name:"responsible",value:gt.responsible||"",onChange:Q=>it(gt.id,{responsible:Q.target.value})}),x.jsx(Sa,{label:"",name:"dueDate",type:"date",value:gt.dueDate||"",onChange:Q=>it(gt.id,{dueDate:Q.target.value})}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),x.jsx("select",{value:gt.status||ur.NOT_STARTED,onChange:Q=>it(gt.id,{status:Q.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(ur).map(Q=>x.jsx("option",{value:Q,children:Q},Q))})]}),x.jsx(Sa,{label:"",name:"notes",value:gt.notes||"",onChange:Q=>it(gt.id,{notes:Q.target.value}),type:"textarea"}),x.jsx(iG,{items:gt.actionItems||[],onToggle:Q=>gs(gt.id,Q),onAdd:()=>ja(gt.id),onUpdate:(Q,Te)=>ps(gt.id,Q,Te),onRemove:Q=>Va(gt.id,Q),onOpenReport:Ge,onOpenTable:()=>ae(!0)}),x.jsxs("div",{children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",x.jsx("button",{onClick:()=>{var Q;return(Q=Ke.current)==null?void 0:Q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:x.jsx(Xs,{className:"w-4 h-4 text-slate-600"})})]}),vs(gt.attachments,Q=>nt(Q,"substep")),x.jsx("input",{type:"file",ref:Ke,onChange:Q=>We(Q,"substep"),className:"hidden"})]})]}):x.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:x.jsxs("p",{children:["",x.jsx("br",{}),""]})})})]})]})})]}),C&&x.jsx(rG,{task:c,isOpen:C,onClose:()=>M(!1),onSave:Br,generateUniqueId:a}),G&&x.jsx(xT,{items:(((Ie=c.extendedDetails)==null?void 0:Ie.subSteps)||[]).flatMap(Q=>(Q.actionItems||[]).map(Te=>({actionItem:Te,subStep:Q}))),taskName:c.title,onClose:()=>te(!1)}),P&&gt&&x.jsx(xT,{items:(gt.actionItems||[]).map(Q=>({actionItem:Q,subStep:gt})),taskName:c.title,onClose:()=>ae(!1)}),B&&x.jsx(aG,{task:c,isOpen:B,onClose:()=>H(!1),onReportGenerated:un})]})},lG=({onSetApiKey:t,error:e,isLoading:n})=>{const[r,a]=U.useState(""),i=l=>{l.preventDefault(),t(r)};return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsx(wl,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),x.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),x.jsxs("form",{onSubmit:i,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Zc,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),x.jsx("input",{id:"apiKey",type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),e&&x.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:e}),x.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?x.jsx(Mn,{size:"sm"}):""})]}),x.jsxs("div",{className:"text-center mt-6",children:[x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),x.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),x.jsx("footer",{className:"mt-8 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},LS=({isOpen:t,onClose:e,onSuccess:n})=>{const[r,a]=U.useState(!0),[i,l]=U.useState(""),[c,d]=U.useState(""),[f,g]=U.useState(!1),[v,_]=U.useState(null),T=async E=>{E.preventDefault(),g(!0),_(null);try{if(r){const{error:S}=await Yt.auth.signInWithPassword({email:i,password:c});if(S)throw S}else{const{error:S}=await Yt.auth.signUp({email:i,password:c});if(S)throw S}n()}catch(S){_(S instanceof Error?S.message:"")}finally{g(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[x.jsx(Zc,{className:"w-6 h-6 mr-2 text-blue-600"}),r?"":""]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-5 h-5"})})]}),x.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),x.jsx("input",{type:"email",id:"email",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),x.jsx("input",{type:"password",id:"password",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),v&&x.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:v}),x.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:f?x.jsx(Mn,{size:"sm",color:"border-white"}):r?"":""}),x.jsx("div",{className:"text-center",children:x.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:underline",children:r?"":""})})]})]})}):null},cG=({isOpen:t,onClose:e,onSelectProject:n,onCreateNew:r})=>{const[a,i]=U.useState([]),[l,c]=U.useState(!1),[d,f]=U.useState(null),g=async()=>{c(!0),f(null);try{const T=await er.getProjects();i(T)}catch(T){f(T instanceof Error?T.message:"")}finally{c(!1)}};U.useEffect(()=>{t&&g()},[t]);const v=async(T,E)=>{if(E.stopPropagation(),!!confirm(""))try{await er.deleteProject(T),await g()}catch(S){f(S instanceof Error?S.message:"")}},_=T=>{const E={projectGoal:T.goal,targetDate:T.targetDate,tasks:T.tasks,ganttData:T.ganttData},S=JSON.stringify(E,null,2),b=new Blob([S],{type:"application/json"}),k=URL.createObjectURL(b),A=document.createElement("a");A.href=k,A.download=`${T.title}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[x.jsx(Ui,{className:"w-5 h-5"}),""]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Pr,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[d&&x.jsx(Wi,{message:d}),l?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(Mn,{size:"lg",text:"..."})}):a.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("p",{className:"text-slate-500 text-lg mb-4",children:""}),x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[x.jsx(Ui,{className:"w-5 h-5"}),""]})]}):x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(T=>x.jsxs("div",{onClick:()=>n(T),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:T.title}),x.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x.jsx("button",{onClick:E=>{E.stopPropagation(),_(T)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSON",children:x.jsx(fl,{className:"w-4 h-4"})}),x.jsx("button",{onClick:E=>v(T.id,E),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"",children:x.jsx(ma,{className:"w-4 h-4"})})]})]}),x.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(kp,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsx("span",{className:"line-clamp-2",children:T.goal})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Ap,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(T.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),x.jsxs("p",{className:"text-xs text-slate-500",children:[": ",T.tasks.length," | : ",new Date(T.updatedAt).toLocaleDateString("ja-JP")]})]})]},T.id))})]})]})}):null},uG={"process-design":{goal:"APQPAdvanced Product Quality Planning",tasks:[{id:"apqp-1",title:"Phase 1",description:""},{id:"apqp-2",title:"Phase 2",description:"DFMEA"},{id:"apqp-3",title:"Phase 3",description:"PFMEA"},{id:"apqp-4",title:"Phase 4",description:""},{id:"apqp-5",title:"Phase 5",description:""}]},"process-change":{goal:"ISO/IATF 16949",tasks:[{id:"change-1",title:"",description:""},{id:"change-2",title:"",description:""},{id:"change-3",title:"",description:""},{id:"change-4",title:"",description:""}]},"new-product-eval":{goal:"",tasks:[{id:"eval-1",title:"",description:""},{id:"eval-2",title:"",description:""},{id:"eval-3",title:"",description:""},{id:"eval-4",title:"",description:""}]},"improvement-project":{goal:"DMAIC",tasks:[{id:"dmaic-d",title:"Define",description:""},{id:"dmaic-m",title:"Measure",description:""},{id:"dmaic-a",title:"Analyze",description:""},{id:"dmaic-i",title:"Improve",description:""},{id:"dmaic-c",title:"Control",description:""}]},"equipment-modification":{goal:"",tasks:[{id:"equip-1",title:"",description:""},{id:"equip-2",title:"",description:""},{id:"equip-3",title:"",description:""},{id:"equip-4",title:"",description:""}]}},fG=t=>{const[e,n]=U.useState([t]),[r,a]=U.useState(0),i=U.useCallback(g=>{n(v=>{const _=v.slice(0,r+1);return _.push(g),_.slice(-50)}),a(v=>Math.min(v+1,49))},[r]),l=U.useCallback(()=>r>0?(a(g=>g-1),e[r-1]):null,[r,e]),c=U.useCallback(()=>r<e.length-1?(a(g=>g+1),e[r+1]):null,[r,e]),d=r>0,f=r<e.length-1;return{addToHistory:i,undo:l,redo:c,canUndo:d,canRedo:f}},dG=()=>{const[t,e]=U.useState(null),[n,r]=U.useState(!0),[a,i]=U.useState(!1),[l,c]=U.useState(null),[d,f]=U.useState([]),[g,v]=U.useState(!1),[_,T]=U.useState(!1),[E,S]=U.useState(ba.INPUT_FORM),[b,k]=U.useState(""),[A,C]=U.useState(""),[M,B]=U.useState([]),[H,F]=U.useState(null),[K,P]=U.useState(null),[ae,G]=U.useState(null),[te,we]=U.useState(!1),[Re,ye]=U.useState(null),[se,me]=U.useState(""),[re,J]=U.useState(!1),{addToHistory:D,undo:ee,redo:I,canUndo:W,canRedo:X}=fG({tasks:M,projectGoal:b,targetDate:A}),q=450,oe=350;U.useEffect(()=>{(async()=>{const{data:{session:Ge}}=await Yt.auth.getSession();e((Ge==null?void 0:Ge.user)??null),r(!1)})();const{data:{subscription:Ye}}=Yt.auth.onAuthStateChange((Ge,We)=>{e((We==null?void 0:We.user)??null),Ge==="SIGNED_OUT"&&(c(null),f([]),B([]),k(""),C(""),S(ba.INPUT_FORM))});return()=>Ye.unsubscribe()},[]),U.useEffect(()=>{const Me=sessionStorage.getItem("gemini_api_key");Me&&(me(Me),J(!0),im(Me))},[]),U.useEffect(()=>l!=null&&l.id?er.subscribeToProjectChanges(l.id,Ye=>{if(Ye.eventType==="UPDATE"){const Ge=Ye.new;B(Ge.tasks_data||[]),k(Ge.goal),C(Ge.target_date),P(Ge.gantt_data)}},()=>{_e()}):void 0,[l==null?void 0:l.id]);const _e=U.useCallback(async()=>{if(l!=null&&l.id)try{const Me=await er.getProjectWithMembers(l.id);f(Me.members||[])}catch(Me){console.error("Failed to load project members:",Me)}},[l==null?void 0:l.id]);U.useEffect(()=>{_e()},[_e]);const Se=U.useCallback((Me="item")=>`${Me}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),Ee=U.useCallback(Me=>{B(Ye=>{const Ge=typeof Me=="function"?Me(Ye):Me;return D({tasks:Ge,projectGoal:b,targetDate:A}),Ge})},[D,b,A]),Ce=U.useCallback(Me=>{me(Me),J(!0),sessionStorage.setItem("gemini_api_key",Me),im(Me),ye(null)},[]),Ke=U.useCallback(()=>{me(""),J(!1),sessionStorage.removeItem("gemini_api_key"),im("")},[]),Z=U.useCallback(()=>{i(!1)},[]),ft=U.useCallback(async()=>{await Yt.auth.signOut()},[]),Xe=U.useCallback(async(Me,Ye)=>{if(!re){ye("API");return}we(!0),ye(null);try{const We=(await xL(Me,Ye)).map((nt,lr)=>({...nt,position:{x:50+lr%3*q,y:50+Math.floor(lr/3)*oe}}));k(Me),C(Ye),Ee(We),S(ba.PROJECT_FLOW),D({tasks:We,projectGoal:Me,targetDate:Ye})}catch(Ge){ye(Ge instanceof Error?Ge.message:"")}finally{we(!1)}},[re,Ee,D,q,oe]),wt=U.useCallback((Me,Ye,Ge)=>{const nt=uG[Me].tasks.map((lr,Ur)=>({...lr,position:{x:50+Ur%3*q,y:50+Math.floor(Ur/3)*oe}}));k(Ye),C(Ge),Ee(nt),S(ba.PROJECT_FLOW),D({tasks:nt,projectGoal:Ye,targetDate:Ge})},[Ee,D,q,oe]),rt=U.useCallback(Me=>{F(Me)},[]),Fe=U.useCallback(async(Me,Ye)=>{const Ge=M.map(We=>We.id===Me?{...We,extendedDetails:Ye}:We);if(Ee(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await er.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(We){console.error("Failed to auto-save project:",We)}},[M,Ee,l]),Ut=U.useCallback(async(Me,Ye)=>{const Ge=M.map(We=>We.id===Me?{...We,position:Ye}:We);if(Ee(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await er.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(We){console.error("Failed to auto-save project:",We)}},[M,Ee,l]),cn=U.useCallback(async(Me,Ye)=>{const Ge=M.map(We=>We.id===Me?{...We,status:Ye}:We);if(Ee(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await er.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(We){console.error("Failed to auto-save project:",We)}},[M,Ee,l]),rn=U.useCallback(async(Me,Ye)=>{const Ge=M.map(We=>We.id===Me?{...We,nextTaskIds:Ye}:We);if(Ee(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await er.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(We){console.error("Failed to auto-save project:",We)}},[M,Ee,l]),an=U.useCallback(()=>{c(null),f([]),B([]),k(""),C(""),P(null),G(null),S(ba.INPUT_FORM)},[]),Ln=U.useCallback(()=>{const Ye=JSON.stringify({projectGoal:b,targetDate:A,tasks:M,ganttData:K},null,2),Ge=new Blob([Ye],{type:"application/json"}),We=URL.createObjectURL(Ge),nt=document.createElement("a");nt.href=We,nt.download=`project-${Date.now()}.json`,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),URL.revokeObjectURL(We)},[b,A,M,K]),Tt=U.useCallback(Me=>{const Ye=new FileReader;Ye.onload=Ge=>{var We;try{const nt=JSON.parse((We=Ge.target)==null?void 0:We.result);nt.projectGoal&&nt.targetDate&&Array.isArray(nt.tasks)?(k(nt.projectGoal),C(nt.targetDate),Ee(nt.tasks),P(nt.ganttData||null),S(ba.PROJECT_FLOW),D({tasks:nt.tasks,projectGoal:nt.projectGoal,targetDate:nt.targetDate})):ye("")}catch{ye("")}},Ye.readAsText(Me)},[Ee,D]),en=U.useCallback(()=>{const Me={id:Se("task"),title:"",description:"",position:{x:50+M.length%3*q,y:50+Math.floor(M.length/3)*oe}};Ee([...M,Me])},[M,Se,Ee,q,oe]),Hn=U.useCallback(Me=>{if(confirm("")){const Ye=M.filter(Ge=>Ge.id!==Me);Ee(Ye)}},[M,Ee]),vn=U.useCallback(Me=>{const Ye=new FileReader;Ye.onload=Ge=>{var We;try{const nt=JSON.parse((We=Ge.target)==null?void 0:We.result);if(nt.task&&nt.task.id&&nt.task.title){const lr={...nt.task,id:Se("imported_task"),position:{x:50+M.length%3*q,y:50+Math.floor(M.length/3)*oe}};Ee([...M,lr])}else ye("")}catch{ye("")}},Ye.readAsText(Me)},[M,Se,Ee,q,oe]),Zt=U.useCallback(()=>{const Me=M.map((Ye,Ge)=>({...Ye,position:{x:50+Ge%3*q,y:50+Math.floor(Ge/3)*oe}}));Ee(Me)},[M,Ee,q,oe]),Dt=U.useCallback(()=>{const Me=ee();Me&&(B(Me.tasks),k(Me.projectGoal),C(Me.targetDate))},[ee]),it=U.useCallback(()=>{const Me=I();Me&&(B(Me.tasks),k(Me.projectGoal),C(Me.targetDate))},[I]),tt=U.useCallback(Me=>{G(Me)},[]),Et=U.useCallback(async Me=>{v(!0);try{const Ye=await er.getProjectWithMembers(Me.id);c(Me),f(Ye.members||[]),k(Me.goal),C(Me.targetDate),B(Me.tasks),P(Me.ganttData||null),S(ba.PROJECT_FLOW),T(!1)}catch(Ye){ye(Ye instanceof Error?Ye.message:"")}finally{v(!1)}},[]),sn=U.useCallback(async()=>{if(!t)throw new Error("");if(l!=null&&l.id){const Me=await er.updateProject(l.id,{goal:b,targetDate:A,tasks:M,ganttData:K,expectedVersion:l.version});c(Me)}else throw new Error("ProjectFlowDisplay")},[t,l,b,A,M,K]);return n?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700",children:x.jsx(Mn,{size:"lg",text:"..."})}):t?re?g?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-100",children:x.jsx(Mn,{size:"lg",text:"..."})}):x.jsxs(x.Fragment,{children:[E===ba.INPUT_FORM&&x.jsx(jL,{onSubmit:Xe,isLoading:te,onImportProject:Tt,onLoadTemplate:wt,initialGoal:b,initialDate:A,onOpenProjectList:()=>T(!0),onLogout:ft,user:t}),E===ba.PROJECT_FLOW&&x.jsx(JO,{tasks:M,projectGoal:b,targetDate:A,onSelectTask:rt,onUpdateTaskExtendedDetails:Fe,onUpdateTaskPosition:Ut,onUpdateTaskStatus:cn,onStartNewProject:an,onExportProject:Ln,onAddTask:en,onRemoveTask:Hn,onImportSingleTask:vn,onAutoLayout:Zt,onUndo:Dt,canUndo:W,onRedo:it,canRedo:X,generateUniqueId:Se,onUpdateTaskConnections:rn,ganttData:K,setGanttData:P,onCustomReportGenerated:tt,onClearApiKey:Ke,onOpenProjectList:()=>T(!0),onLogout:ft,currentProjectId:(l==null?void 0:l.id)||null,onSaveProject:sn,projectMembers:d,userRole:(l==null?void 0:l.userRole)||"viewer",onMembersUpdate:_e}),H&&x.jsx(oG,{task:H,onClose:()=>F(null),onUpdateTask:Fe,generateUniqueId:Se,projectGoal:b,targetDate:A,canEdit:!l||l.userRole==="owner"||l.userRole==="editor"}),_&&x.jsx(cG,{isOpen:_,onClose:()=>T(!1),onSelectProject:Et,onCreateNew:an}),Re&&x.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[x.jsx(Wi,{message:Re}),x.jsx("button",{onClick:()=>ye(null),className:"mt-2 text-sm text-blue-600 hover:underline",children:""})]})]}):x.jsx(lG,{onSetApiKey:Ce,error:Re,isLoading:te}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-4",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>i(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:" / "})]})}),x.jsx(LS,{isOpen:a,onClose:()=>i(!1),onSuccess:Z})]})},hG=()=>{var _;const{token:t}=kA(),e=AT(),[n,r]=U.useState(null),[a,i]=U.useState(!1),[l,c]=U.useState(null),[d,f]=U.useState(!1);U.useEffect(()=>{Yt.auth.getSession().then(({data:{session:E}})=>{r((E==null?void 0:E.user)??null),E!=null&&E.user&&t&&g()});const{data:{subscription:T}}=Yt.auth.onAuthStateChange((E,S)=>{r((S==null?void 0:S.user)??null),S!=null&&S.user&&t&&!l&&g()});return()=>T.unsubscribe()},[t]);const g=async()=>{if(!t){c({success:!1,error:""});return}i(!0);try{const T=await er.joinProjectByInvitation(t);c(T),T.success&&T.project&&setTimeout(()=>{e("/")},3e3)}catch(T){c({success:!1,error:T instanceof Error?T.message:""})}finally{i(!1)}},v=()=>{f(!1)};return t?n?a?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(Mn,{size:"lg"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mt-4 mb-2",children:"..."}),x.jsx("p",{className:"text-slate-600",children:""})]})}):l?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:l.success?x.jsxs(x.Fragment,{children:[x.jsx(pu,{className:"w-16 h-16 mx-auto text-green-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsxs("p",{className:"text-slate-600 mb-2",children:["",(_=l.project)==null?void 0:_.title,""]}),x.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"3..."}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700",children:""})]}):x.jsxs(x.Fragment,{children:[x.jsx(Di,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:l.error}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:""})]})})}):null:x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(wl,{className:"w-16 h-16 mx-auto text-blue-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>f(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:" / "})]})}),x.jsx(LS,{isOpen:d,onClose:()=>f(!1),onSuccess:v})]}):x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(Di,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:""}),x.jsx("p",{className:"text-slate-600 mb-6",children:""}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:""})]})})},OS=document.getElementById("root");if(!OS)throw new Error("Could not find root element to mount to");const mG=XC.createRoot(OS);mG.render(x.jsx(ls.StrictMode,{children:x.jsx(hk,{children:x.jsxs(HA,{children:[x.jsx(Tm,{path:"/",element:x.jsx(dG,{})}),x.jsx(Tm,{path:"/invite/:token",element:x.jsx(hG,{})})]})})}));
